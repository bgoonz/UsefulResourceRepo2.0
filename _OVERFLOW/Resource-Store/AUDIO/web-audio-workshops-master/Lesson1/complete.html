<!DOCTYPE html>
<html>
<head>
  <!--char set (lang above)-->
  <meta charset="utf-8">

  <!--device/browser shizzle-->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Ruth John (@rumyra)">
  <meta name="dcterms.rightsHolder" content="Ruth John for Rumyra Ltd, United Kingdom, 2015">
  <title>Lesson 1 | Web Audio Workshop</title>
  <link rel="stylesheet" href="/assets/style.css">

</head>
<body><div class="container">

  <audio src="/assets/100_C_G_Arps_SP_01.wav"></audio>

  <section id="synth">
    <button data-control="play">Play</button>
    <button data-control="mute" data-mute="false">Mute</button>
  </section>

</div>

<script type="text/javascript">

// declare stuff for use later on
const audioEl = document.querySelector('audio');
const playButton = document.querySelector('button[data-control="play"]');
const muteButton = document.querySelector('button[data-control="mute"]');

// audio stuff starts here

// create new context
const context = new window.AudioContext;

// get audio aource from audio element
const source = context.createMediaElementSource(audioEl);

// on button click connect nodes and start audio
playButton.addEventListener('click', function(evt) {
  audioEl.play();
  source.connect(gainNode).connect(context.destination);
});

// add a gain node
const gainNode = context.createGain();

// remember to add it to the connected node graph above^^

// add mute functionality
muteButton.addEventListener('click', function(evt) {
  if (muteButton.dataset.mute === 'false') {
    // we need to mute the audio
    // set gain value here
    gainNode.gain.value = 0;
    muteButton.dataset.mute = "true";
    muteButton.innerHTML = 'Unmute';
  } else {
    // we need to unmute the audio
    // set gain value here
    gainNode.gain.value = 1;
    muteButton.dataset.mute = "false";
    muteButton.innerHTML = 'Mute';
  }

});




</script>

</body>
</html>