<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>common-lisp.html</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <hr />
    <p>
      language: “Common Lisp” filename: commonlisp.lisp contributors: - [“Paul
      Nathan”, “https://github.com/pnathan”] - [“Rommel Martinez”,
      “https://ebzzry.io”] —
    </p>
    <p>
      Common Lisp is a general-purpose, multi-paradigm programming language
      suited for a wide variety of industry applications. It is frequently
      referred to as a programmable programming language.
    </p>
    <p>
      The classic starting point is
      <a href="http://www.gigamonkeys.com/book/">Practical Common Lisp</a>.
      Another popular and recent book is
      <a href="http://landoflisp.com/">Land of Lisp</a>. A new book about best
      practices, <a href="http://weitz.de/cl-recipes/">Common Lisp Recipes</a>,
      was recently published.
    </p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode lisp"
      ><code class="sourceCode commonlisp"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">;;; 0. Syntax</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">;;; General form</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">;;; CL has two fundamental pieces of syntax: ATOM and S-EXPRESSION.</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">;;; Typically, grouped S-expressions are called `forms`.</span></a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="dv">10</span>            <span class="co">; an atom; it evaluates to itself</span></a>
<a class="sourceLine" id="cb1-12" title="12">:thing        <span class="co">; another atom; evaluating to the symbol :thing</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">t</span>             <span class="co">; another atom, denoting true</span></a>
<a class="sourceLine" id="cb1-14" title="14">(<span class="op">+</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>)   <span class="co">; an s-expression</span></a>
<a class="sourceLine" id="cb1-15" title="15">&#39;(<span class="dv">4</span> :foo <span class="kw">t</span>)   <span class="co">; another s-expression</span></a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">;;; Comments</span></a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">;;; Single-line comments start with a semicolon; use four for file-level</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co">;;; comments, three for section descriptions, two inside definitions, and one</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">;;; for single lines. For example,</span></a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">;;;; life.lisp</span></a>
<a class="sourceLine" id="cb1-25" title="25"></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">;;; Foo bar baz, because quu quux. Optimized for maximum krakaboom and umph.</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">;;; Needed by the function LINULUKO.</span></a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29">(<span class="kw">defun</span><span class="fu"> meaning </span>(life)</a>
<a class="sourceLine" id="cb1-30" title="30">  <span class="st">&quot;Return the computed meaning of LIFE&quot;</span></a>
<a class="sourceLine" id="cb1-31" title="31">  (<span class="kw">let</span> ((meh <span class="st">&quot;abc&quot;</span>))</a>
<a class="sourceLine" id="cb1-32" title="32">    <span class="co">;; Invoke krakaboom</span></a>
<a class="sourceLine" id="cb1-33" title="33">    (<span class="kw">loop</span> :for x :across meh</a>
<a class="sourceLine" id="cb1-34" title="34">       :collect x)))                    <span class="co">; store values into x, then return it</span></a>
<a class="sourceLine" id="cb1-35" title="35"></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">;;; Block comments, on the other hand, allow for free-form comments. They are</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="co">;;; delimited with #| and |#</span></a>
<a class="sourceLine" id="cb1-38" title="38"></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="co">#| This is a block comment which</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co">   can span multiple lines and</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="co">    #|</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="co">       they can be nested!</span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="co">    |#</span></a>
<a class="sourceLine" id="cb1-44" title="44">|#</a>
<a class="sourceLine" id="cb1-45" title="45"></a>
<a class="sourceLine" id="cb1-46" title="46"></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="co">;;; Environment</span></a>
<a class="sourceLine" id="cb1-48" title="48"></a>
<a class="sourceLine" id="cb1-49" title="49"><span class="co">;;; A variety of implementations exist; most are standards-conformant. SBCL</span></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="co">;;; is a good starting point. Third party libraries can be easily installed with</span></a>
<a class="sourceLine" id="cb1-51" title="51"><span class="co">;;; Quicklisp</span></a>
<a class="sourceLine" id="cb1-52" title="52"></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="co">;;; CL is usually developed with a text editor and a Read Eval Print</span></a>
<a class="sourceLine" id="cb1-54" title="54"><span class="co">;;; Loop (REPL) running at the same time. The REPL allows for interactive</span></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="co">;;; exploration of the program while it is running &quot;live&quot;.</span></a>
<a class="sourceLine" id="cb1-56" title="56"></a>
<a class="sourceLine" id="cb1-57" title="57"></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="co">;;; 1. Primitive datatypes and operators</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-61" title="61"></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="co">;;; Symbols</span></a>
<a class="sourceLine" id="cb1-63" title="63"></a>
<a class="sourceLine" id="cb1-64" title="64">&#39;foo <span class="co">; =&gt; FOO  Notice that the symbol is upper-cased automatically.</span></a>
<a class="sourceLine" id="cb1-65" title="65"></a>
<a class="sourceLine" id="cb1-66" title="66"><span class="co">;;; INTERN manually creates a symbol from a string.</span></a>
<a class="sourceLine" id="cb1-67" title="67"></a>
<a class="sourceLine" id="cb1-68" title="68">(<span class="kw">intern</span> <span class="st">&quot;AAAA&quot;</span>)        <span class="co">; =&gt; AAAA</span></a>
<a class="sourceLine" id="cb1-69" title="69">(<span class="kw">intern</span> <span class="st">&quot;aaa&quot;</span>)         <span class="co">; =&gt; |aaa|</span></a>
<a class="sourceLine" id="cb1-70" title="70"></a>
<a class="sourceLine" id="cb1-71" title="71"><span class="co">;;; Numbers</span></a>
<a class="sourceLine" id="cb1-72" title="72"></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="dv">9999999999999999999999</span> <span class="co">; integers</span></a>
<a class="sourceLine" id="cb1-74" title="74"><span class="ch">#b</span>111                  ; binary =&gt; <span class="dv">7</span></a>
<a class="sourceLine" id="cb1-75" title="75"><span class="ch">#o</span>111                  ; octal =&gt; <span class="dv">73</span></a>
<a class="sourceLine" id="cb1-76" title="76"><span class="ch">#x</span>111                  ; hexadecimal =&gt; <span class="dv">273</span></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="fl">3.14159</span>s0              <span class="co">; single</span></a>
<a class="sourceLine" id="cb1-78" title="78"><span class="fl">3.14159</span>d0              <span class="co">; double</span></a>
<a class="sourceLine" id="cb1-79" title="79"><span class="dv">1</span>/<span class="dv">2</span>                    <span class="co">; ratios</span></a>
<a class="sourceLine" id="cb1-80" title="80">#C(<span class="dv">1</span> <span class="dv">2</span>)                <span class="co">; complex numbers</span></a>
<a class="sourceLine" id="cb1-81" title="81"></a>
<a class="sourceLine" id="cb1-82" title="82"><span class="co">;;; Function application are written as (f x y z ...) where f is a function and</span></a>
<a class="sourceLine" id="cb1-83" title="83"><span class="co">;;; x, y, z, ... are the arguments.</span></a>
<a class="sourceLine" id="cb1-84" title="84"></a>
<a class="sourceLine" id="cb1-85" title="85">(<span class="op">+</span> <span class="dv">1</span> <span class="dv">2</span>)                <span class="co">; =&gt; 3</span></a>
<a class="sourceLine" id="cb1-86" title="86"></a>
<a class="sourceLine" id="cb1-87" title="87"><span class="co">;;; If you want to create literal data, use QUOTE to prevent it from being</span></a>
<a class="sourceLine" id="cb1-88" title="88"><span class="co">;;; evaluated</span></a>
<a class="sourceLine" id="cb1-89" title="89"></a>
<a class="sourceLine" id="cb1-90" title="90">(<span class="kw">quote</span> (<span class="op">+</span> <span class="dv">1</span> <span class="dv">2</span>))        <span class="co">; =&gt; (+ 1 2)</span></a>
<a class="sourceLine" id="cb1-91" title="91">(<span class="kw">quote</span> a)              <span class="co">; =&gt; A</span></a>
<a class="sourceLine" id="cb1-92" title="92"></a>
<a class="sourceLine" id="cb1-93" title="93"><span class="co">;;; The shorthand for QUOTE is &#39;</span></a>
<a class="sourceLine" id="cb1-94" title="94"></a>
<a class="sourceLine" id="cb1-95" title="95">&#39;(<span class="op">+</span> <span class="dv">1</span> <span class="dv">2</span>)               <span class="co">; =&gt; (+ 1 2)</span></a>
<a class="sourceLine" id="cb1-96" title="96">&#39;a                     <span class="co">; =&gt; A</span></a>
<a class="sourceLine" id="cb1-97" title="97"></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="co">;;; Basic arithmetic operations</span></a>
<a class="sourceLine" id="cb1-99" title="99"></a>
<a class="sourceLine" id="cb1-100" title="100">(<span class="op">+</span> <span class="dv">1</span> <span class="dv">1</span>)                <span class="co">; =&gt; 2</span></a>
<a class="sourceLine" id="cb1-101" title="101">(<span class="op">-</span> <span class="dv">8</span> <span class="dv">1</span>)                <span class="co">; =&gt; 7</span></a>
<a class="sourceLine" id="cb1-102" title="102">(<span class="op">*</span> <span class="dv">10</span> <span class="dv">2</span>)               <span class="co">; =&gt; 20</span></a>
<a class="sourceLine" id="cb1-103" title="103">(<span class="kw">expt</span> <span class="dv">2</span> <span class="dv">3</span>)             <span class="co">; =&gt; 8</span></a>
<a class="sourceLine" id="cb1-104" title="104">(<span class="kw">mod</span> <span class="dv">5</span> <span class="dv">2</span>)              <span class="co">; =&gt; 1</span></a>
<a class="sourceLine" id="cb1-105" title="105">(<span class="op">/</span> <span class="dv">35</span> <span class="dv">5</span>)               <span class="co">; =&gt; 7</span></a>
<a class="sourceLine" id="cb1-106" title="106">(<span class="op">/</span> <span class="dv">1</span> <span class="dv">3</span>)                <span class="co">; =&gt; 1/3</span></a>
<a class="sourceLine" id="cb1-107" title="107">(<span class="op">+</span> #C(<span class="dv">1</span> <span class="dv">2</span>) #C(<span class="dv">6</span> <span class="dv">-4</span>))   <span class="co">; =&gt; #C(7 -2)</span></a>
<a class="sourceLine" id="cb1-108" title="108"></a>
<a class="sourceLine" id="cb1-109" title="109"><span class="co">;;; Booleans</span></a>
<a class="sourceLine" id="cb1-110" title="110"></a>
<a class="sourceLine" id="cb1-111" title="111"><span class="kw">t</span>                      <span class="co">; true; any non-NIL value is true</span></a>
<a class="sourceLine" id="cb1-112" title="112"><span class="kw">nil</span>                    <span class="co">; false; also, the empty list: ()</span></a>
<a class="sourceLine" id="cb1-113" title="113">(<span class="kw">not</span> <span class="kw">nil</span>)              <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-114" title="114">(<span class="kw">and</span> <span class="dv">0</span> <span class="kw">t</span>)              <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-115" title="115">(<span class="kw">or</span> <span class="dv">0</span> <span class="kw">nil</span>)             <span class="co">; =&gt; 0</span></a>
<a class="sourceLine" id="cb1-116" title="116"></a>
<a class="sourceLine" id="cb1-117" title="117"><span class="co">;;; Characters</span></a>
<a class="sourceLine" id="cb1-118" title="118"></a>
<a class="sourceLine" id="cb1-119" title="119"><span class="ch">#\A</span>                    <span class="co">; =&gt; #\A</span></a>
<a class="sourceLine" id="cb1-120" title="120"><span class="ch">#\λ</span>                    <span class="co">; =&gt; #\GREEK_SMALL_LETTER_LAMDA</span></a>
<a class="sourceLine" id="cb1-121" title="121"><span class="ch">#\u</span>03BB                <span class="co">; =&gt; #\GREEK_SMALL_LETTER_LAMDA</span></a>
<a class="sourceLine" id="cb1-122" title="122"></a>
<a class="sourceLine" id="cb1-123" title="123"><span class="co">;;; Strings are fixed-length arrays of characters</span></a>
<a class="sourceLine" id="cb1-124" title="124"></a>
<a class="sourceLine" id="cb1-125" title="125"><span class="st">&quot;Hello, world!&quot;</span></a>
<a class="sourceLine" id="cb1-126" title="126"><span class="st">&quot;Benjamin </span><span class="sc">\&quot;</span><span class="st">Bugsy</span><span class="sc">\&quot;</span><span class="st"> Siegel&quot;</span>   <span class="co">; backslash is an escaping character</span></a>
<a class="sourceLine" id="cb1-127" title="127"></a>
<a class="sourceLine" id="cb1-128" title="128"><span class="co">;;; Strings can be concatenated</span></a>
<a class="sourceLine" id="cb1-129" title="129"></a>
<a class="sourceLine" id="cb1-130" title="130">(<span class="kw">concatenate</span> &#39;string <span class="st">&quot;Hello, &quot;</span> <span class="st">&quot;world!&quot;</span>) <span class="co">; =&gt; &quot;Hello, world!&quot;</span></a>
<a class="sourceLine" id="cb1-131" title="131"></a>
<a class="sourceLine" id="cb1-132" title="132"><span class="co">;;; A string can be treated like a sequence of characters</span></a>
<a class="sourceLine" id="cb1-133" title="133"></a>
<a class="sourceLine" id="cb1-134" title="134">(<span class="kw">elt</span> <span class="st">&quot;Apple&quot;</span> <span class="dv">0</span>) <span class="co">; =&gt; #\A</span></a>
<a class="sourceLine" id="cb1-135" title="135"></a>
<a class="sourceLine" id="cb1-136" title="136"><span class="co">;;; FORMAT is used to create formatted output, which ranges from simple string</span></a>
<a class="sourceLine" id="cb1-137" title="137"><span class="co">;;; interpolation to loops and conditionals. The first argument to FORMAT</span></a>
<a class="sourceLine" id="cb1-138" title="138"><span class="co">;;; determines where will the formatted string go. If it is NIL, FORMAT</span></a>
<a class="sourceLine" id="cb1-139" title="139"><span class="co">;;; simply returns the formatted string as a value; if it is T, FORMAT outputs</span></a>
<a class="sourceLine" id="cb1-140" title="140"><span class="co">;;; to the standard output, usually the screen, then it returns NIL.</span></a>
<a class="sourceLine" id="cb1-141" title="141"></a>
<a class="sourceLine" id="cb1-142" title="142">(<span class="kw">format</span> <span class="kw">nil</span> <span class="st">&quot;~A, ~A!&quot;</span> <span class="st">&quot;Hello&quot;</span> <span class="st">&quot;world&quot;</span>)   <span class="co">; =&gt; &quot;Hello, world!&quot;</span></a>
<a class="sourceLine" id="cb1-143" title="143">(<span class="kw">format</span> <span class="kw">t</span> <span class="st">&quot;~A, ~A!&quot;</span> <span class="st">&quot;Hello&quot;</span> <span class="st">&quot;world&quot;</span>)     <span class="co">; =&gt; NIL</span></a>
<a class="sourceLine" id="cb1-144" title="144"></a>
<a class="sourceLine" id="cb1-145" title="145"></a>
<a class="sourceLine" id="cb1-146" title="146"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-147" title="147"><span class="co">;;; 2. Variables</span></a>
<a class="sourceLine" id="cb1-148" title="148"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-149" title="149"></a>
<a class="sourceLine" id="cb1-150" title="150"><span class="co">;;; You can create a global (dynamically scoped) variable using DEFVAR and</span></a>
<a class="sourceLine" id="cb1-151" title="151"><span class="co">;;; DEFPARAMETER. The variable name can use any character except: ()&quot;,&#39;`;#|\</span></a>
<a class="sourceLine" id="cb1-152" title="152"></a>
<a class="sourceLine" id="cb1-153" title="153"><span class="co">;;; The difference between DEFVAR and DEFPARAMETER is that re-evaluating a</span></a>
<a class="sourceLine" id="cb1-154" title="154"><span class="co">;;; DEFVAR expression doesn&#39;t change the value of the variable. DEFPARAMETER,</span></a>
<a class="sourceLine" id="cb1-155" title="155"><span class="co">;;; on the other hand, does.</span></a>
<a class="sourceLine" id="cb1-156" title="156"></a>
<a class="sourceLine" id="cb1-157" title="157"><span class="co">;;; By convention, dynamically scoped variables have earmuffs in their name.</span></a>
<a class="sourceLine" id="cb1-158" title="158"></a>
<a class="sourceLine" id="cb1-159" title="159">(<span class="kw">defparameter</span><span class="fu"> *some-var* </span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-160" title="160">*some-var* <span class="co">; =&gt; 5</span></a>
<a class="sourceLine" id="cb1-161" title="161"></a>
<a class="sourceLine" id="cb1-162" title="162"><span class="co">;;; You can also use unicode characters.</span></a>
<a class="sourceLine" id="cb1-163" title="163">(<span class="kw">defparameter</span><span class="fu"> *A</span>ΛB* <span class="kw">nil</span>)</a>
<a class="sourceLine" id="cb1-164" title="164"></a>
<a class="sourceLine" id="cb1-165" title="165"><span class="co">;;; Accessing a previously unbound variable results in an UNBOUND-VARIABLE</span></a>
<a class="sourceLine" id="cb1-166" title="166"><span class="co">;;; error, however it is defined behavior. Don&#39;t do it.</span></a>
<a class="sourceLine" id="cb1-167" title="167"></a>
<a class="sourceLine" id="cb1-168" title="168"><span class="co">;;; You can create local bindings with LET. In the following snippet, `me` is</span></a>
<a class="sourceLine" id="cb1-169" title="169"><span class="co">;;; bound to &quot;dance with you&quot; only within the (let ...). LET always returns</span></a>
<a class="sourceLine" id="cb1-170" title="170"><span class="co">;;; the value of the last `form` in the LET form.</span></a>
<a class="sourceLine" id="cb1-171" title="171"></a>
<a class="sourceLine" id="cb1-172" title="172">(<span class="kw">let</span> ((me <span class="st">&quot;dance with you&quot;</span>)) me) <span class="co">; =&gt; &quot;dance with you&quot;</span></a>
<a class="sourceLine" id="cb1-173" title="173"></a>
<a class="sourceLine" id="cb1-174" title="174"></a>
<a class="sourceLine" id="cb1-175" title="175"><span class="co">;;;-----------------------------------------------------------------------------;</span></a>
<a class="sourceLine" id="cb1-176" title="176"><span class="co">;;; 3. Structs and collections</span></a>
<a class="sourceLine" id="cb1-177" title="177"><span class="co">;;;-----------------------------------------------------------------------------;</span></a>
<a class="sourceLine" id="cb1-178" title="178"></a>
<a class="sourceLine" id="cb1-179" title="179"></a>
<a class="sourceLine" id="cb1-180" title="180"><span class="co">;;; Structs</span></a>
<a class="sourceLine" id="cb1-181" title="181"></a>
<a class="sourceLine" id="cb1-182" title="182">(<span class="kw">defstruct</span><span class="fu"> dog </span>name breed age)</a>
<a class="sourceLine" id="cb1-183" title="183">(<span class="kw">defparameter</span><span class="fu"> *rover*</span></a>
<a class="sourceLine" id="cb1-184" title="184">    (make-dog <span class="bu">:name</span> <span class="st">&quot;rover&quot;</span></a>
<a class="sourceLine" id="cb1-185" title="185">              :breed <span class="st">&quot;collie&quot;</span></a>
<a class="sourceLine" id="cb1-186" title="186">              :age <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1-187" title="187">*rover*            <span class="co">; =&gt; #S(DOG :NAME &quot;rover&quot; :BREED &quot;collie&quot; :AGE 5)</span></a>
<a class="sourceLine" id="cb1-188" title="188">(dog-p *rover*)    <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-189" title="189">(dog-name *rover*) <span class="co">; =&gt; &quot;rover&quot;</span></a>
<a class="sourceLine" id="cb1-190" title="190"></a>
<a class="sourceLine" id="cb1-191" title="191"><span class="co">;;; DOG-P, MAKE-DOG, and DOG-NAME are all automatically created by DEFSTRUCT</span></a>
<a class="sourceLine" id="cb1-192" title="192"></a>
<a class="sourceLine" id="cb1-193" title="193"></a>
<a class="sourceLine" id="cb1-194" title="194"><span class="co">;;; Pairs</span></a>
<a class="sourceLine" id="cb1-195" title="195"></a>
<a class="sourceLine" id="cb1-196" title="196"><span class="co">;;; CONS constructs pairs. CAR and CDR return the head and tail of a CONS-pair.</span></a>
<a class="sourceLine" id="cb1-197" title="197"></a>
<a class="sourceLine" id="cb1-198" title="198">(<span class="kw">cons</span> &#39;SUBJECT &#39;VERB)         <span class="co">; =&gt; &#39;(SUBJECT . VERB)</span></a>
<a class="sourceLine" id="cb1-199" title="199">(<span class="kw">car</span> (<span class="kw">cons</span> &#39;SUBJECT &#39;VERB))   <span class="co">; =&gt; SUBJECT</span></a>
<a class="sourceLine" id="cb1-200" title="200">(<span class="kw">cdr</span> (<span class="kw">cons</span> &#39;SUBJECT &#39;VERB))   <span class="co">; =&gt; VERB</span></a>
<a class="sourceLine" id="cb1-201" title="201"></a>
<a class="sourceLine" id="cb1-202" title="202"></a>
<a class="sourceLine" id="cb1-203" title="203"><span class="co">;;; Lists</span></a>
<a class="sourceLine" id="cb1-204" title="204"></a>
<a class="sourceLine" id="cb1-205" title="205"><span class="co">;;; Lists are linked-list data structures, made of CONS pairs and end with a</span></a>
<a class="sourceLine" id="cb1-206" title="206"><span class="co">;;; NIL (or &#39;()) to mark the end of the list</span></a>
<a class="sourceLine" id="cb1-207" title="207"></a>
<a class="sourceLine" id="cb1-208" title="208">(<span class="kw">cons</span> <span class="dv">1</span> (<span class="kw">cons</span> <span class="dv">2</span> (<span class="kw">cons</span> <span class="dv">3</span> <span class="kw">nil</span>)))     <span class="co">; =&gt; &#39;(1 2 3)</span></a>
<a class="sourceLine" id="cb1-209" title="209"></a>
<a class="sourceLine" id="cb1-210" title="210"><span class="co">;;; LIST is a convenience variadic constructor for lists</span></a>
<a class="sourceLine" id="cb1-211" title="211"></a>
<a class="sourceLine" id="cb1-212" title="212">(<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)                       <span class="co">; =&gt; &#39;(1 2 3)</span></a>
<a class="sourceLine" id="cb1-213" title="213"></a>
<a class="sourceLine" id="cb1-214" title="214"><span class="co">;;; When the first argument to CONS is an atom and the second argument is a</span></a>
<a class="sourceLine" id="cb1-215" title="215"><span class="co">;;; list, CONS returns a new CONS-pair with the first argument as the first</span></a>
<a class="sourceLine" id="cb1-216" title="216"><span class="co">;;; item and the second argument as the rest of the CONS-pair</span></a>
<a class="sourceLine" id="cb1-217" title="217"></a>
<a class="sourceLine" id="cb1-218" title="218">(<span class="kw">cons</span> <span class="dv">4</span> &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>))                  <span class="co">; =&gt; &#39;(4 1 2 3)</span></a>
<a class="sourceLine" id="cb1-219" title="219"></a>
<a class="sourceLine" id="cb1-220" title="220"><span class="co">;;; Use APPEND to join lists</span></a>
<a class="sourceLine" id="cb1-221" title="221"></a>
<a class="sourceLine" id="cb1-222" title="222">(<span class="kw">append</span> &#39;(<span class="dv">1</span> <span class="dv">2</span>) &#39;(<span class="dv">3</span> <span class="dv">4</span>))             <span class="co">; =&gt; &#39;(1 2 3 4)</span></a>
<a class="sourceLine" id="cb1-223" title="223"></a>
<a class="sourceLine" id="cb1-224" title="224"><span class="co">;;; Or CONCATENATE</span></a>
<a class="sourceLine" id="cb1-225" title="225"></a>
<a class="sourceLine" id="cb1-226" title="226">(<span class="kw">concatenate</span> &#39;list &#39;(<span class="dv">1</span> <span class="dv">2</span>) &#39;(<span class="dv">3</span> <span class="dv">4</span>))  <span class="co">; =&gt; &#39;(1 2 3 4)</span></a>
<a class="sourceLine" id="cb1-227" title="227"></a>
<a class="sourceLine" id="cb1-228" title="228"><span class="co">;;; Lists are a very central type, so there is a wide variety of functionality for</span></a>
<a class="sourceLine" id="cb1-229" title="229"><span class="co">;;; them, a few examples:</span></a>
<a class="sourceLine" id="cb1-230" title="230"></a>
<a class="sourceLine" id="cb1-231" title="231">(<span class="kw">mapcar</span> #&#39;<span class="dv">1</span>+ &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>))             <span class="co">; =&gt; &#39;(2 3 4)</span></a>
<a class="sourceLine" id="cb1-232" title="232">(<span class="kw">mapcar</span> #&#39;+ &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>) &#39;(<span class="dv">10</span> <span class="dv">20</span> <span class="dv">30</span>))  <span class="co">; =&gt; &#39;(11 22 33)</span></a>
<a class="sourceLine" id="cb1-233" title="233">(<span class="kw">remove-if-not</span> #&#39;evenp &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>)) <span class="co">; =&gt; &#39;(2 4)</span></a>
<a class="sourceLine" id="cb1-234" title="234">(<span class="kw">every</span> #&#39;evenp &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>))         <span class="co">; =&gt; NIL</span></a>
<a class="sourceLine" id="cb1-235" title="235">(<span class="kw">some</span> #&#39;oddp &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>))           <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-236" title="236">(<span class="kw">butlast</span> &#39;(subject verb object))   <span class="co">; =&gt; (SUBJECT VERB)</span></a>
<a class="sourceLine" id="cb1-237" title="237"></a>
<a class="sourceLine" id="cb1-238" title="238"></a>
<a class="sourceLine" id="cb1-239" title="239"><span class="co">;;; Vectors</span></a>
<a class="sourceLine" id="cb1-240" title="240"></a>
<a class="sourceLine" id="cb1-241" title="241"><span class="co">;;; Vector&#39;s literals are fixed-length arrays</span></a>
<a class="sourceLine" id="cb1-242" title="242"></a>
<a class="sourceLine" id="cb1-243" title="243">#(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>) <span class="co">; =&gt; #(1 2 3)</span></a>
<a class="sourceLine" id="cb1-244" title="244"></a>
<a class="sourceLine" id="cb1-245" title="245"><span class="co">;;; Use CONCATENATE to add vectors together</span></a>
<a class="sourceLine" id="cb1-246" title="246"></a>
<a class="sourceLine" id="cb1-247" title="247">(<span class="kw">concatenate</span> &#39;vector #(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>) #(<span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span>)) <span class="co">; =&gt; #(1 2 3 4 5 6)</span></a>
<a class="sourceLine" id="cb1-248" title="248"></a>
<a class="sourceLine" id="cb1-249" title="249"></a>
<a class="sourceLine" id="cb1-250" title="250"><span class="co">;;; Arrays</span></a>
<a class="sourceLine" id="cb1-251" title="251"></a>
<a class="sourceLine" id="cb1-252" title="252"><span class="co">;;; Both vectors and strings are special-cases of arrays.</span></a>
<a class="sourceLine" id="cb1-253" title="253"></a>
<a class="sourceLine" id="cb1-254" title="254"><span class="co">;;; 2D arrays</span></a>
<a class="sourceLine" id="cb1-255" title="255"></a>
<a class="sourceLine" id="cb1-256" title="256">(<span class="kw">make-array</span> (<span class="kw">list</span> <span class="dv">2</span> <span class="dv">2</span>))         <span class="co">; =&gt; #2A((0 0) (0 0))</span></a>
<a class="sourceLine" id="cb1-257" title="257">(<span class="kw">make-array</span> &#39;(<span class="dv">2</span> <span class="dv">2</span>))             <span class="co">; =&gt; #2A((0 0) (0 0))</span></a>
<a class="sourceLine" id="cb1-258" title="258">(<span class="kw">make-array</span> (<span class="kw">list</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span>))       <span class="co">; =&gt; #3A(((0 0) (0 0)) ((0 0) (0 0)))</span></a>
<a class="sourceLine" id="cb1-259" title="259"></a>
<a class="sourceLine" id="cb1-260" title="260"><span class="co">;;; Caution: the default initial values of MAKE-ARRAY are implementation-defined.</span></a>
<a class="sourceLine" id="cb1-261" title="261"><span class="co">;;; To explicitly specify them:</span></a>
<a class="sourceLine" id="cb1-262" title="262"></a>
<a class="sourceLine" id="cb1-263" title="263">(<span class="kw">make-array</span> &#39;(<span class="dv">2</span>) <span class="bu">:initial-element</span> &#39;unset)  <span class="co">; =&gt; #(UNSET UNSET)</span></a>
<a class="sourceLine" id="cb1-264" title="264"></a>
<a class="sourceLine" id="cb1-265" title="265"><span class="co">;;; To access the element at 1, 1, 1:</span></a>
<a class="sourceLine" id="cb1-266" title="266"></a>
<a class="sourceLine" id="cb1-267" title="267">(<span class="kw">aref</span> (<span class="kw">make-array</span> (<span class="kw">list</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span>)) <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>)     <span class="co">;  =&gt; 0</span></a>
<a class="sourceLine" id="cb1-268" title="268"><span class="co">;;; This value is implementation-defined:</span></a>
<a class="sourceLine" id="cb1-269" title="269"><span class="co">;;; NIL on ECL, 0 on SBCL and CCL.</span></a>
<a class="sourceLine" id="cb1-270" title="270"></a>
<a class="sourceLine" id="cb1-271" title="271"><span class="co">;;; Adjustable vectors</span></a>
<a class="sourceLine" id="cb1-272" title="272"></a>
<a class="sourceLine" id="cb1-273" title="273"><span class="co">;;; Adjustable vectors have the same printed representation as</span></a>
<a class="sourceLine" id="cb1-274" title="274"><span class="co">;;; fixed-length vector&#39;s literals.</span></a>
<a class="sourceLine" id="cb1-275" title="275"></a>
<a class="sourceLine" id="cb1-276" title="276">(<span class="kw">defparameter</span><span class="fu"> *adjvec* </span>(<span class="kw">make-array</span> &#39;(<span class="dv">3</span>) <span class="bu">:initial-contents</span> &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-277" title="277">                                   <span class="bu">:adjustable</span> <span class="kw">t</span> :fill-pointer <span class="kw">t</span>))</a>
<a class="sourceLine" id="cb1-278" title="278">*adjvec* <span class="co">; =&gt; #(1 2 3)</span></a>
<a class="sourceLine" id="cb1-279" title="279"></a>
<a class="sourceLine" id="cb1-280" title="280"><span class="co">;;; Adding new elements</span></a>
<a class="sourceLine" id="cb1-281" title="281"></a>
<a class="sourceLine" id="cb1-282" title="282">(<span class="kw">vector-push-extend</span> <span class="dv">4</span> *adjvec*)   <span class="co">; =&gt; 3</span></a>
<a class="sourceLine" id="cb1-283" title="283">*adjvec*                          <span class="co">; =&gt; #(1 2 3 4)</span></a>
<a class="sourceLine" id="cb1-284" title="284"></a>
<a class="sourceLine" id="cb1-285" title="285"></a>
<a class="sourceLine" id="cb1-286" title="286"><span class="co">;;; Sets, naively, are just lists:</span></a>
<a class="sourceLine" id="cb1-287" title="287"></a>
<a class="sourceLine" id="cb1-288" title="288">(<span class="kw">set-difference</span> &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>) &#39;(<span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span>))   <span class="co">; =&gt; (3 2 1)</span></a>
<a class="sourceLine" id="cb1-289" title="289">(<span class="kw">intersection</span> &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>) &#39;(<span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span>))     <span class="co">; =&gt; 4</span></a>
<a class="sourceLine" id="cb1-290" title="290">(<span class="kw">union</span> &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>) &#39;(<span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span>))            <span class="co">; =&gt; (3 2 1 4 5 6 7)</span></a>
<a class="sourceLine" id="cb1-291" title="291">(<span class="kw">adjoin</span> <span class="dv">4</span> &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>))                    <span class="co">; =&gt; (1 2 3 4)</span></a>
<a class="sourceLine" id="cb1-292" title="292"></a>
<a class="sourceLine" id="cb1-293" title="293"><span class="co">;;; However, you&#39;ll need a better data structure than linked lists when working</span></a>
<a class="sourceLine" id="cb1-294" title="294"><span class="co">;;; with larger data sets</span></a>
<a class="sourceLine" id="cb1-295" title="295"></a>
<a class="sourceLine" id="cb1-296" title="296"><span class="co">;;; Dictionaries are implemented as hash tables.</span></a>
<a class="sourceLine" id="cb1-297" title="297"></a>
<a class="sourceLine" id="cb1-298" title="298"><span class="co">;;; Create a hash table</span></a>
<a class="sourceLine" id="cb1-299" title="299"></a>
<a class="sourceLine" id="cb1-300" title="300">(<span class="kw">defparameter</span><span class="fu"> *m* </span>(<span class="kw">make-hash-table</span>))</a>
<a class="sourceLine" id="cb1-301" title="301"></a>
<a class="sourceLine" id="cb1-302" title="302"><span class="co">;;; Set value</span></a>
<a class="sourceLine" id="cb1-303" title="303"></a>
<a class="sourceLine" id="cb1-304" title="304">(<span class="kw">setf</span> (<span class="kw">gethash</span> &#39;a *m*) <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-305" title="305"></a>
<a class="sourceLine" id="cb1-306" title="306"><span class="co">;;; Retrieve value</span></a>
<a class="sourceLine" id="cb1-307" title="307"></a>
<a class="sourceLine" id="cb1-308" title="308">(<span class="kw">gethash</span> &#39;a *m*) <span class="co">; =&gt; 1, T</span></a>
<a class="sourceLine" id="cb1-309" title="309"></a>
<a class="sourceLine" id="cb1-310" title="310"><span class="co">;;; CL expressions have the ability to return multiple values.</span></a>
<a class="sourceLine" id="cb1-311" title="311"></a>
<a class="sourceLine" id="cb1-312" title="312">(<span class="kw">values</span> <span class="dv">1</span> <span class="dv">2</span>) <span class="co">; =&gt; 1, 2</span></a>
<a class="sourceLine" id="cb1-313" title="313"></a>
<a class="sourceLine" id="cb1-314" title="314"><span class="co">;;; which can be bound with MULTIPLE-VALUE-BIND</span></a>
<a class="sourceLine" id="cb1-315" title="315"></a>
<a class="sourceLine" id="cb1-316" title="316">(<span class="kw">multiple-value-bind</span> (x y)</a>
<a class="sourceLine" id="cb1-317" title="317">    (<span class="kw">values</span> <span class="dv">1</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-318" title="318">  (<span class="kw">list</span> y x))</a>
<a class="sourceLine" id="cb1-319" title="319"></a>
<a class="sourceLine" id="cb1-320" title="320"><span class="co">; =&gt; &#39;(2 1)</span></a>
<a class="sourceLine" id="cb1-321" title="321"></a>
<a class="sourceLine" id="cb1-322" title="322"><span class="co">;;; GETHASH is an example of a function that returns multiple values. The first</span></a>
<a class="sourceLine" id="cb1-323" title="323"><span class="co">;;; value it return is the value of the key in the hash table; if the key is</span></a>
<a class="sourceLine" id="cb1-324" title="324"><span class="co">;;; not found it returns NIL.</span></a>
<a class="sourceLine" id="cb1-325" title="325"></a>
<a class="sourceLine" id="cb1-326" title="326"><span class="co">;;; The second value determines if that key is indeed present in the hash</span></a>
<a class="sourceLine" id="cb1-327" title="327"><span class="co">;;; table. If a key is not found in the table it returns NIL. This behavior</span></a>
<a class="sourceLine" id="cb1-328" title="328"><span class="co">;;; allows us to check if the value of a key is actually NIL.</span></a>
<a class="sourceLine" id="cb1-329" title="329"></a>
<a class="sourceLine" id="cb1-330" title="330"><span class="co">;;; Retrieving a non-present value returns nil</span></a>
<a class="sourceLine" id="cb1-331" title="331"></a>
<a class="sourceLine" id="cb1-332" title="332">(<span class="kw">gethash</span> &#39;d *m*) <span class="co">;=&gt; NIL, NIL</span></a>
<a class="sourceLine" id="cb1-333" title="333"></a>
<a class="sourceLine" id="cb1-334" title="334"><span class="co">;;; You can provide a default value for missing keys</span></a>
<a class="sourceLine" id="cb1-335" title="335"></a>
<a class="sourceLine" id="cb1-336" title="336">(<span class="kw">gethash</span> &#39;d *m* :not-found) <span class="co">; =&gt; :NOT-FOUND</span></a>
<a class="sourceLine" id="cb1-337" title="337"></a>
<a class="sourceLine" id="cb1-338" title="338"><span class="co">;;; Let&#39;s handle the multiple return values here in code.</span></a>
<a class="sourceLine" id="cb1-339" title="339"></a>
<a class="sourceLine" id="cb1-340" title="340">(<span class="kw">multiple-value-bind</span> (a b)</a>
<a class="sourceLine" id="cb1-341" title="341">    (<span class="kw">gethash</span> &#39;d *m*)</a>
<a class="sourceLine" id="cb1-342" title="342">  (<span class="kw">list</span> a b))</a>
<a class="sourceLine" id="cb1-343" title="343"><span class="co">; =&gt; (NIL NIL)</span></a>
<a class="sourceLine" id="cb1-344" title="344"></a>
<a class="sourceLine" id="cb1-345" title="345">(<span class="kw">multiple-value-bind</span> (a b)</a>
<a class="sourceLine" id="cb1-346" title="346">    (<span class="kw">gethash</span> &#39;a *m*)</a>
<a class="sourceLine" id="cb1-347" title="347">  (<span class="kw">list</span> a b))</a>
<a class="sourceLine" id="cb1-348" title="348"><span class="co">; =&gt; (1 T)</span></a>
<a class="sourceLine" id="cb1-349" title="349"></a>
<a class="sourceLine" id="cb1-350" title="350"></a>
<a class="sourceLine" id="cb1-351" title="351"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-352" title="352"><span class="co">;;; 3. Functions</span></a>
<a class="sourceLine" id="cb1-353" title="353"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-354" title="354"></a>
<a class="sourceLine" id="cb1-355" title="355"><span class="co">;;; Use LAMBDA to create anonymous functions. Functions always returns the</span></a>
<a class="sourceLine" id="cb1-356" title="356"><span class="co">;;; value of the last expression. The exact printable representation of a</span></a>
<a class="sourceLine" id="cb1-357" title="357"><span class="co">;;; function varies between implementations.</span></a>
<a class="sourceLine" id="cb1-358" title="358"></a>
<a class="sourceLine" id="cb1-359" title="359">(<span class="kw">lambda</span> () <span class="st">&quot;Hello World&quot;</span>) <span class="co">; =&gt; #&lt;FUNCTION (LAMBDA ()) {1004E7818B}&gt;</span></a>
<a class="sourceLine" id="cb1-360" title="360"></a>
<a class="sourceLine" id="cb1-361" title="361"><span class="co">;;; Use FUNCALL to call anonymous functions</span></a>
<a class="sourceLine" id="cb1-362" title="362"></a>
<a class="sourceLine" id="cb1-363" title="363">(<span class="kw">funcall</span> (<span class="kw">lambda</span> () <span class="st">&quot;Hello World&quot;</span>))   <span class="co">; =&gt; &quot;Hello World&quot;</span></a>
<a class="sourceLine" id="cb1-364" title="364">(<span class="kw">funcall</span> #&#39;+ <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)                   <span class="co">; =&gt; 6</span></a>
<a class="sourceLine" id="cb1-365" title="365"></a>
<a class="sourceLine" id="cb1-366" title="366"><span class="co">;;; A call to FUNCALL is also implied when the lambda expression is the CAR of</span></a>
<a class="sourceLine" id="cb1-367" title="367"><span class="co">;;; an unquoted list</span></a>
<a class="sourceLine" id="cb1-368" title="368"></a>
<a class="sourceLine" id="cb1-369" title="369">((<span class="kw">lambda</span> () <span class="st">&quot;Hello World&quot;</span>))           <span class="co">; =&gt; &quot;Hello World&quot;</span></a>
<a class="sourceLine" id="cb1-370" title="370">((<span class="kw">lambda</span> (val) val) <span class="st">&quot;Hello World&quot;</span>)    <span class="co">; =&gt; &quot;Hello World&quot;</span></a>
<a class="sourceLine" id="cb1-371" title="371"></a>
<a class="sourceLine" id="cb1-372" title="372"><span class="co">;;; FUNCALL is used when the arguments are known beforehand. Otherwise, use APPLY</span></a>
<a class="sourceLine" id="cb1-373" title="373"></a>
<a class="sourceLine" id="cb1-374" title="374">(<span class="kw">apply</span> #&#39;+ &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>))   <span class="co">; =&gt; 6</span></a>
<a class="sourceLine" id="cb1-375" title="375">(<span class="kw">apply</span> (<span class="kw">lambda</span> () <span class="st">&quot;Hello World&quot;</span>) <span class="kw">nil</span>) <span class="co">; =&gt; &quot;Hello World&quot;</span></a>
<a class="sourceLine" id="cb1-376" title="376"></a>
<a class="sourceLine" id="cb1-377" title="377"><span class="co">;;; To name a function, use DEFUN</span></a>
<a class="sourceLine" id="cb1-378" title="378"></a>
<a class="sourceLine" id="cb1-379" title="379">(<span class="kw">defun</span><span class="fu"> hello-world </span>() <span class="st">&quot;Hello World&quot;</span>)</a>
<a class="sourceLine" id="cb1-380" title="380">(hello-world) <span class="co">; =&gt; &quot;Hello World&quot;</span></a>
<a class="sourceLine" id="cb1-381" title="381"></a>
<a class="sourceLine" id="cb1-382" title="382"><span class="co">;;; The () in the definition above is the list of arguments</span></a>
<a class="sourceLine" id="cb1-383" title="383"></a>
<a class="sourceLine" id="cb1-384" title="384">(<span class="kw">defun</span><span class="fu"> hello </span>(name) (<span class="kw">format</span> <span class="kw">nil</span> <span class="st">&quot;Hello, ~A&quot;</span> name))</a>
<a class="sourceLine" id="cb1-385" title="385">(hello <span class="st">&quot;Steve&quot;</span>) <span class="co">; =&gt; &quot;Hello, Steve&quot;</span></a>
<a class="sourceLine" id="cb1-386" title="386"></a>
<a class="sourceLine" id="cb1-387" title="387"><span class="co">;;; Functions can have optional arguments; they default to NIL</span></a>
<a class="sourceLine" id="cb1-388" title="388"></a>
<a class="sourceLine" id="cb1-389" title="389">(<span class="kw">defun</span><span class="fu"> hello </span>(name &amp;optional from)</a>
<a class="sourceLine" id="cb1-390" title="390">  (<span class="kw">if</span> from</a>
<a class="sourceLine" id="cb1-391" title="391">      (<span class="kw">format</span> <span class="kw">t</span> <span class="st">&quot;Hello, ~A, from ~A&quot;</span> name from)</a>
<a class="sourceLine" id="cb1-392" title="392">      (<span class="kw">format</span> <span class="kw">t</span> <span class="st">&quot;Hello, ~A&quot;</span> name)))</a>
<a class="sourceLine" id="cb1-393" title="393"></a>
<a class="sourceLine" id="cb1-394" title="394">(hello <span class="st">&quot;Jim&quot;</span> <span class="st">&quot;Alpacas&quot;</span>)       <span class="co">; =&gt; Hello, Jim, from Alpacas</span></a>
<a class="sourceLine" id="cb1-395" title="395"></a>
<a class="sourceLine" id="cb1-396" title="396"><span class="co">;;; The default values can also be specified</span></a>
<a class="sourceLine" id="cb1-397" title="397"></a>
<a class="sourceLine" id="cb1-398" title="398">(<span class="kw">defun</span><span class="fu"> hello </span>(name &amp;optional (from <span class="st">&quot;The world&quot;</span>))</a>
<a class="sourceLine" id="cb1-399" title="399">   (<span class="kw">format</span> <span class="kw">nil</span> <span class="st">&quot;Hello, ~A, from ~A&quot;</span> name from))</a>
<a class="sourceLine" id="cb1-400" title="400"></a>
<a class="sourceLine" id="cb1-401" title="401">(hello <span class="st">&quot;Steve&quot;</span>)               <span class="co">; =&gt; Hello, Steve, from The world</span></a>
<a class="sourceLine" id="cb1-402" title="402">(hello <span class="st">&quot;Steve&quot;</span> <span class="st">&quot;the alpacas&quot;</span>) <span class="co">; =&gt; Hello, Steve, from the alpacas</span></a>
<a class="sourceLine" id="cb1-403" title="403"></a>
<a class="sourceLine" id="cb1-404" title="404"><span class="co">;;; Functions also have keyword arguments to allow non-positional arguments</span></a>
<a class="sourceLine" id="cb1-405" title="405"></a>
<a class="sourceLine" id="cb1-406" title="406">(<span class="kw">defun</span><span class="fu"> generalized-greeter </span>(name &amp;key (from <span class="st">&quot;the world&quot;</span>) (honorific <span class="st">&quot;Mx&quot;</span>))</a>
<a class="sourceLine" id="cb1-407" title="407">  (<span class="kw">format</span> <span class="kw">t</span> <span class="st">&quot;Hello, ~A ~A, from ~A&quot;</span> honorific name from))</a>
<a class="sourceLine" id="cb1-408" title="408"></a>
<a class="sourceLine" id="cb1-409" title="409">(generalized-greeter <span class="st">&quot;Jim&quot;</span>)</a>
<a class="sourceLine" id="cb1-410" title="410"><span class="co">; =&gt; Hello, Mx Jim, from the world</span></a>
<a class="sourceLine" id="cb1-411" title="411"></a>
<a class="sourceLine" id="cb1-412" title="412">(generalized-greeter <span class="st">&quot;Jim&quot;</span> :from <span class="st">&quot;the alpacas you met last summer&quot;</span> :honorific <span class="st">&quot;Mr&quot;</span>)</a>
<a class="sourceLine" id="cb1-413" title="413"><span class="co">; =&gt; Hello, Mr Jim, from the alpacas you met last summer</span></a>
<a class="sourceLine" id="cb1-414" title="414"></a>
<a class="sourceLine" id="cb1-415" title="415"></a>
<a class="sourceLine" id="cb1-416" title="416"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-417" title="417"><span class="co">;;; 4. Equality</span></a>
<a class="sourceLine" id="cb1-418" title="418"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-419" title="419"></a>
<a class="sourceLine" id="cb1-420" title="420"><span class="co">;;; CL has a sophisticated equality system. Some are covered here.</span></a>
<a class="sourceLine" id="cb1-421" title="421"></a>
<a class="sourceLine" id="cb1-422" title="422"><span class="co">;;; For numbers, use `=&#39;</span></a>
<a class="sourceLine" id="cb1-423" title="423">(<span class="op">=</span> <span class="dv">3</span> <span class="fl">3.0</span>)               <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-424" title="424">(<span class="op">=</span> <span class="dv">2</span> <span class="dv">1</span>)                 <span class="co">; =&gt; NIL</span></a>
<a class="sourceLine" id="cb1-425" title="425"></a>
<a class="sourceLine" id="cb1-426" title="426"><span class="co">;;; For object identity (approximately) use EQL</span></a>
<a class="sourceLine" id="cb1-427" title="427">(<span class="kw">eql</span> <span class="dv">3</span> <span class="dv">3</span>)               <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-428" title="428">(<span class="kw">eql</span> <span class="dv">3</span> <span class="fl">3.0</span>)             <span class="co">; =&gt; NIL</span></a>
<a class="sourceLine" id="cb1-429" title="429">(<span class="kw">eql</span> (<span class="kw">list</span> <span class="dv">3</span>) (<span class="kw">list</span> <span class="dv">3</span>)) <span class="co">; =&gt; NIL</span></a>
<a class="sourceLine" id="cb1-430" title="430"></a>
<a class="sourceLine" id="cb1-431" title="431"><span class="co">;;; for lists, strings, and bit-vectors use EQUAL</span></a>
<a class="sourceLine" id="cb1-432" title="432">(<span class="kw">equal</span> (<span class="kw">list</span> &#39;a &#39;b) (<span class="kw">list</span> &#39;a &#39;b)) <span class="co">; =&gt; T</span></a>
<a class="sourceLine" id="cb1-433" title="433">(<span class="kw">equal</span> (<span class="kw">list</span> &#39;a &#39;b) (<span class="kw">list</span> &#39;b &#39;a)) <span class="co">; =&gt; NIL</span></a>
<a class="sourceLine" id="cb1-434" title="434"></a>
<a class="sourceLine" id="cb1-435" title="435"></a>
<a class="sourceLine" id="cb1-436" title="436"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-437" title="437"><span class="co">;;; 5. Control Flow</span></a>
<a class="sourceLine" id="cb1-438" title="438"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-439" title="439"></a>
<a class="sourceLine" id="cb1-440" title="440"><span class="co">;;; Conditionals</span></a>
<a class="sourceLine" id="cb1-441" title="441"></a>
<a class="sourceLine" id="cb1-442" title="442">(<span class="kw">if</span> <span class="kw">t</span>                <span class="co">; test expression</span></a>
<a class="sourceLine" id="cb1-443" title="443">    <span class="st">&quot;this is true&quot;</span>   <span class="co">; then expression</span></a>
<a class="sourceLine" id="cb1-444" title="444">    <span class="st">&quot;this is false&quot;</span>) <span class="co">; else expression</span></a>
<a class="sourceLine" id="cb1-445" title="445"><span class="co">; =&gt; &quot;this is true&quot;</span></a>
<a class="sourceLine" id="cb1-446" title="446"></a>
<a class="sourceLine" id="cb1-447" title="447"><span class="co">;;; In conditionals, all non-NIL values are treated as true</span></a>
<a class="sourceLine" id="cb1-448" title="448"></a>
<a class="sourceLine" id="cb1-449" title="449">(<span class="kw">member</span> &#39;Groucho &#39;(Harpo Groucho Zeppo)) <span class="co">; =&gt; &#39;(GROUCHO ZEPPO)</span></a>
<a class="sourceLine" id="cb1-450" title="450">(<span class="kw">if</span> (<span class="kw">member</span> &#39;Groucho &#39;(Harpo Groucho Zeppo))</a>
<a class="sourceLine" id="cb1-451" title="451">    &#39;yep</a>
<a class="sourceLine" id="cb1-452" title="452">    &#39;nope)</a>
<a class="sourceLine" id="cb1-453" title="453"><span class="co">; =&gt; &#39;YEP</span></a>
<a class="sourceLine" id="cb1-454" title="454"></a>
<a class="sourceLine" id="cb1-455" title="455"><span class="co">;;; COND chains a series of tests to select a result</span></a>
<a class="sourceLine" id="cb1-456" title="456">(<span class="kw">cond</span> ((<span class="op">&gt;</span> <span class="dv">2</span> <span class="dv">2</span>) (<span class="kw">error</span> <span class="st">&quot;wrong!&quot;</span>))</a>
<a class="sourceLine" id="cb1-457" title="457">      ((<span class="op">&lt;</span> <span class="dv">2</span> <span class="dv">2</span>) (<span class="kw">error</span> <span class="st">&quot;wrong again!&quot;</span>))</a>
<a class="sourceLine" id="cb1-458" title="458">      (<span class="kw">t</span> &#39;ok)) <span class="co">; =&gt; &#39;OK</span></a>
<a class="sourceLine" id="cb1-459" title="459"></a>
<a class="sourceLine" id="cb1-460" title="460"><span class="co">;;; TYPECASE switches on the type of the value</span></a>
<a class="sourceLine" id="cb1-461" title="461">(<span class="kw">typecase</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1-462" title="462">  (<span class="kw">string</span> :string)</a>
<a class="sourceLine" id="cb1-463" title="463">  (<span class="kw">integer</span> :int))</a>
<a class="sourceLine" id="cb1-464" title="464"><span class="co">; =&gt; :int</span></a>
<a class="sourceLine" id="cb1-465" title="465"></a>
<a class="sourceLine" id="cb1-466" title="466"></a>
<a class="sourceLine" id="cb1-467" title="467"><span class="co">;;; Looping</span></a>
<a class="sourceLine" id="cb1-468" title="468"></a>
<a class="sourceLine" id="cb1-469" title="469"><span class="co">;;; Recursion</span></a>
<a class="sourceLine" id="cb1-470" title="470"></a>
<a class="sourceLine" id="cb1-471" title="471">(<span class="kw">defun</span><span class="fu"> fact </span>(n)</a>
<a class="sourceLine" id="cb1-472" title="472">  (<span class="kw">if</span> (<span class="op">&lt;</span> n <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-473" title="473">      <span class="dv">1</span></a>
<a class="sourceLine" id="cb1-474" title="474">    (<span class="op">*</span> n (fact(<span class="op">-</span> n <span class="dv">1</span>)))))</a>
<a class="sourceLine" id="cb1-475" title="475"></a>
<a class="sourceLine" id="cb1-476" title="476">(fact <span class="dv">5</span>) <span class="co">; =&gt; 120</span></a>
<a class="sourceLine" id="cb1-477" title="477"></a>
<a class="sourceLine" id="cb1-478" title="478"><span class="co">;;; Iteration</span></a>
<a class="sourceLine" id="cb1-479" title="479"></a>
<a class="sourceLine" id="cb1-480" title="480">(<span class="kw">defun</span><span class="fu"> fact </span>(n)</a>
<a class="sourceLine" id="cb1-481" title="481">  (<span class="kw">loop</span> :for result <span class="op">=</span> <span class="dv">1</span> :then (<span class="op">*</span> result i)</a>
<a class="sourceLine" id="cb1-482" title="482">     :for i :from <span class="dv">2</span> :to n</a>
<a class="sourceLine" id="cb1-483" title="483">     :finally (<span class="kw">return</span> result)))</a>
<a class="sourceLine" id="cb1-484" title="484"></a>
<a class="sourceLine" id="cb1-485" title="485">(fact <span class="dv">5</span>) <span class="co">; =&gt; 120</span></a>
<a class="sourceLine" id="cb1-486" title="486"></a>
<a class="sourceLine" id="cb1-487" title="487">(<span class="kw">loop</span> :for x :across <span class="st">&quot;abcd&quot;</span> :collect x)</a>
<a class="sourceLine" id="cb1-488" title="488"><span class="co">; =&gt; (#\a #\b #\c #\d)</span></a>
<a class="sourceLine" id="cb1-489" title="489"></a>
<a class="sourceLine" id="cb1-490" title="490">(<span class="kw">dolist</span> (i &#39;(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb1-491" title="491">  (<span class="kw">format</span> <span class="kw">t</span> <span class="st">&quot;~A&quot;</span> i))</a>
<a class="sourceLine" id="cb1-492" title="492"><span class="co">; =&gt; 1234</span></a>
<a class="sourceLine" id="cb1-493" title="493"></a>
<a class="sourceLine" id="cb1-494" title="494"></a>
<a class="sourceLine" id="cb1-495" title="495"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-496" title="496"><span class="co">;;; 6. Mutation</span></a>
<a class="sourceLine" id="cb1-497" title="497"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-498" title="498"></a>
<a class="sourceLine" id="cb1-499" title="499"><span class="co">;;; Use SETF to assign a new value to an existing variable. This was</span></a>
<a class="sourceLine" id="cb1-500" title="500"><span class="co">;;; demonstrated earlier in the hash table example.</span></a>
<a class="sourceLine" id="cb1-501" title="501"></a>
<a class="sourceLine" id="cb1-502" title="502">(<span class="kw">let</span> ((variable <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb1-503" title="503">    (<span class="kw">setf</span> variable <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-504" title="504"><span class="co">; =&gt; 2</span></a>
<a class="sourceLine" id="cb1-505" title="505"></a>
<a class="sourceLine" id="cb1-506" title="506"><span class="co">;;; Good Lisp style is to minimize the use of destructive functions and to avoid</span></a>
<a class="sourceLine" id="cb1-507" title="507"><span class="co">;;; mutation when reasonable.</span></a>
<a class="sourceLine" id="cb1-508" title="508"></a>
<a class="sourceLine" id="cb1-509" title="509"></a>
<a class="sourceLine" id="cb1-510" title="510"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-511" title="511"><span class="co">;;; 7. Classes and objects</span></a>
<a class="sourceLine" id="cb1-512" title="512"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-513" title="513"></a>
<a class="sourceLine" id="cb1-514" title="514"><span class="co">;;; No more animal classes. Let&#39;s have Human-Powered Mechanical</span></a>
<a class="sourceLine" id="cb1-515" title="515"><span class="co">;;; Conveyances.</span></a>
<a class="sourceLine" id="cb1-516" title="516"></a>
<a class="sourceLine" id="cb1-517" title="517">(<span class="kw">defclass</span><span class="fu"> human-powered-conveyance </span>()</a>
<a class="sourceLine" id="cb1-518" title="518">  ((velocity</a>
<a class="sourceLine" id="cb1-519" title="519">    :accessor velocity</a>
<a class="sourceLine" id="cb1-520" title="520">    :initarg :velocity)</a>
<a class="sourceLine" id="cb1-521" title="521">   (average-efficiency</a>
<a class="sourceLine" id="cb1-522" title="522">    :accessor average-efficiency</a>
<a class="sourceLine" id="cb1-523" title="523">   :initarg :average-efficiency))</a>
<a class="sourceLine" id="cb1-524" title="524">  (:documentation <span class="st">&quot;A human powered conveyance&quot;</span>))</a>
<a class="sourceLine" id="cb1-525" title="525"></a>
<a class="sourceLine" id="cb1-526" title="526"><span class="co">;;; The arguments to DEFCLASS, in order are:</span></a>
<a class="sourceLine" id="cb1-527" title="527"><span class="co">;;; 1. class name</span></a>
<a class="sourceLine" id="cb1-528" title="528"><span class="co">;;; 2. superclass list</span></a>
<a class="sourceLine" id="cb1-529" title="529"><span class="co">;;; 3. slot list</span></a>
<a class="sourceLine" id="cb1-530" title="530"><span class="co">;;; 4. optional specifiers</span></a>
<a class="sourceLine" id="cb1-531" title="531"></a>
<a class="sourceLine" id="cb1-532" title="532"><span class="co">;;; When no superclass list is set, the empty list defaults to the</span></a>
<a class="sourceLine" id="cb1-533" title="533"><span class="co">;;; standard-object class. This *can* be changed, but not until you</span></a>
<a class="sourceLine" id="cb1-534" title="534"><span class="co">;;; know what you&#39;re doing. Look up the Art of the Metaobject Protocol</span></a>
<a class="sourceLine" id="cb1-535" title="535"><span class="co">;;; for more information.</span></a>
<a class="sourceLine" id="cb1-536" title="536"></a>
<a class="sourceLine" id="cb1-537" title="537">(<span class="kw">defclass</span><span class="fu"> bicycle </span>(human-powered-conveyance)</a>
<a class="sourceLine" id="cb1-538" title="538">  ((wheel-size</a>
<a class="sourceLine" id="cb1-539" title="539">    :accessor wheel-size</a>
<a class="sourceLine" id="cb1-540" title="540">    :initarg :wheel-size</a>
<a class="sourceLine" id="cb1-541" title="541">    :documentation <span class="st">&quot;Diameter of the wheel.&quot;</span>)</a>
<a class="sourceLine" id="cb1-542" title="542">   (height</a>
<a class="sourceLine" id="cb1-543" title="543">    :accessor height</a>
<a class="sourceLine" id="cb1-544" title="544">    :initarg :height)))</a>
<a class="sourceLine" id="cb1-545" title="545"></a>
<a class="sourceLine" id="cb1-546" title="546">(<span class="kw">defclass</span><span class="fu"> recumbent </span>(bicycle)</a>
<a class="sourceLine" id="cb1-547" title="547">  ((chain-type</a>
<a class="sourceLine" id="cb1-548" title="548">    :accessor chain-type</a>
<a class="sourceLine" id="cb1-549" title="549">    :initarg :chain-type)))</a>
<a class="sourceLine" id="cb1-550" title="550"></a>
<a class="sourceLine" id="cb1-551" title="551">(<span class="kw">defclass</span><span class="fu"> unicycle </span>(human-powered-conveyance) <span class="kw">nil</span>)</a>
<a class="sourceLine" id="cb1-552" title="552"></a>
<a class="sourceLine" id="cb1-553" title="553">(<span class="kw">defclass</span><span class="fu"> canoe </span>(human-powered-conveyance)</a>
<a class="sourceLine" id="cb1-554" title="554">  ((number-of-rowers</a>
<a class="sourceLine" id="cb1-555" title="555">    :accessor number-of-rowers</a>
<a class="sourceLine" id="cb1-556" title="556">    :initarg :number-of-rowers)))</a>
<a class="sourceLine" id="cb1-557" title="557"></a>
<a class="sourceLine" id="cb1-558" title="558"><span class="co">;;; Calling DESCRIBE on the HUMAN-POWERED-CONVEYANCE class in the REPL gives:</span></a>
<a class="sourceLine" id="cb1-559" title="559"></a>
<a class="sourceLine" id="cb1-560" title="560">(<span class="kw">describe</span> &#39;human-powered-conveyance)</a>
<a class="sourceLine" id="cb1-561" title="561"></a>
<a class="sourceLine" id="cb1-562" title="562"><span class="co">; COMMON-LISP-USER::HUMAN-POWERED-CONVEYANCE</span></a>
<a class="sourceLine" id="cb1-563" title="563"><span class="co">;  [symbol]</span></a>
<a class="sourceLine" id="cb1-564" title="564"><span class="co">;</span></a>
<a class="sourceLine" id="cb1-565" title="565"><span class="co">; HUMAN-POWERED-CONVEYANCE names the standard-class #&lt;STANDARD-CLASS</span></a>
<a class="sourceLine" id="cb1-566" title="566"><span class="co">;                                                    HUMAN-POWERED-CONVEYANCE&gt;:</span></a>
<a class="sourceLine" id="cb1-567" title="567"><span class="co">;  Documentation:</span></a>
<a class="sourceLine" id="cb1-568" title="568"><span class="co">;    A human powered conveyance</span></a>
<a class="sourceLine" id="cb1-569" title="569"><span class="co">;  Direct superclasses: STANDARD-OBJECT</span></a>
<a class="sourceLine" id="cb1-570" title="570"><span class="co">;  Direct subclasses: UNICYCLE, BICYCLE, CANOE</span></a>
<a class="sourceLine" id="cb1-571" title="571"><span class="co">;  Not yet finalized.</span></a>
<a class="sourceLine" id="cb1-572" title="572"><span class="co">;  Direct slots:</span></a>
<a class="sourceLine" id="cb1-573" title="573"><span class="co">;    VELOCITY</span></a>
<a class="sourceLine" id="cb1-574" title="574"><span class="co">;      Readers: VELOCITY</span></a>
<a class="sourceLine" id="cb1-575" title="575"><span class="co">;      Writers: (SETF VELOCITY)</span></a>
<a class="sourceLine" id="cb1-576" title="576"><span class="co">;    AVERAGE-EFFICIENCY</span></a>
<a class="sourceLine" id="cb1-577" title="577"><span class="co">;      Readers: AVERAGE-EFFICIENCY</span></a>
<a class="sourceLine" id="cb1-578" title="578"><span class="co">;      Writers: (SETF AVERAGE-EFFICIENCY)</span></a>
<a class="sourceLine" id="cb1-579" title="579"></a>
<a class="sourceLine" id="cb1-580" title="580"><span class="co">;;; Note the reflective behavior available. CL was designed to be an</span></a>
<a class="sourceLine" id="cb1-581" title="581"><span class="co">;;; interactive system</span></a>
<a class="sourceLine" id="cb1-582" title="582"></a>
<a class="sourceLine" id="cb1-583" title="583"><span class="co">;;; To define a method, let&#39;s find out what our circumference of the</span></a>
<a class="sourceLine" id="cb1-584" title="584"><span class="co">;;; bike wheel turns out to be using the equation: C = d * pi</span></a>
<a class="sourceLine" id="cb1-585" title="585"></a>
<a class="sourceLine" id="cb1-586" title="586">(<span class="kw">defmethod</span><span class="fu"> circumference </span>((object bicycle))</a>
<a class="sourceLine" id="cb1-587" title="587">  (<span class="op">*</span> <span class="kw">pi</span> (wheel-size object)))</a>
<a class="sourceLine" id="cb1-588" title="588"></a>
<a class="sourceLine" id="cb1-589" title="589"><span class="co">;;; PI is defined as a built-in in CL</span></a>
<a class="sourceLine" id="cb1-590" title="590"></a>
<a class="sourceLine" id="cb1-591" title="591"><span class="co">;;; Let&#39;s suppose we find out that the efficiency value of the number</span></a>
<a class="sourceLine" id="cb1-592" title="592"><span class="co">;;; of rowers in a canoe is roughly logarithmic. This should probably be set</span></a>
<a class="sourceLine" id="cb1-593" title="593"><span class="co">;;; in the constructor/initializer.</span></a>
<a class="sourceLine" id="cb1-594" title="594"></a>
<a class="sourceLine" id="cb1-595" title="595"><span class="co">;;; To initialize your instance after CL gets done constructing it:</span></a>
<a class="sourceLine" id="cb1-596" title="596"></a>
<a class="sourceLine" id="cb1-597" title="597">(<span class="kw">defmethod</span><span class="fu"> initialize-instance </span>:after ((object canoe) &amp;<span class="kw">rest</span> args)</a>
<a class="sourceLine" id="cb1-598" title="598">  (<span class="kw">setf</span> (average-efficiency object)  (<span class="kw">log</span> (<span class="op">1+</span> (number-of-rowers object)))))</a>
<a class="sourceLine" id="cb1-599" title="599"></a>
<a class="sourceLine" id="cb1-600" title="600"><span class="co">;;; Then to construct an instance and check the average efficiency...</span></a>
<a class="sourceLine" id="cb1-601" title="601"></a>
<a class="sourceLine" id="cb1-602" title="602">(average-efficiency (<span class="kw">make-instance</span> &#39;canoe :number-of-rowers <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb1-603" title="603"><span class="co">; =&gt; 2.7725887</span></a>
<a class="sourceLine" id="cb1-604" title="604"></a>
<a class="sourceLine" id="cb1-605" title="605"></a>
<a class="sourceLine" id="cb1-606" title="606"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-607" title="607"><span class="co">;;; 8. Macros</span></a>
<a class="sourceLine" id="cb1-608" title="608"><span class="co">;;;-----------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb1-609" title="609"></a>
<a class="sourceLine" id="cb1-610" title="610"><span class="co">;;; Macros let you extend the syntax of the language. CL doesn&#39;t come</span></a>
<a class="sourceLine" id="cb1-611" title="611"><span class="co">;;; with a WHILE loop, however, it&#39;s trivial to write one. If we obey our</span></a>
<a class="sourceLine" id="cb1-612" title="612"><span class="co">;;; assembler instincts, we wind up with:</span></a>
<a class="sourceLine" id="cb1-613" title="613"></a>
<a class="sourceLine" id="cb1-614" title="614">(<span class="kw">defmacro</span><span class="fu"> while </span>(<span class="kw">condition</span> &amp;body body)</a>
<a class="sourceLine" id="cb1-615" title="615">    <span class="st">&quot;While `condition` is true, `body` is executed.</span></a>
<a class="sourceLine" id="cb1-616" title="616"><span class="st">`condition` is tested prior to each execution of `body`&quot;</span></a>
<a class="sourceLine" id="cb1-617" title="617">    (<span class="kw">let</span> ((block-name (<span class="kw">gensym</span>)) (done (<span class="kw">gensym</span>)))</a>
<a class="sourceLine" id="cb1-618" title="618">        `(<span class="kw">tagbody</span></a>
<a class="sourceLine" id="cb1-619" title="619">           ,block-name</a>
<a class="sourceLine" id="cb1-620" title="620">           (<span class="kw">unless</span> ,<span class="kw">condition</span></a>
<a class="sourceLine" id="cb1-621" title="621">               (<span class="kw">go</span> ,done))</a>
<a class="sourceLine" id="cb1-622" title="622">           (<span class="kw">progn</span></a>
<a class="sourceLine" id="cb1-623" title="623">           ,@body)</a>
<a class="sourceLine" id="cb1-624" title="624">           (<span class="kw">go</span> ,block-name)</a>
<a class="sourceLine" id="cb1-625" title="625">           ,done)))</a>
<a class="sourceLine" id="cb1-626" title="626"></a>
<a class="sourceLine" id="cb1-627" title="627"><span class="co">;;; Let&#39;s look at the high-level version of this:</span></a>
<a class="sourceLine" id="cb1-628" title="628"></a>
<a class="sourceLine" id="cb1-629" title="629">(<span class="kw">defmacro</span><span class="fu"> while </span>(<span class="kw">condition</span> &amp;body body)</a>
<a class="sourceLine" id="cb1-630" title="630">    <span class="st">&quot;While `condition` is true, `body` is executed.</span></a>
<a class="sourceLine" id="cb1-631" title="631"><span class="st">`condition` is tested prior to each execution of `body`&quot;</span></a>
<a class="sourceLine" id="cb1-632" title="632">  `(<span class="kw">loop</span> while ,<span class="kw">condition</span></a>
<a class="sourceLine" id="cb1-633" title="633">         <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-634" title="634">         (<span class="kw">progn</span></a>
<a class="sourceLine" id="cb1-635" title="635">            ,@body)))</a>
<a class="sourceLine" id="cb1-636" title="636"></a>
<a class="sourceLine" id="cb1-637" title="637"><span class="co">;;; However, with a modern compiler, this is not required; the LOOP form</span></a>
<a class="sourceLine" id="cb1-638" title="638"><span class="co">;;; compiles equally well and is easier to read.</span></a>
<a class="sourceLine" id="cb1-639" title="639"></a>
<a class="sourceLine" id="cb1-640" title="640"><span class="co">;;; Note that ``` is used, as well as `,` and `@`. ``` is a quote-type operator</span></a>
<a class="sourceLine" id="cb1-641" title="641"><span class="co">;;; known as quasiquote; it allows the use of `,` . `,` allows &quot;unquoting&quot;</span></a>
<a class="sourceLine" id="cb1-642" title="642"><span class="co">;;; variables. @ interpolates lists.</span></a>
<a class="sourceLine" id="cb1-643" title="643"></a>
<a class="sourceLine" id="cb1-644" title="644"><span class="co">;;; GENSYM creates a unique symbol guaranteed to not exist elsewhere in</span></a>
<a class="sourceLine" id="cb1-645" title="645"><span class="co">;;; the system. This is because macros are expanded at compile time and</span></a>
<a class="sourceLine" id="cb1-646" title="646"><span class="co">;;; variables declared in the macro can collide with variables used in</span></a>
<a class="sourceLine" id="cb1-647" title="647"><span class="co">;;; regular code.</span></a>
<a class="sourceLine" id="cb1-648" title="648"></a>
<a class="sourceLine" id="cb1-649" title="649"><span class="co">;;; See Practical Common Lisp and On Lisp for more information on macros.</span></a></code></pre>
    </div>
    <h2 id="further-reading">Further reading</h2>
    <ul>
      <li>
        <a href="http://www.gigamonkeys.com/book/">Practical Common Lisp</a>
      </li>
      <li>
        <a href="https://www.cs.cmu.edu/~dst/LispBook/book.pdf"
          >Common Lisp: A Gentle Introduction to Symbolic Computation</a
        >
      </li>
    </ul>
    <h2 id="extra-information">Extra information</h2>
    <ul>
      <li><a href="http://www.cliki.net/">CLiki</a></li>
      <li><a href="https://common-lisp.net/">common-lisp.net</a></li>
      <li>
        <a href="https://github.com/CodyReichert/awesome-cl"
          >Awesome Common Lisp</a
        >
      </li>
      <li><a href="http://lisp-lang.org/">Lisp Lang</a></li>
    </ul>
    <h2 id="credits">Credits</h2>
    <p>
      Lots of thanks to the Scheme people for rolling up a great starting point
      which could be easily moved to Common Lisp.
    </p>
    <ul>
      <li>
        <a href="https://github.com/pkhuong">Paul Khuong</a> for some great
        reviewing.
      </li>
    </ul>
  </body>
</html>
