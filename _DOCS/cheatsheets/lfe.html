<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>lfe</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<p>Lisp Flavoured Erlang(LFE) is a functional, concurrent, general-purpose programming language and Lisp dialect(Lisp-2) built on top of Core Erlang and the Erlang Virtual Machine(BEAM).</p>
<p>LFE can be obtained from <a href="https://github.com/rvirding/lfe">LFE</a></p>
<p>The classic starting point is <a href="http://docs.lfe.io">LFE DOCS.</a></p>
<p>Another new site is being built to replace it.<a href="http://docs.lfe.io/dev">LFE DEV.</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb1-1" title="1"></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">;;; 0. Syntax</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">;;; General form.</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">;; Lisp comprises of two syntax called: the ATOM and the S-expression.</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">;; `forms` are known as grouped S-expressions.</span></a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="dv">8</span>  <span class="co">; an atom; it evaluates to itself</span></a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13">:ERLANG <span class="co">;Atom; evaluates to the symbol :ERLANG.</span></a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">t</span>  <span class="co">; another atom which denotes true.</span></a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17">(<span class="op">*</span> <span class="dv">2</span> <span class="dv">21</span>) <span class="co">; an S- expression</span></a>
<a class="sourceLine" id="cb1-18" title="18"></a>
<a class="sourceLine" id="cb1-19" title="19">&#39;(<span class="dv">8</span> :foo <span class="kw">t</span>)  <span class="co">;another one</span></a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21"></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">;;; Comments</span></a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">;; Single line comments start with a semicolon; use two for normal</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">;; comments, three for section comments, and four fo file-level</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">;; comments.</span></a>
<a class="sourceLine" id="cb1-27" title="27"></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">;; Block Comment</span></a>
<a class="sourceLine" id="cb1-29" title="29"></a>
<a class="sourceLine" id="cb1-30" title="30">   <span class="co">#| comment text |#</span></a>
<a class="sourceLine" id="cb1-31" title="31"></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">;;; Environment</span></a>
<a class="sourceLine" id="cb1-33" title="33"></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">;; LFE is the de-facto standard.</span></a>
<a class="sourceLine" id="cb1-35" title="35"></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">;; Libraries can be used directly from the Erlang ecosystem. Rebar3 is the build tool.</span></a>
<a class="sourceLine" id="cb1-37" title="37"></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="co">;; LFE is usually developed with a text editor(preferably Emacs) and a REPL</span></a>
<a class="sourceLine" id="cb1-39" title="39"><span class="co">;; (Read Evaluate Print Loop) running at the same time. The REPL</span></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="co">;; allows for interactive exploration of the program as it is &quot;live&quot;</span></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="co">;; in the system.</span></a>
<a class="sourceLine" id="cb1-42" title="42"></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co">;;; 1. Literals and Special Syntactic Rules</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-46" title="46"></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="co">;;; Integers</span></a>
<a class="sourceLine" id="cb1-48" title="48"></a>
<a class="sourceLine" id="cb1-49" title="49"><span class="dv">1234</span> <span class="dv">-123</span>           <span class="co">; Regular decimal notation</span></a>
<a class="sourceLine" id="cb1-50" title="50"><span class="ch">#b</span>0 #b10101         ; Binary notation</a>
<a class="sourceLine" id="cb1-51" title="51">#<span class="dv">0</span> #<span class="dv">10101</span>           <span class="co">; Binary notation (alternative form)</span></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="ch">#o</span>377 #o<span class="dv">-111</span>        <span class="co">; Octal notation</span></a>
<a class="sourceLine" id="cb1-53" title="53"><span class="ch">#d</span>123456789 #d+<span class="dv">123</span>  <span class="co">; Explicitly decimal notation</span></a>
<a class="sourceLine" id="cb1-54" title="54"><span class="ch">#x</span>c0ffe 0x<span class="dv">-01</span>       <span class="co">; Hexadecimal notation</span></a>
<a class="sourceLine" id="cb1-55" title="55">#2r1010 #8r377      <span class="co">;Notation with explicit base (up to 36)</span></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="ch">#\a</span> #$ <span class="ch">#\√§</span> <span class="ch">#\üê≠</span>     <span class="co">;Character notation (the value is the Unicode code point of the character)</span></a>
<a class="sourceLine" id="cb1-57" title="57"><span class="ch">#\x</span>1f42d<span class="co">;           ;Character notation with the value in hexadecimal</span></a>
<a class="sourceLine" id="cb1-58" title="58"></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="co">;;; Floating point numbers</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="fl">1.0</span> <span class="fl">+2.0</span> <span class="fl">-1.5</span> <span class="fl">1.0e10</span> <span class="fl">1.111e-10</span></a>
<a class="sourceLine" id="cb1-61" title="61"></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="co">;;; Strings</span></a>
<a class="sourceLine" id="cb1-63" title="63"></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="st">&quot;any text between double quotes where </span><span class="sc">\&quot;</span><span class="st"> and other special characters like </span><span class="sc">\n</span><span class="st"> can be escaped&quot;</span>.</a>
<a class="sourceLine" id="cb1-65" title="65"><span class="co">; List String</span></a>
<a class="sourceLine" id="cb1-66" title="66"><span class="st">&quot;Cat: </span><span class="sc">\x1f639</span><span class="st">;&quot;</span> <span class="co">; writing unicode in string for regular font ending with semicolon.</span></a>
<a class="sourceLine" id="cb1-67" title="67"></a>
<a class="sourceLine" id="cb1-68" title="68">#<span class="st">&quot;This is a binary string </span><span class="sc">\n</span><span class="st"> with some </span><span class="sc">\&quot;</span><span class="st">escaped</span><span class="sc">\&quot;</span><span class="st"> and quoted (</span><span class="sc">\x1f639</span><span class="st">;) characters&quot;</span></a>
<a class="sourceLine" id="cb1-69" title="69"><span class="co">; Binary strings are just strings but function different in the VM.</span></a>
<a class="sourceLine" id="cb1-70" title="70"><span class="co">; Other ways of writing it are:  #B(&quot;a&quot;), #&quot;a&quot;, and #B(97).</span></a>
<a class="sourceLine" id="cb1-71" title="71"></a>
<a class="sourceLine" id="cb1-72" title="72"></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="co">;;; Character escaping</span></a>
<a class="sourceLine" id="cb1-74" title="74"></a>
<a class="sourceLine" id="cb1-75" title="75">\b  <span class="co">; =&gt; Backspace</span></a>
<a class="sourceLine" id="cb1-76" title="76">\t  <span class="co">; =&gt; Tab</span></a>
<a class="sourceLine" id="cb1-77" title="77">\n  <span class="co">; =&gt; Newline</span></a>
<a class="sourceLine" id="cb1-78" title="78">\v  <span class="co">; =&gt; Vertical tab</span></a>
<a class="sourceLine" id="cb1-79" title="79">\f  <span class="co">; =&gt; Form Feed</span></a>
<a class="sourceLine" id="cb1-80" title="80">\r  <span class="co">; =&gt; Carriage Return</span></a>
<a class="sourceLine" id="cb1-81" title="81">\e  <span class="co">; =&gt; Escape</span></a>
<a class="sourceLine" id="cb1-82" title="82">\s  <span class="co">; =&gt; Space</span></a>
<a class="sourceLine" id="cb1-83" title="83">\d  <span class="co">; =&gt; Delete</span></a>
<a class="sourceLine" id="cb1-84" title="84"></a>
<a class="sourceLine" id="cb1-85" title="85"><span class="co">;;; Binaries</span></a>
<a class="sourceLine" id="cb1-86" title="86"><span class="co">;; It is used to create binaries with any contents.</span></a>
<a class="sourceLine" id="cb1-87" title="87">#B((#<span class="st">&quot;a&quot;</span> binary) (#<span class="st">&quot;b&quot;</span> binary))                <span class="co">; #&quot;ab&quot; (Evaluated form)</span></a>
<a class="sourceLine" id="cb1-88" title="88"></a>
<a class="sourceLine" id="cb1-89" title="89"><span class="co">;;; Lists are: () or (foo bar baz)</span></a>
<a class="sourceLine" id="cb1-90" title="90"></a>
<a class="sourceLine" id="cb1-91" title="91"><span class="co">;;; Tuples are written in: #(value1 value2 ...). Empty tuple #() is also valid.</span></a>
<a class="sourceLine" id="cb1-92" title="92"></a>
<a class="sourceLine" id="cb1-93" title="93"><span class="co">;;; Maps are written as: #M(key1 value1 key2 value2 ...). Empty map #M() is also valid.</span></a>
<a class="sourceLine" id="cb1-94" title="94"></a>
<a class="sourceLine" id="cb1-95" title="95"><span class="co">;;; Symbols: Things that cannot be parsed. Eg: foo, Foo, foo-bar, :foo</span></a>
<a class="sourceLine" id="cb1-96" title="96">| foo | <span class="co">; explicit construction of symbol by wrapping vertical bars.</span></a>
<a class="sourceLine" id="cb1-97" title="97"></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="co">;;; Evaluation</span></a>
<a class="sourceLine" id="cb1-99" title="99"></a>
<a class="sourceLine" id="cb1-100" title="100"><span class="co">;; #.(... some expression ...). E.g. &#39;#.(+ 1 1) will evaluate the (+ 1 1) while it            ;; reads the expression and then be effectively &#39;2.</span></a>
<a class="sourceLine" id="cb1-101" title="101"></a>
<a class="sourceLine" id="cb1-102" title="102"><span class="co">;; List comprehension in LFE REPL</span></a>
<a class="sourceLine" id="cb1-103" title="103"></a>
<a class="sourceLine" id="cb1-104" title="104">lfe&gt; (list-comp</a>
<a class="sourceLine" id="cb1-105" title="105">          ((&lt;- x &#39;(<span class="dv">0</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb1-106" title="106">          (trunc (math:pow <span class="dv">3</span> x)))</a>
<a class="sourceLine" id="cb1-107" title="107">       (<span class="dv">1</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">27</span>)</a>
<a class="sourceLine" id="cb1-108" title="108"></a>
<a class="sourceLine" id="cb1-109" title="109"></a>
<a class="sourceLine" id="cb1-110" title="110"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-111" title="111"><span class="co">;; 2. Core forms</span></a>
<a class="sourceLine" id="cb1-112" title="112"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-113" title="113"></a>
<a class="sourceLine" id="cb1-114" title="114"><span class="co">;; These forms are same as those found at Common Lisp and Scheme.</span></a>
<a class="sourceLine" id="cb1-115" title="115"></a>
<a class="sourceLine" id="cb1-116" title="116">(<span class="kw">quote</span> e)</a>
<a class="sourceLine" id="cb1-117" title="117">(<span class="kw">cons</span> head tail)</a>
<a class="sourceLine" id="cb1-118" title="118">(<span class="kw">car</span> e)</a>
<a class="sourceLine" id="cb1-119" title="119">(<span class="kw">cdr</span> e)</a>
<a class="sourceLine" id="cb1-120" title="120">(<span class="kw">list</span> e ... )</a>
<a class="sourceLine" id="cb1-121" title="121">(tuple e ... )</a>
<a class="sourceLine" id="cb1-122" title="122">(binary seg ... )</a>
<a class="sourceLine" id="cb1-123" title="123">(<span class="kw">map</span> key val ...), (map-get m k), (map-set m k v ...), (map-update m k v ...)</a>
<a class="sourceLine" id="cb1-124" title="124"></a>
<a class="sourceLine" id="cb1-125" title="125">(<span class="kw">lambda</span> (arg ...) ...)</a>
<a class="sourceLine" id="cb1-126" title="126">  (match-lambda</a>
<a class="sourceLine" id="cb1-127" title="127">    ((arg ... ) {{(<span class="kw">when</span> e ...)}} ...) <span class="co">; Matches clauses</span></a>
<a class="sourceLine" id="cb1-128" title="128">    ... )</a>
<a class="sourceLine" id="cb1-129" title="129">(<span class="kw">let</span> ((pat {{(<span class="kw">when</span> e ...)}} e)</a>
<a class="sourceLine" id="cb1-130" title="130">      ...)</a>
<a class="sourceLine" id="cb1-131" title="131">  ... )</a>
<a class="sourceLine" id="cb1-132" title="132">(let-function ((name <span class="kw">lambda</span>|match-lambda) <span class="co">; Only define local</span></a>
<a class="sourceLine" id="cb1-133" title="133">               ... )                      <span class="co">; functions</span></a>
<a class="sourceLine" id="cb1-134" title="134">  ... )</a>
<a class="sourceLine" id="cb1-135" title="135">(letrec-function ((name <span class="kw">lambda</span>|match-lambda) <span class="co">; Only define local</span></a>
<a class="sourceLine" id="cb1-136" title="136">                  ... )                      <span class="co">; functions</span></a>
<a class="sourceLine" id="cb1-137" title="137">  ... )</a>
<a class="sourceLine" id="cb1-138" title="138">(let-macro ((name lambda-match-lambda) <span class="co">; Only define local</span></a>
<a class="sourceLine" id="cb1-139" title="139">            ...)                       <span class="co">; macros</span></a>
<a class="sourceLine" id="cb1-140" title="140">  ...)</a>
<a class="sourceLine" id="cb1-141" title="141">(<span class="kw">progn</span> ... )</a>
<a class="sourceLine" id="cb1-142" title="142">(<span class="kw">if</span> test true-expr {{false-expr}})</a>
<a class="sourceLine" id="cb1-143" title="143">(<span class="kw">case</span> e</a>
<a class="sourceLine" id="cb1-144" title="144">  (pat {{(<span class="kw">when</span> e ...)}} ...)</a>
<a class="sourceLine" id="cb1-145" title="145">   ... ))</a>
<a class="sourceLine" id="cb1-146" title="146">(receive</a>
<a class="sourceLine" id="cb1-147" title="147">  (pat {{(<span class="kw">when</span> e ...)}} ... )</a>
<a class="sourceLine" id="cb1-148" title="148">  ...</a>
<a class="sourceLine" id="cb1-149" title="149">  (after timeout ... ))</a>
<a class="sourceLine" id="cb1-150" title="150">(<span class="kw">catch</span> ... )</a>
<a class="sourceLine" id="cb1-151" title="151">(try</a>
<a class="sourceLine" id="cb1-152" title="152">  e</a>
<a class="sourceLine" id="cb1-153" title="153">  {{(<span class="kw">case</span> ((pat {{(<span class="kw">when</span> e ...)}} ... )</a>
<a class="sourceLine" id="cb1-154" title="154">          ... ))}}</a>
<a class="sourceLine" id="cb1-155" title="155">  {{(<span class="kw">catch</span></a>
<a class="sourceLine" id="cb1-156" title="156">     <span class="co">; Next must be tuple of length 3!</span></a>
<a class="sourceLine" id="cb1-157" title="157">     (((tuple <span class="kw">type</span> value <span class="kw">ignore</span>) {{(<span class="kw">when</span> e ...)}}</a>
<a class="sourceLine" id="cb1-158" title="158">      ... )</a>
<a class="sourceLine" id="cb1-159" title="159">     ... )}}</a>
<a class="sourceLine" id="cb1-160" title="160">  {{(after ... )}})</a>
<a class="sourceLine" id="cb1-161" title="161"></a>
<a class="sourceLine" id="cb1-162" title="162">(<span class="kw">funcall</span> func arg ... )</a>
<a class="sourceLine" id="cb1-163" title="163">(call <span class="kw">mod</span> func arg ... ) <span class="op">-</span> Call to Erlang Mod:Func(Arg, ... )</a>
<a class="sourceLine" id="cb1-164" title="164">(define-module name <span class="kw">declaration</span> ... )</a>
<a class="sourceLine" id="cb1-165" title="165">(extend-module <span class="kw">declaration</span> ... ) <span class="op">-</span> Define/extend module <span class="kw">and</span> declarations.</a>
<a class="sourceLine" id="cb1-166" title="166">(define-function name <span class="kw">lambda</span>|match-lambda)</a>
<a class="sourceLine" id="cb1-167" title="167">(define-macro name <span class="kw">lambda</span>|match-lambda) <span class="op">-</span> Define functions/macros at top-level.</a>
<a class="sourceLine" id="cb1-168" title="168"></a>
<a class="sourceLine" id="cb1-169" title="169"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-170" title="170"><span class="co">;; 3. Macros</span></a>
<a class="sourceLine" id="cb1-171" title="171"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-172" title="172"></a>
<a class="sourceLine" id="cb1-173" title="173"><span class="co">;; Macros are part of the language to allow you to create abstractions</span></a>
<a class="sourceLine" id="cb1-174" title="174"><span class="co">;; on top of the core language and standard library that move you closer</span></a>
<a class="sourceLine" id="cb1-175" title="175"><span class="co">;; toward being able to directly express the things you want to express.</span></a>
<a class="sourceLine" id="cb1-176" title="176"></a>
<a class="sourceLine" id="cb1-177" title="177"><span class="co">;; Top-level function</span></a>
<a class="sourceLine" id="cb1-178" title="178"></a>
<a class="sourceLine" id="cb1-179" title="179">(<span class="kw">defun</span><span class="fu"> name </span>(arg ...) ...)</a>
<a class="sourceLine" id="cb1-180" title="180"></a>
<a class="sourceLine" id="cb1-181" title="181"><span class="co">;; Adding comments in functions</span></a>
<a class="sourceLine" id="cb1-182" title="182"></a>
<a class="sourceLine" id="cb1-183" title="183">(<span class="kw">defun</span><span class="fu"> name</span></a>
<a class="sourceLine" id="cb1-184" title="184">  <span class="st">&quot;Toplevel function with pattern-matching arguments&quot;</span></a>
<a class="sourceLine" id="cb1-185" title="185">  ((argpat ...) ...)</a>
<a class="sourceLine" id="cb1-186" title="186">  ...)</a>
<a class="sourceLine" id="cb1-187" title="187"></a>
<a class="sourceLine" id="cb1-188" title="188"><span class="co">;; Top-level macro</span></a>
<a class="sourceLine" id="cb1-189" title="189"></a>
<a class="sourceLine" id="cb1-190" title="190">(<span class="kw">defmacro</span><span class="fu"> name </span>(arg ...) ...)</a>
<a class="sourceLine" id="cb1-191" title="191">(<span class="kw">defmacro</span><span class="fu"> name </span>arg ...)</a>
<a class="sourceLine" id="cb1-192" title="192"></a>
<a class="sourceLine" id="cb1-193" title="193"><span class="co">;; Top-level macro with pattern matching arguments</span></a>
<a class="sourceLine" id="cb1-194" title="194"></a>
<a class="sourceLine" id="cb1-195" title="195">(<span class="kw">defmacro</span><span class="fu"> name</span></a>
<a class="sourceLine" id="cb1-196" title="196">  ((argpat ...) ...)</a>
<a class="sourceLine" id="cb1-197" title="197">  ...)</a>
<a class="sourceLine" id="cb1-198" title="198"></a>
<a class="sourceLine" id="cb1-199" title="199"><span class="co">;; Top-level macro using Scheme inspired syntax-rules format</span></a>
<a class="sourceLine" id="cb1-200" title="200"></a>
<a class="sourceLine" id="cb1-201" title="201">(defsyntax name</a>
<a class="sourceLine" id="cb1-202" title="202">  (pat <span class="kw">exp</span>)</a>
<a class="sourceLine" id="cb1-203" title="203">  ...)</a>
<a class="sourceLine" id="cb1-204" title="204"></a>
<a class="sourceLine" id="cb1-205" title="205"><span class="co">;;; Local macros in macro or syntax-rule format</span></a>
<a class="sourceLine" id="cb1-206" title="206"></a>
<a class="sourceLine" id="cb1-207" title="207">(<span class="kw">macrolet</span> ((name (arg ... ) ... )</a>
<a class="sourceLine" id="cb1-208" title="208">            ... )</a>
<a class="sourceLine" id="cb1-209" title="209">    ... )</a>
<a class="sourceLine" id="cb1-210" title="210"></a>
<a class="sourceLine" id="cb1-211" title="211">(syntaxlet ((name (pat <span class="kw">exp</span>) ...)</a>
<a class="sourceLine" id="cb1-212" title="212">             ...)</a>
<a class="sourceLine" id="cb1-213" title="213"> ...)</a>
<a class="sourceLine" id="cb1-214" title="214"></a>
<a class="sourceLine" id="cb1-215" title="215"><span class="co">;; Like CLISP</span></a>
<a class="sourceLine" id="cb1-216" title="216"></a>
<a class="sourceLine" id="cb1-217" title="217">(<span class="kw">prog1</span> ...)</a>
<a class="sourceLine" id="cb1-218" title="218">(<span class="kw">prog2</span> ...)</a>
<a class="sourceLine" id="cb1-219" title="219"></a>
<a class="sourceLine" id="cb1-220" title="220"><span class="co">;; Erlang LFE module</span></a>
<a class="sourceLine" id="cb1-221" title="221"></a>
<a class="sourceLine" id="cb1-222" title="222">(defmodule name ...)</a>
<a class="sourceLine" id="cb1-223" title="223"></a>
<a class="sourceLine" id="cb1-224" title="224"><span class="co">;; Erlang LFE record</span></a>
<a class="sourceLine" id="cb1-225" title="225"></a>
<a class="sourceLine" id="cb1-226" title="226">(defrecord name ...)</a>
<a class="sourceLine" id="cb1-227" title="227"></a>
<a class="sourceLine" id="cb1-228" title="228"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-229" title="229"><span class="co">;; 4. Patterns and Guards</span></a>
<a class="sourceLine" id="cb1-230" title="230"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-231" title="231"></a>
<a class="sourceLine" id="cb1-232" title="232"><span class="co">;; Using patterns in LFE compared to that of Erlang</span></a>
<a class="sourceLine" id="cb1-233" title="233"></a>
<a class="sourceLine" id="cb1-234" title="234"><span class="co">;; Erlang                     ;; LFE</span></a>
<a class="sourceLine" id="cb1-235" title="235"><span class="co">;; {ok, X}                       (tuple &#39;ok x)</span></a>
<a class="sourceLine" id="cb1-236" title="236"><span class="co">;; error                         &#39;error</span></a>
<a class="sourceLine" id="cb1-237" title="237"><span class="co">;; {yes, [X|Xs]}                 (tuple &#39;yes (cons x xs))</span></a>
<a class="sourceLine" id="cb1-238" title="238"><span class="co">;; &lt;&lt;34,F/float&gt;&gt;                (binary 34 (f float))</span></a>
<a class="sourceLine" id="cb1-239" title="239"><span class="co">;; [P|Ps]=All                    (= (cons p ps) all)</span></a>
<a class="sourceLine" id="cb1-240" title="240"></a>
<a class="sourceLine" id="cb1-241" title="241">  _    <span class="co">; =&gt; is don&#39;t care while pattern matching</span></a>
<a class="sourceLine" id="cb1-242" title="242"></a>
<a class="sourceLine" id="cb1-243" title="243">  (<span class="op">=</span> pattern1 pattern2)     <span class="co">; =&gt; easier, better version of pattern matching</span></a>
<a class="sourceLine" id="cb1-244" title="244"></a>
<a class="sourceLine" id="cb1-245" title="245"><span class="co">;; Guards</span></a>
<a class="sourceLine" id="cb1-246" title="246"></a>
<a class="sourceLine" id="cb1-247" title="247"><span class="co">;; Whenever pattern occurs(let, case, receive, lc, etc) it can be followed by an optional</span></a>
<a class="sourceLine" id="cb1-248" title="248"><span class="co">;; guard which has the form (when test ...).</span></a>
<a class="sourceLine" id="cb1-249" title="249"></a>
<a class="sourceLine" id="cb1-250" title="250">(<span class="kw">progn</span> gtest ...)             <span class="co">;; =&gt; Sequence of guard tests</span></a>
<a class="sourceLine" id="cb1-251" title="251">(<span class="kw">if</span> gexpr gexpr gexpr)</a>
<a class="sourceLine" id="cb1-252" title="252">(type-test e)</a>
<a class="sourceLine" id="cb1-253" title="253">(guard-bif ...)               <span class="co">;; =&gt; Guard BIFs, arithmetic, boolean and comparison operators</span></a>
<a class="sourceLine" id="cb1-254" title="254"></a>
<a class="sourceLine" id="cb1-255" title="255"><span class="co">;;; REPL</span></a>
<a class="sourceLine" id="cb1-256" title="256"></a>
<a class="sourceLine" id="cb1-257" title="257">lfe&gt;(<span class="kw">set</span> (tuple len status msg) #(<span class="dv">8</span> ok <span class="st">&quot;Trillian&quot;</span>))</a>
<a class="sourceLine" id="cb1-258" title="258">    #(<span class="dv">8</span> ok <span class="st">&quot;Trillian&quot;</span>)</a>
<a class="sourceLine" id="cb1-259" title="259">lfe&gt;msg</a>
<a class="sourceLine" id="cb1-260" title="260">    <span class="st">&quot;Trillian&quot;</span></a>
<a class="sourceLine" id="cb1-261" title="261"></a>
<a class="sourceLine" id="cb1-262" title="262"><span class="co">;;; Program illustrating use of Guards</span></a>
<a class="sourceLine" id="cb1-263" title="263"></a>
<a class="sourceLine" id="cb1-264" title="264">(<span class="kw">defun</span><span class="fu"> right-number</span>?</a>
<a class="sourceLine" id="cb1-265" title="265">        ((x) (<span class="kw">when</span> (orelse (== x <span class="dv">42</span>) (== x <span class="dv">276709</span>)))</a>
<a class="sourceLine" id="cb1-266" title="266">          &#39;true)</a>
<a class="sourceLine" id="cb1-267" title="267">        ((_) &#39;false))</a>
<a class="sourceLine" id="cb1-268" title="268"></a>
<a class="sourceLine" id="cb1-269" title="269"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-270" title="270"><span class="co">;; 5. Functions</span></a>
<a class="sourceLine" id="cb1-271" title="271"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-272" title="272"></a>
<a class="sourceLine" id="cb1-273" title="273"><span class="co">;; A simple function using if.</span></a>
<a class="sourceLine" id="cb1-274" title="274"></a>
<a class="sourceLine" id="cb1-275" title="275">(<span class="kw">defun</span><span class="fu"> max </span>(x y)</a>
<a class="sourceLine" id="cb1-276" title="276">  <span class="st">&quot;The max function.&quot;</span></a>
<a class="sourceLine" id="cb1-277" title="277">  (<span class="kw">if</span> (<span class="op">&gt;=</span> x y) x y))</a>
<a class="sourceLine" id="cb1-278" title="278"></a>
<a class="sourceLine" id="cb1-279" title="279"><span class="co">;; Same function using more clause</span></a>
<a class="sourceLine" id="cb1-280" title="280"></a>
<a class="sourceLine" id="cb1-281" title="281">(<span class="kw">defun</span><span class="fu"> max</span></a>
<a class="sourceLine" id="cb1-282" title="282">  <span class="st">&quot;The max function.&quot;</span></a>
<a class="sourceLine" id="cb1-283" title="283">  ((x y) (<span class="kw">when</span> (<span class="op">&gt;=</span> x y)) x)</a>
<a class="sourceLine" id="cb1-284" title="284">  ((x y) y))</a>
<a class="sourceLine" id="cb1-285" title="285"></a>
<a class="sourceLine" id="cb1-286" title="286"><span class="co">;; Same function using similar style but using local functions defined by flet or fletrec</span></a>
<a class="sourceLine" id="cb1-287" title="287"></a>
<a class="sourceLine" id="cb1-288" title="288">(<span class="kw">defun</span><span class="fu"> foo </span>(x y)</a>
<a class="sourceLine" id="cb1-289" title="289">  <span class="st">&quot;The max function.&quot;</span></a>
<a class="sourceLine" id="cb1-290" title="290">  (<span class="kw">flet</span> ((m (a b) <span class="st">&quot;Local comment.&quot;</span></a>
<a class="sourceLine" id="cb1-291" title="291">            (<span class="kw">if</span> (<span class="op">&gt;=</span> a b) a b)))</a>
<a class="sourceLine" id="cb1-292" title="292">    (m x y)))</a>
<a class="sourceLine" id="cb1-293" title="293"></a>
<a class="sourceLine" id="cb1-294" title="294"><span class="co">;; LFE being Lisp-2 has separate namespaces for variables and functions</span></a>
<a class="sourceLine" id="cb1-295" title="295"><span class="co">;; Both variables and function/macros are lexically scoped.</span></a>
<a class="sourceLine" id="cb1-296" title="296"><span class="co">;; Variables are bound by lambda, match-lambda and let.</span></a>
<a class="sourceLine" id="cb1-297" title="297"><span class="co">;; Functions are bound by top-level defun, flet and fletrec.</span></a>
<a class="sourceLine" id="cb1-298" title="298"><span class="co">;; Macros are bound by top-level defmacro/defsyntax and by macrolet/syntaxlet.</span></a>
<a class="sourceLine" id="cb1-299" title="299"></a>
<a class="sourceLine" id="cb1-300" title="300"><span class="co">;; (funcall func arg ...) like CL to call lambdas/match-lambdas</span></a>
<a class="sourceLine" id="cb1-301" title="301"><span class="co">;; (funs) bound to variables are used.</span></a>
<a class="sourceLine" id="cb1-302" title="302"></a>
<a class="sourceLine" id="cb1-303" title="303"><span class="co">;; separate bindings and special for apply.</span></a>
<a class="sourceLine" id="cb1-304" title="304"><span class="kw">apply</span> _F (...),</a>
<a class="sourceLine" id="cb1-305" title="305"><span class="kw">apply</span> _F/<span class="dv">3</span> ( a1, a2, a3 )</a>
<a class="sourceLine" id="cb1-306" title="306"></a>
<a class="sourceLine" id="cb1-307" title="307"><span class="co">;; Cons&#39;ing in function heads</span></a>
<a class="sourceLine" id="cb1-308" title="308">(<span class="kw">defun</span><span class="fu"> sum </span>(l) (sum l <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1-309" title="309">  (<span class="kw">defun</span><span class="fu"> sum</span></a>
<a class="sourceLine" id="cb1-310" title="310">    ((&#39;() total) total)</a>
<a class="sourceLine" id="cb1-311" title="311">    (((<span class="kw">cons</span> h <span class="kw">t</span>) total) (sum <span class="kw">t</span> (<span class="op">+</span> h total))))</a>
<a class="sourceLine" id="cb1-312" title="312"></a>
<a class="sourceLine" id="cb1-313" title="313"><span class="co">;; ``cons`` literal instead of constructor form</span></a>
<a class="sourceLine" id="cb1-314" title="314">      (<span class="kw">defun</span><span class="fu"> sum </span>(l) (sum l <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1-315" title="315">      (<span class="kw">defun</span><span class="fu"> sum</span></a>
<a class="sourceLine" id="cb1-316" title="316">        ((&#39;() total) total)</a>
<a class="sourceLine" id="cb1-317" title="317">        ((`(,h . ,<span class="kw">t</span>) total) (sum <span class="kw">t</span> (<span class="op">+</span> h total))))</a>
<a class="sourceLine" id="cb1-318" title="318"></a>
<a class="sourceLine" id="cb1-319" title="319"><span class="co">;; Matching records in function heads</span></a>
<a class="sourceLine" id="cb1-320" title="320"></a>
<a class="sourceLine" id="cb1-321" title="321">(<span class="kw">defun</span><span class="fu"> handle</span>_info</a>
<a class="sourceLine" id="cb1-322" title="322">  ((&#39;ping (<span class="op">=</span> (match-state remote-pid &#39;undefined) state))</a>
<a class="sourceLine" id="cb1-323" title="323">    (gen_server:cast (self) &#39;ping)</a>
<a class="sourceLine" id="cb1-324" title="324">    `#(noreply ,state))</a>
<a class="sourceLine" id="cb1-325" title="325">  ((&#39;ping state)</a>
<a class="sourceLine" id="cb1-326" title="326">   `#(noreply ,state)))</a>
<a class="sourceLine" id="cb1-327" title="327"></a>
<a class="sourceLine" id="cb1-328" title="328"><span class="co">;; Receiving Messages</span></a>
<a class="sourceLine" id="cb1-329" title="329">      (<span class="kw">defun</span><span class="fu"> universal-server </span>()</a>
<a class="sourceLine" id="cb1-330" title="330">        (receive</a>
<a class="sourceLine" id="cb1-331" title="331">          ((tuple &#39;become func)</a>
<a class="sourceLine" id="cb1-332" title="332">           (<span class="kw">funcall</span> func))))</a>
<a class="sourceLine" id="cb1-333" title="333"></a>
<a class="sourceLine" id="cb1-334" title="334"><span class="co">;; another way for receiving messages</span></a>
<a class="sourceLine" id="cb1-335" title="335"></a>
<a class="sourceLine" id="cb1-336" title="336"> (<span class="kw">defun</span><span class="fu"> universal-server </span>()</a>
<a class="sourceLine" id="cb1-337" title="337">        (receive</a>
<a class="sourceLine" id="cb1-338" title="338">          (`#(become ,func)</a>
<a class="sourceLine" id="cb1-339" title="339">            (<span class="kw">funcall</span> func))))</a>
<a class="sourceLine" id="cb1-340" title="340"></a>
<a class="sourceLine" id="cb1-341" title="341"><span class="co">;; Composing a complete function for specific tasks</span></a>
<a class="sourceLine" id="cb1-342" title="342"></a>
<a class="sourceLine" id="cb1-343" title="343">(<span class="kw">defun</span><span class="fu"> compose </span>(f g)</a>
<a class="sourceLine" id="cb1-344" title="344">  (<span class="kw">lambda</span> (x)</a>
<a class="sourceLine" id="cb1-345" title="345">   (<span class="kw">funcall</span> f</a>
<a class="sourceLine" id="cb1-346" title="346">     (<span class="kw">funcall</span> g x))))</a>
<a class="sourceLine" id="cb1-347" title="347"></a>
<a class="sourceLine" id="cb1-348" title="348">(<span class="kw">defun</span><span class="fu"> check </span>()</a>
<a class="sourceLine" id="cb1-349" title="349">  (<span class="kw">let*</span> ((sin-asin (compose #&#39;sin/<span class="dv">1</span> #&#39;asin/<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-350" title="350">         (expected (<span class="kw">sin</span> (<span class="kw">asin</span> <span class="fl">0.5</span>)))</a>
<a class="sourceLine" id="cb1-351" title="351">         (compose-result (<span class="kw">funcall</span> sin-asin <span class="fl">0.5</span>)))</a>
<a class="sourceLine" id="cb1-352" title="352">    (io:format <span class="st">&quot;Expected answer: ~p~n&quot;</span> (<span class="kw">list</span> expected))</a>
<a class="sourceLine" id="cb1-353" title="353">    (io:format <span class="st">&quot;Answer with compose: ~p~n&quot;</span> (<span class="kw">list</span> compose-result))))</a>
<a class="sourceLine" id="cb1-354" title="354"></a>
<a class="sourceLine" id="cb1-355" title="355"></a>
<a class="sourceLine" id="cb1-356" title="356"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-357" title="357"><span class="co">;; 6. Concurrency</span></a>
<a class="sourceLine" id="cb1-358" title="358"><span class="co">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></a>
<a class="sourceLine" id="cb1-359" title="359"></a>
<a class="sourceLine" id="cb1-360" title="360"><span class="co">;; Message passing as done by Erlang&#39;s light-weight &quot;processes&quot;.</span></a>
<a class="sourceLine" id="cb1-361" title="361"></a>
<a class="sourceLine" id="cb1-362" title="362">(defmodule messenger-back</a>
<a class="sourceLine" id="cb1-363" title="363"> (<span class="kw">export</span> (print-result <span class="dv">0</span>) (send-message <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb1-364" title="364"></a>
<a class="sourceLine" id="cb1-365" title="365">(<span class="kw">defun</span><span class="fu"> print-result </span>()</a>
<a class="sourceLine" id="cb1-366" title="366">  (receive</a>
<a class="sourceLine" id="cb1-367" title="367">    ((tuple pid msg)</a>
<a class="sourceLine" id="cb1-368" title="368">      (io:format <span class="st">&quot;Received message: &#39;~s&#39;~n&quot;</span> (<span class="kw">list</span> msg))</a>
<a class="sourceLine" id="cb1-369" title="369">      (io:format <span class="st">&quot;Sending message to process ~p ...~n&quot;</span> (<span class="kw">list</span> pid))</a>
<a class="sourceLine" id="cb1-370" title="370">      (! pid (tuple msg))</a>
<a class="sourceLine" id="cb1-371" title="371">      (print-result))))</a>
<a class="sourceLine" id="cb1-372" title="372"></a>
<a class="sourceLine" id="cb1-373" title="373">(<span class="kw">defun</span><span class="fu"> send-message </span>(calling-pid msg)</a>
<a class="sourceLine" id="cb1-374" title="374">  (<span class="kw">let</span> ((spawned-pid (spawn &#39;messenger-back &#39;print-result ())))</a>
<a class="sourceLine" id="cb1-375" title="375">    (! spawned-pid (tuple calling-pid msg))))</a>
<a class="sourceLine" id="cb1-376" title="376"></a>
<a class="sourceLine" id="cb1-377" title="377"><span class="co">;; Multiple simultaneous HTTP Requests:</span></a>
<a class="sourceLine" id="cb1-378" title="378"></a>
<a class="sourceLine" id="cb1-379" title="379">(<span class="kw">defun</span><span class="fu"> parse-args </span>(flag)</a>
<a class="sourceLine" id="cb1-380" title="380">  <span class="st">&quot;Given one or more command-line arguments, extract the passed values.</span></a>
<a class="sourceLine" id="cb1-381" title="381"></a>
<a class="sourceLine" id="cb1-382" title="382"><span class="st">  For example, if the following was passed via the command line:</span></a>
<a class="sourceLine" id="cb1-383" title="383"></a>
<a class="sourceLine" id="cb1-384" title="384"><span class="st">    $ erl -my-flag my-value-1 -my-flag my-value-2</span></a>
<a class="sourceLine" id="cb1-385" title="385"></a>
<a class="sourceLine" id="cb1-386" title="386"><span class="st">  One could then extract it in an LFE program by calling this function:</span></a>
<a class="sourceLine" id="cb1-387" title="387"></a>
<a class="sourceLine" id="cb1-388" title="388"><span class="st">    (let ((args (parse-args &#39;my-flag)))</span></a>
<a class="sourceLine" id="cb1-389" title="389"><span class="st">      ...</span></a>
<a class="sourceLine" id="cb1-390" title="390"><span class="st">      )</span></a>
<a class="sourceLine" id="cb1-391" title="391"><span class="st">  In this example, the value assigned to the arg variable would be a list</span></a>
<a class="sourceLine" id="cb1-392" title="392"><span class="st">  containing the values my-value-1 and my-value-2.&quot;</span></a>
<a class="sourceLine" id="cb1-393" title="393">  (<span class="kw">let</span> ((`#(ok ,data) (init:get_argument flag)))</a>
<a class="sourceLine" id="cb1-394" title="394">    (lists:merge data)))</a>
<a class="sourceLine" id="cb1-395" title="395"></a>
<a class="sourceLine" id="cb1-396" title="396">(<span class="kw">defun</span><span class="fu"> get-pages </span>()</a>
<a class="sourceLine" id="cb1-397" title="397">  <span class="st">&quot;With no argument, assume &#39;url parameter was passed via command line.&quot;</span></a>
<a class="sourceLine" id="cb1-398" title="398">  (<span class="kw">let</span> ((urls (parse-args &#39;url)))</a>
<a class="sourceLine" id="cb1-399" title="399">    (get-pages urls)))</a>
<a class="sourceLine" id="cb1-400" title="400"></a>
<a class="sourceLine" id="cb1-401" title="401">(<span class="kw">defun</span><span class="fu"> get-pages </span>(urls)</a>
<a class="sourceLine" id="cb1-402" title="402">  <span class="st">&quot;Start inets and make (potentially many) HTTP requests.&quot;</span></a>
<a class="sourceLine" id="cb1-403" title="403">  (inets:start)</a>
<a class="sourceLine" id="cb1-404" title="404">  (plists:map</a>
<a class="sourceLine" id="cb1-405" title="405">    (<span class="kw">lambda</span> (x)</a>
<a class="sourceLine" id="cb1-406" title="406">      (get-page x)) urls))</a>
<a class="sourceLine" id="cb1-407" title="407"></a>
<a class="sourceLine" id="cb1-408" title="408">(<span class="kw">defun</span><span class="fu"> get-page </span>(url)</a>
<a class="sourceLine" id="cb1-409" title="409">  <span class="st">&quot;Make a single HTTP request.&quot;</span></a>
<a class="sourceLine" id="cb1-410" title="410">  (<span class="kw">let*</span> ((<span class="kw">method</span> &#39;get)</a>
<a class="sourceLine" id="cb1-411" title="411">         (headers &#39;())</a>
<a class="sourceLine" id="cb1-412" title="412">         (request-data `#(,url ,headers))</a>
<a class="sourceLine" id="cb1-413" title="413">         (http-options ())</a>
<a class="sourceLine" id="cb1-414" title="414">         (request-options &#39;(#(sync false))))</a>
<a class="sourceLine" id="cb1-415" title="415">    (httpc:request <span class="kw">method</span> request-data http-options request-options)</a>
<a class="sourceLine" id="cb1-416" title="416">    (receive</a>
<a class="sourceLine" id="cb1-417" title="417">      (`#(http #(,request-id #(<span class="kw">error</span> ,reason)))</a>
<a class="sourceLine" id="cb1-418" title="418">       (io:format <span class="st">&quot;Error: ~p~n&quot;</span> `(,reason)))</a>
<a class="sourceLine" id="cb1-419" title="419">      (`#(http #(,request-id ,result))</a>
<a class="sourceLine" id="cb1-420" title="420">       (io:format <span class="st">&quot;Result: ~p~n&quot;</span> `(,result))))))</a>
<a class="sourceLine" id="cb1-421" title="421"></a>
<a class="sourceLine" id="cb1-422" title="422"></a>
<a class="sourceLine" id="cb1-423" title="423"><span class="co">;; Check out Erlang&#39;s documentation for more concurrency and OTP docs.</span></a></code></pre></div>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="http://docs.lfe.io">LFE DOCS</a></li>
<li><a href="https://lfe.gitbooks.io/reference-guide/index.html">LFE GitBook</a></li>
<li><a href="https://en.wikipedia.org/wiki/LFE_(programming_language)">LFE Wiki</a></li>
</ul>
<h2 id="extra-info">Extra Info</h2>
<ul>
<li><a href="http://www.erlang-factory.com/upload/presentations/61/Robertvirding-LispFlavouredErlang.pdf">LFE PDF</a></li>
<li><a href="https://groups.google.com/d/msg/lisp-flavoured-erlang/XA5HeLbQQDk/TUHabZCHXB0J">LFE mail</a></li>
</ul>
<h2 id="credits">Credits</h2>
<p>Lots of thanks to Robert Virding for creating LFE, Duncan McGreggor for documenting it and other LFE contributors who made LFE awesome.</p>
</body>
</html>
