<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ansible</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h2 id="introduction">Introduction</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb1-1" title="1"><span class="ot">---</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="st">&quot;{{ Ansible }}&quot;</span> is an orchestration tool written in Python.</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">...</span></a></code></pre></div>
<p>Ansible is (one of many) orchestration tools. It allows you to control your environment (infrastructure and code) and automate the manual tasks.</p>
<p>Ansible has great integration with multiple operating systems (even Windows) and some hardware (switches, Firewalls, etc). It has multiple tools that integrate with the cloud providers. Almost every noteworthy cloud provider is present in the ecosystem (AWS, Azure, Google, DigitalOcean, OVH, etc…).</p>
<p>But ansible is way more! It provides execution plans, an API, library, and callbacks.</p>
<h3 id="main-pros-and-cons">Main pros and cons</h3>
<h4 id="pros">Pros</h4>
<ul>
<li>It is an agent-less tool. In most scenarios, it uses ssh as a transport layer. In some way you can use it as ‘bash on steroids’.</li>
<li>It is very easy to start. If you are familiar with the concept of ssh - you already know Ansible (ALMOST).</li>
<li>It executes ‘as is’ - other tools (salt, puppet, chef - might execute in different scenario than you would expect)</li>
<li>Documentation is at the world-class standard!</li>
<li>Writing your own modules and extensions is fairly easy.</li>
<li>Ansible AWX is the open source version of Ansible Tower we have been waiting for, which provides an excellent UI.</li>
</ul>
<h4 id="cons">Cons</h4>
<ul>
<li>It is an agent-less tool - every agent consumes up to 16MB ram - in some environments, it may be noticable amount.</li>
<li>It is agent-less - you have to verify your environment consistency ‘on-demand’ - there is no built-in mechanism that would warn you about some change automatically (this can be achieved with reasonable effort)</li>
<li>Official GUI - Ansible Tower - is great but expensive.</li>
<li>There is no ‘small enterprise’ payment plan, however Ansible AWX is the free open source version we were all waiting for.</li>
</ul>
<h4 id="neutral">Neutral</h4>
<p>Migration - Ansible &lt;-&gt; Salt is fairly easy - so if you would need an event-driven agent environment - it would be a good choice to start quick with Ansible, and convert to Salt when needed.</p>
<h4 id="some-concepts">Some concepts</h4>
<p>Ansible uses ssh or paramiko as a transport layer. In a way you can imagine that you are using a ssh with API to perform your action. The simplest way is to execute remote command in more controlled way (still using ssh). On the other hand - in advanced scope - you can wrap Ansible (use python Ansible code as a library) with your own Python scripts! It would act a bit like Fabric then.</p>
<h2 id="example">Example</h2>
<p>An example playbook to install apache and configure log level</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb2-1" title="1"><span class="ot">---</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">-</span> <span class="fu">hosts:</span><span class="at"> apache</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="fu">vars:</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="fu">apache2_log_level:</span><span class="at"> </span><span class="st">&quot;warn&quot;</span></a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="fu">handlers:</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> restart apache</span></a>
<a class="sourceLine" id="cb2-9" title="9">      <span class="fu">service:</span></a>
<a class="sourceLine" id="cb2-10" title="10">        <span class="fu">name:</span><span class="at"> apache2</span></a>
<a class="sourceLine" id="cb2-11" title="11">        <span class="fu">state:</span><span class="at"> restarted</span></a>
<a class="sourceLine" id="cb2-12" title="12">        <span class="fu">enabled:</span><span class="at"> </span><span class="ch">True</span></a>
<a class="sourceLine" id="cb2-13" title="13">      <span class="fu">notify:</span></a>
<a class="sourceLine" id="cb2-14" title="14">        <span class="kw">-</span> Wait for instances to listen on port 80</a>
<a class="sourceLine" id="cb2-15" title="15">      <span class="fu">become:</span><span class="at"> </span><span class="ch">True</span></a>
<a class="sourceLine" id="cb2-16" title="16"></a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> reload apache</span></a>
<a class="sourceLine" id="cb2-18" title="18">      <span class="fu">service:</span></a>
<a class="sourceLine" id="cb2-19" title="19">        <span class="fu">name:</span><span class="at"> apache2</span></a>
<a class="sourceLine" id="cb2-20" title="20">        <span class="fu">state:</span><span class="at"> reloaded</span></a>
<a class="sourceLine" id="cb2-21" title="21">      <span class="fu">notify:</span></a>
<a class="sourceLine" id="cb2-22" title="22">        <span class="kw">-</span> Wait for instances to listen on port 80</a>
<a class="sourceLine" id="cb2-23" title="23">      <span class="fu">become:</span><span class="at"> </span><span class="ch">True</span></a>
<a class="sourceLine" id="cb2-24" title="24"></a>
<a class="sourceLine" id="cb2-25" title="25">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Wait for instances to listen on port 80</span></a>
<a class="sourceLine" id="cb2-26" title="26">      <span class="fu">wait_for:</span></a>
<a class="sourceLine" id="cb2-27" title="27">        <span class="fu">state:</span><span class="at"> started</span></a>
<a class="sourceLine" id="cb2-28" title="28">        <span class="fu">host:</span><span class="at"> localhost</span></a>
<a class="sourceLine" id="cb2-29" title="29">        <span class="fu">port:</span><span class="at"> </span><span class="dv">80</span></a>
<a class="sourceLine" id="cb2-30" title="30">        <span class="fu">timeout:</span><span class="at"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb2-31" title="31">        <span class="fu">delay:</span><span class="at"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-32" title="32"></a>
<a class="sourceLine" id="cb2-33" title="33">  <span class="fu">tasks:</span></a>
<a class="sourceLine" id="cb2-34" title="34">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Update cache</span></a>
<a class="sourceLine" id="cb2-35" title="35">      <span class="fu">apt:</span></a>
<a class="sourceLine" id="cb2-36" title="36">        <span class="fu">update_cache:</span><span class="at"> </span><span class="ch">yes</span></a>
<a class="sourceLine" id="cb2-37" title="37">        <span class="fu">cache_valid_time:</span><span class="at"> </span><span class="dv">7200</span></a>
<a class="sourceLine" id="cb2-38" title="38">      <span class="fu">become:</span><span class="at"> </span><span class="ch">True</span></a>
<a class="sourceLine" id="cb2-39" title="39"></a>
<a class="sourceLine" id="cb2-40" title="40">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Install packages</span></a>
<a class="sourceLine" id="cb2-41" title="41">      <span class="fu">apt:</span><span class="at"> name={{ item }}</span></a>
<a class="sourceLine" id="cb2-42" title="42">      <span class="fu">with_items:</span></a>
<a class="sourceLine" id="cb2-43" title="43">        <span class="kw">-</span> apache2</a>
<a class="sourceLine" id="cb2-44" title="44">        <span class="kw">-</span> logrotate</a>
<a class="sourceLine" id="cb2-45" title="45">      <span class="fu">notify:</span></a>
<a class="sourceLine" id="cb2-46" title="46">        <span class="kw">-</span> restart apache</a>
<a class="sourceLine" id="cb2-47" title="47">      <span class="fu">become:</span><span class="at"> </span><span class="ch">True</span></a>
<a class="sourceLine" id="cb2-48" title="48"></a>
<a class="sourceLine" id="cb2-49" title="49">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Configure apache2 log level</span></a>
<a class="sourceLine" id="cb2-50" title="50">      <span class="fu">lineinfile:</span></a>
<a class="sourceLine" id="cb2-51" title="51">        <span class="fu">dest:</span><span class="at"> /etc/apache2/apache2.conf</span></a>
<a class="sourceLine" id="cb2-52" title="52">        <span class="fu">line:</span><span class="at"> </span><span class="st">&quot;LogLevel {{ apache2_log_level }}&quot;</span></a>
<a class="sourceLine" id="cb2-53" title="53">        <span class="fu">regexp:</span><span class="at"> </span><span class="st">&quot;^LogLevel&quot;</span></a>
<a class="sourceLine" id="cb2-54" title="54">      <span class="fu">notify:</span></a>
<a class="sourceLine" id="cb2-55" title="55">        <span class="kw">-</span> reload apache</a>
<a class="sourceLine" id="cb2-56" title="56">      <span class="fu">become:</span><span class="at"> </span><span class="ch">True</span></a></code></pre></div>
<h2 id="installation">Installation</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Universal way</span></a>
<a class="sourceLine" id="cb3-2" title="2">$ <span class="ex">pip</span> install ansible</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Debian, Ubuntu</span></a>
<a class="sourceLine" id="cb3-5" title="5">$ <span class="ex">apt-get</span> install ansible</a></code></pre></div>
<ul>
<li><a href="#infrastructure-as-a-code">Appendix A - How do I install ansible</a></li>
<li><a href="http://docs.ansible.com/ansible/latest/intro_installation.html">Additional Reading.</a></li>
</ul>
<h3 id="your-first-ansible-command-shell-execution">Your first ansible command (shell execution)</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Command pings localhost (defined in default inventory: /etc/ansible/hosts)</span></a>
<a class="sourceLine" id="cb4-2" title="2">$ <span class="ex">ansible</span> -m ping localhost</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># You should see this output</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="ex">localhost</span> <span class="kw">|</span> <span class="ex">SUCCESS</span> =<span class="op">&gt;</span> {</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="st">&quot;changed&quot;</span>: <span class="fu">false</span>,</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="st">&quot;ping&quot;</span>: <span class="st">&quot;pong&quot;</span></a>
<a class="sourceLine" id="cb4-7" title="7">}</a></code></pre></div>
<h3 id="shell-commands">Shell Commands</h3>
<p>There are few commands you should know about</p>
<ul>
<li><code>ansible</code> (to run modules in CLI)</li>
<li><code>ansible-playbook</code> (to run playbooks)</li>
<li><code>ansible-vault</code> (to manage secrets)</li>
<li><code>ansible-galaxy</code> (to install roles from github/galaxy)</li>
</ul>
<h3 id="module">Module</h3>
<p>A program (usually python) that executes, does some work and returns proper JSON output. This program performs specialized task/action (like manage instances in the cloud, execute shell command). The simplest module is called <code>ping</code> - it just returns a JSON with <code>pong</code> message.</p>
<p>Example of modules:</p>
<ul>
<li>Module: <code>ping</code> - the simplest module that is useful to verify host connectivity</li>
<li>Module: <code>shell</code> - a module that executes a shell command on a specified host(s).</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1">$ <span class="ex">ansible</span> -m ping all</a>
<a class="sourceLine" id="cb5-2" title="2">$ <span class="ex">ansible</span> -m shell -a <span class="st">&#39;date; whoami&#39;</span> localhost <span class="co">#hostname_or_a_group_name</span></a></code></pre></div>
<ul>
<li>Module: <code>command</code> - executes a single command that will not be processed through the shell, so variables like <code>$HOME</code> or operands like <code>|` `;</code> will not work. The command module is more secure, because it will not be affected by the user’s environment. For more complex commands - use shell module.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1">$ <span class="ex">ansible</span> -m command -a <span class="st">&#39;date; whoami&#39;</span> <span class="co"># FAILURE</span></a>
<a class="sourceLine" id="cb6-2" title="2">$ <span class="ex">ansible</span> -m command -a <span class="st">&#39;date&#39;</span> all</a>
<a class="sourceLine" id="cb6-3" title="3">$ <span class="ex">ansible</span> -m command -a <span class="st">&#39;whoami&#39;</span> all</a></code></pre></div>
<ul>
<li>Module: <code>file</code> - performs file operations (stat, link, dir, …)</li>
<li>Module: <code>raw</code> - executes a low-down and dirty SSH command, not going through the module subsystem (useful to install python2.7)</li>
</ul>
<h3 id="task">Task</h3>
<p>Execution of a single Ansible <strong>module</strong> is called a <strong>task</strong>. The simplest module is called <code>ping</code> as you could see above.</p>
<p>Another example of the module that allows you to execute a command remotely on multiple resources is called <code>shell</code>. See above how you were using them already.</p>
<h3 id="playbook">Playbook</h3>
<p><strong>Execution plan</strong> written in a form of script file(s) is called <strong>playbook</strong>. Playbooks consist of multiple elements -</p>
<ul>
<li>a list (or group) of hosts that ‘the play’ is executed against</li>
<li><code>task(s)</code> or <code>role(s)</code> that are going to be executed</li>
<li>multiple optional settings (like default variables, and way more)</li>
</ul>
<p>Playbook script language is YAML. You can think that playbook is very advanced CLI script that you are executing.</p>
<h4 id="example-of-the-playbook">Example of the playbook</h4>
<p>This example-playbook would execute (on all hosts defined in inventory) two tasks:</p>
<ul>
<li><code>ping</code> that would return message <em>pong</em></li>
<li><code>shell</code> that execute three commands and return the output to our terminal</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">-</span> <span class="fu">hosts:</span><span class="at"> all</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="fu">tasks:</span></a>
<a class="sourceLine" id="cb7-4" title="4">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;ping all&quot;</span></a>
<a class="sourceLine" id="cb7-5" title="5">      <span class="fu">ping:</span></a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;execute a shell command&quot;</span></a>
<a class="sourceLine" id="cb7-8" title="8">      <span class="fu">shell:</span><span class="at"> </span><span class="st">&quot;date; whoami; df -h;&quot;</span></a></code></pre></div>
<p>Run the playbook with the command:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1">$ <span class="ex">ansible-playbook</span> path/name_of_the_playbook.yml</a></code></pre></div>
<p>Note: Example playbook is explained in the next chapter: ‘Roles’</p>
<h3 id="more-on-ansible-concept">More on ansible concept</h3>
<h3 id="inventory">Inventory</h3>
<p>An inventory is a set of objects or hosts, against which we are executing our playbooks or single tasks via shell commands. For these few minutes, let’s assume that we are using the default ansible inventory (which in Debian based system is placed in <code>/etc/ansible/hosts</code>).</p>
<pre><code>localhost

[some_group]
hostA.mydomain.com
hostB.localdomain
1.2.3.4

[a_group_of_a_groups:children]
some_group
some_other_group</code></pre>
<ul>
<li><a href="http://docs.ansible.com/ansible/latest/intro_inventory.html">Additional Reading.</a></li>
</ul>
<h3 id="ansible-roles-a-template-playbooks-with-right-structure">ansible-roles (a ‘template-playbooks’ with right structure)</h3>
<p>You already know that the tasks (modules) can be run via CLI. You also know the playbooks - the execution plans of multiple tasks (with variables and logic).</p>
<p>A concept called <code>role</code> was introduced for parts of the code (playbooks) that should be reusable.</p>
<p><strong>Role</strong> is a structured way to manage your set of tasks, variables, handlers, default settings, and way more (meta, files, templates). Roles allow reusing the same parts of code in multiple playbooks (you can parametrize the role ‘further’ during its execution). Its a great way to introduce <code>object oriented</code> management for your applications.</p>
<p>Role can be included in your playbook (executed via your playbook).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">-</span> <span class="fu">hosts:</span><span class="at"> all</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="fu">tasks:</span></a>
<a class="sourceLine" id="cb10-4" title="4">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;ping all&quot;</span></a>
<a class="sourceLine" id="cb10-5" title="5">      <span class="fu">ping:</span></a>
<a class="sourceLine" id="cb10-6" title="6">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;execute a shell command&quot;</span></a>
<a class="sourceLine" id="cb10-7" title="7">      <span class="fu">shell:</span><span class="at"> </span><span class="st">&quot;date; whoami; df -h;&quot;</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9">  <span class="fu">roles:</span></a>
<a class="sourceLine" id="cb10-10" title="10">    <span class="kw">-</span> some_role</a>
<a class="sourceLine" id="cb10-11" title="11">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">role:</span><span class="at"> another_role</span><span class="kw">,</span> <span class="fu">some_variable:</span><span class="at"> </span><span class="st">&quot;learnxiny&quot;</span><span class="kw">,</span> <span class="fu">tags:</span><span class="at"> </span><span class="kw">[</span><span class="st">&quot;my_tag&quot;</span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></a>
<a class="sourceLine" id="cb10-12" title="12"></a>
<a class="sourceLine" id="cb10-13" title="13">  <span class="fu">pre_tasks:</span></a>
<a class="sourceLine" id="cb10-14" title="14">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> some pre-task</span></a>
<a class="sourceLine" id="cb10-15" title="15">      <span class="fu">shell:</span><span class="at"> echo &#39;this task is the last, but would be executed before roles, and before tasks&#39;</span></a></code></pre></div>
<h4 id="for-remaining-examples-we-would-use-additional-repository">For remaining examples we would use additional repository</h4>
<p>This example installs ansible in <code>virtualenv</code> so it is independent from the system. You need to initialize it into your shell-context with the <code>source environment.sh</code> command.</p>
<p>We are going to use this repository with examples: <a href="https://github.com/sirkubax/ansible-for-learnXinYminutes">https://github.com/sirkubax/ansible-for-learnXinYminutes</a></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1">$ <span class="co"># The following example contains a shell-prompt to indicate the venv and relative path</span></a>
<a class="sourceLine" id="cb11-2" title="2">$ <span class="fu">git</span> clone git@github.com:sirkubax/ansible-for-learnXinYminutes.git</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="ex">user@host</span>:~/$ cd ansible-for-learnXinYminutes</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="ex">user@host</span>:~/ansible-for-learnXinYminutes$ source environment.sh</a>
<a class="sourceLine" id="cb11-5" title="5">$</a>
<a class="sourceLine" id="cb11-6" title="6">$ <span class="co"># First lets execute the simple_playbook.yml</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">user@host</span>:~/ansible-for-learnXinYminutes$ ansible-playbook playbooks/simple_playbook.yml</a></code></pre></div>
<p>Run the playbook with roles example</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1">$ <span class="bu">source</span> environment.sh</a>
<a class="sourceLine" id="cb12-2" title="2">$ <span class="co"># Now we would run the above playbook with roles</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">user@host</span>:~/ansible-for-learnXinYminutes$ ansible-playbook playbooks/simple_role.yml</a></code></pre></div>
<h4 id="role-directory-structure">Role directory structure</h4>
<pre><code>roles/
   some_role/
     defaults/      # contains default variables
     files/         # for static files
     templates/     # for jinja templates
     tasks/         # tasks
     handlers/      # handlers
     vars/          # more variables (higher priority)
     meta/          # meta - package (role) info</code></pre>
<h4 id="role-handlers">Role Handlers</h4>
<p>Handlers are tasks that can be triggered (notified) during execution of a playbook, but they execute at the very end of a playbook. It is the best way to restart a service, check if the application port is active (successful deployment criteria), etc.</p>
<p>Get familiar with how you can use roles in the simple_apache_role example</p>
<pre><code>playbooks/roles/simple_apache_role/
├── tasks
│   └── main.yml
└── templates
    └── main.yml</code></pre>
<h3 id="ansible---variables">ansible - variables</h3>
<p>Ansible is flexible - it has 21 levels of variable precedence. <a href="http://docs.ansible.com/ansible/latest/playbooks_variables.html#variable-precedence-where-should-i-put-a-variable">read more</a> For now you should know that CLI variables have the top priority. You should also know, that a nice way to pool some data is a <strong>lookup</strong></p>
<h3 id="lookups">Lookups</h3>
<p>Awesome tool to query data from various sources!!! Awesome! query from:</p>
<ul>
<li>pipe (load shell command output into variable!)</li>
<li>file</li>
<li>stream</li>
<li>etcd</li>
<li>password management tools</li>
<li>url</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># read playbooks/lookup.yml</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># then run</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">user@host</span>:~/ansible-for-learnXinYminutes$ ansible-playbook playbooks/lookup.yml</a></code></pre></div>
<p>You can use them in CLI too</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb16-1" title="1">ansible -m shell -a <span class="st">&#39;echo &quot;{{ my_variable }}&quot;&#39;</span> -e <span class="st">&#39;my_variable=&quot;{{ lookup(&quot;pipe&quot;, &quot;date&quot;) }}&quot;&#39;</span> localhost</a>
<a class="sourceLine" id="cb16-2" title="2">ansible -m shell -a <span class="st">&#39;echo &quot;{{ my_variable }}&quot;&#39;</span> -e <span class="st">&#39;my_variable=&quot;{{ lookup(&quot;pipe&quot;, &quot;hostname&quot;) }}&quot;&#39;</span> all</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># Or use in playbook</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6">(venv) user@host:~/ansible-for-learnXinYminutes$ ansible-playbook playbooks/lookup.yml</a></code></pre></div>
<h3 id="register-and-conditional">Register and Conditional</h3>
<h4 id="register">Register</h4>
<p>Another way to dynamically generate the variable content is the <code>register</code> command. <code>Register</code> is also useful to store an output of a task and use its value for executing further tasks.</p>
<pre><code>(venv) user@host:~/ansible-for-learnXinYminutes$ ansible-playbook playbooks/register_and_when.yml</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb18-1" title="1"><span class="ot">---</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">-</span> <span class="fu">hosts:</span><span class="at"> localhost</span></a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="fu">tasks:</span></a>
<a class="sourceLine" id="cb18-4" title="4">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> check the system capacity</span></a>
<a class="sourceLine" id="cb18-5" title="5">      <span class="fu">shell:</span><span class="at"> df -h /</span></a>
<a class="sourceLine" id="cb18-6" title="6">      <span class="fu">register:</span><span class="at"> root_size</span></a>
<a class="sourceLine" id="cb18-7" title="7"></a>
<a class="sourceLine" id="cb18-8" title="8">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> debug root_size</span></a>
<a class="sourceLine" id="cb18-9" title="9">      <span class="fu">debug:</span></a>
<a class="sourceLine" id="cb18-10" title="10">        <span class="fu">msg:</span><span class="at"> </span><span class="st">&quot;{{ root_size }}&quot;</span></a>
<a class="sourceLine" id="cb18-11" title="11"></a>
<a class="sourceLine" id="cb18-12" title="12">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> debug root_size return code</span></a>
<a class="sourceLine" id="cb18-13" title="13">      <span class="fu">debug:</span></a>
<a class="sourceLine" id="cb18-14" title="14">        <span class="fu">msg:</span><span class="at"> </span><span class="st">&quot;{{ root_size.rc }}&quot;</span></a>
<a class="sourceLine" id="cb18-15" title="15"></a>
<a class="sourceLine" id="cb18-16" title="16">    <span class="co"># when: example</span></a>
<a class="sourceLine" id="cb18-17" title="17"></a>
<a class="sourceLine" id="cb18-18" title="18">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Print this message when return code of &#39;check the system capacity&#39; was ok</span></a>
<a class="sourceLine" id="cb18-19" title="19">      <span class="fu">debug:</span></a>
<a class="sourceLine" id="cb18-20" title="20">        <span class="fu">msg:</span><span class="at"> </span><span class="st">&quot;{{ root_size.rc }}&quot;</span></a>
<a class="sourceLine" id="cb18-21" title="21">      <span class="fu">when:</span><span class="at"> root_size.rc == 0</span></a></code></pre></div>
<h4 id="conditionals---when">Conditionals - when:</h4>
<p>You can define complex logic with Ansible and Jinja functions. Most common is usage of <code>when:</code>, with some variable (often dynamically generated in previous playbook steps with <code>register</code> or <code>lookup</code>)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb19-1" title="1"><span class="ot">---</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">-</span> <span class="fu">hosts:</span><span class="at"> localhost</span></a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="fu">tasks:</span></a>
<a class="sourceLine" id="cb19-4" title="4">    <span class="kw">-</span> <span class="fu">name:</span><span class="at"> check the system capacity</span></a>
<a class="sourceLine" id="cb19-5" title="5">      <span class="fu">shell:</span><span class="at"> df -h /</span></a>
<a class="sourceLine" id="cb19-6" title="6">      <span class="fu">when:</span><span class="at"> some_variable in &#39;a string&#39;</span></a>
<a class="sourceLine" id="cb19-7" title="7">  <span class="fu">roles:</span></a>
<a class="sourceLine" id="cb19-8" title="8">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">role:</span><span class="at"> mid_nagios_probe</span><span class="kw">,</span> <span class="fu">when:</span><span class="at"> allow_nagios_probes </span><span class="kw">}</span></a></code></pre></div>
<h3 id="ansible---tags-limit">ansible - tags, limit</h3>
<p>You should know about a way to increase efficiency by this simple functionality</p>
<h4 id="tags">TAGS</h4>
<p>You can tag a task, role (and its tasks), include, etc, and then run only the tagged resources</p>
<pre><code>ansible-playbook playbooks/simple_playbook.yml --tags=tagA,tag_other
ansible-playbook playbooks/simple_playbook.yml -t tagA,tag_other

There are special tags:
    always

--skip-tags can be used to exclude a block of code
--list-tags to list available tags</code></pre>
<p><a href="http://docs.ansible.com/ansible/latest/playbooks_tags.html">Read more</a></p>
<h4 id="limit">LIMIT</h4>
<p>You can limit an execution of your tasks to defined hosts</p>
<pre><code>ansible-playbook playbooks/simple_playbook.yml --limit localhost

--limit my_hostname
--limit groupname
--limit some_prefix*
--limit hostname:group #JM</code></pre>
<h3 id="templates">Templates</h3>
<p>Templates are a powerful way to deliver some (partially) dynamic content. Ansible uses <strong>Jinja2</strong> language to describe the template.</p>
<pre><code>Some static content

{{ a_variable }}

{% for item in loop_items %}
    this line item is {{ item }}
{% endfor %}</code></pre>
<p>Jinja may have some limitations, but it is a powerful tool that you might like.</p>
<p>Please examine this simple example that installs apache2 and generates index.html from the template “playbooks/roles/simple_apache_role/templates/index.html”</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb23-1" title="1">$ <span class="bu">source</span> environment.sh</a>
<a class="sourceLine" id="cb23-2" title="2">$ <span class="co"># Now we would run the above playbook with roles</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">(</span><span class="ex">venv</span><span class="kw">)</span> <span class="ex">user@host</span>:~/ansible-for-learnXinYminutes$ ansible-playbook playbooks/simple_role.yml --tags apache2</a></code></pre></div>
<h4 id="jinja2-cli">Jinja2 CLI</h4>
<p>You can use the jinja in the CLI too</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="ex">ansible</span> -m shell -a <span class="st">&#39;echo {{ my_variable }}&#39;</span> -e <span class="st">&#39;my_variable=something, playbook_parameter=twentytwo&#39;</span> localhost</a></code></pre></div>
<p>In fact - jinja is used to template parts of the playbooks too</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># check part of this playbook: playbooks/roles/sys_debug/tasks/debug_time.yml</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">-</span> <span class="fu">local_action:</span><span class="at"> shell date +&#39;%F %T&#39;</span></a>
<a class="sourceLine" id="cb25-3" title="3">  <span class="fu">register:</span><span class="at"> ts</span></a>
<a class="sourceLine" id="cb25-4" title="4">  <span class="fu">become:</span><span class="at"> </span><span class="ch">False</span></a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="fu">changed_when:</span><span class="at"> </span><span class="ch">False</span></a>
<a class="sourceLine" id="cb25-6" title="6"></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> Timestamp</span></a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="fu">debug:</span><span class="at"> msg=&quot;{{ ts.stdout }}&quot;</span></a>
<a class="sourceLine" id="cb25-9" title="9">  <span class="fu">when:</span><span class="at"> ts is defined and ts.stdout is defined</span></a>
<a class="sourceLine" id="cb25-10" title="10">  <span class="fu">become:</span><span class="at"> </span><span class="ch">False</span></a></code></pre></div>
<h4 id="jinja2-filters">Jinja2 filters</h4>
<p>Jinja is powerful. It has many built-in useful functions.</p>
<pre><code># get first item of the list
{{ some_list | first() }}
# if variable is undefined - use default value
{{ some_variable | default(&#39;default_value&#39;) }}</code></pre>
<p><a href="http://docs.ansible.com/ansible/latest/playbooks_filters.html">Read More</a></p>
<h3 id="ansible-vault">ansible-vault</h3>
<p>To maintain <strong>infrastructure as code</strong> you need to store secrets. Ansible provides a way to encrypt confidential files so you can store them in the repository, yet the files are decrypted on-the-fly during ansible execution.</p>
<p>The best way to use it is to store the secret in some secure location, and configure ansible to use them during runtime.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># Try (this would fail)</span></a>
<a class="sourceLine" id="cb27-2" title="2">$ <span class="ex">ansible-playbook</span> playbooks/vault_example.yml</a>
<a class="sourceLine" id="cb27-3" title="3"></a>
<a class="sourceLine" id="cb27-4" title="4">$ <span class="bu">echo</span> some_very_very_long_secret <span class="op">&gt;</span> ~/.ssh/secure_located_file</a>
<a class="sourceLine" id="cb27-5" title="5"></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co"># in ansible.cfg set the path to your secret file</span></a>
<a class="sourceLine" id="cb27-7" title="7">$ <span class="ex">vi</span> ansible.cfg</a>
<a class="sourceLine" id="cb27-8" title="8">  <span class="ex">ansible_vault_password_file</span> = ~/.ssh/secure_located_file</a>
<a class="sourceLine" id="cb27-9" title="9"></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">#or use env</span></a>
<a class="sourceLine" id="cb27-11" title="11">$ <span class="bu">export</span> <span class="va">ANSIBLE_VAULT_PASSWORD_FILE=</span>~/.ssh/secure_located_file</a>
<a class="sourceLine" id="cb27-12" title="12"></a>
<a class="sourceLine" id="cb27-13" title="13">$ <span class="ex">ansible-playbook</span> playbooks/vault_example.yml</a>
<a class="sourceLine" id="cb27-14" title="14"></a>
<a class="sourceLine" id="cb27-15" title="15">  <span class="co"># encrypt the file</span></a>
<a class="sourceLine" id="cb27-16" title="16">$ <span class="ex">ansible-vault</span> encrypt path/somefile</a>
<a class="sourceLine" id="cb27-17" title="17"></a>
<a class="sourceLine" id="cb27-18" title="18">  <span class="co"># view the file</span></a>
<a class="sourceLine" id="cb27-19" title="19">$ <span class="ex">ansible-vault</span> view path/somefile</a>
<a class="sourceLine" id="cb27-20" title="20"></a>
<a class="sourceLine" id="cb27-21" title="21">  <span class="co"># check the file content:</span></a>
<a class="sourceLine" id="cb27-22" title="22">$ <span class="fu">cat</span> path/somefile</a>
<a class="sourceLine" id="cb27-23" title="23"></a>
<a class="sourceLine" id="cb27-24" title="24">  <span class="co"># decrypt the file</span></a>
<a class="sourceLine" id="cb27-25" title="25">$ <span class="ex">ansible-vault</span> decrypt path/somefile</a></code></pre></div>
<h3 id="dynamic-inventory">dynamic inventory</h3>
<p>You might like to know, that you can build your inventory dynamically. (For Ansible) inventory is just JSON with proper structure - if you can deliver that to ansible - anything is possible.</p>
<p>You do not need to reinvent the wheel - there are plenty of ready to use inventory scripts for the most popular Cloud providers and a lot of in-house popular usecases.</p>
<p><a href="http://docs.ansible.com/ansible/latest/intro_dynamic_inventory.html#example-aws-ec2-external-inventory-script">AWS example</a></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1">$ <span class="ex">etc/inv/ec2.py</span> --refresh</a>
<a class="sourceLine" id="cb28-2" title="2">$ <span class="ex">ansible</span> -m ping all -i etc/inv/ec2.py</a></code></pre></div>
<p><a href="http://docs.ansible.com/ansible/latest/intro_dynamic_inventory.html">Read more</a></p>
<h3 id="ansible-profiling---callback">ansible profiling - callback</h3>
<p>Playbook execution takes some time. It is OK. First make it run, then you may like to speed things up. Since ansible 2.x there is built-in callback for task execution profiling.</p>
<pre><code>vi ansible.cfg
# set this to:
callback_whitelist = profile_tasks</code></pre>
<h3 id="facts-cache-and-ansible-cmdb">facts-cache and ansible-cmdb</h3>
<p>You can pull some information about your environment from another host. If the information does not change - you may consider using a facts_cache to speed things up.</p>
<pre><code>vi ansible.cfg

# if set to a persistent type (not &#39;memory&#39;, for example &#39;redis&#39;) fact values
# from previous runs in Ansible will be stored.  This may be useful when
# wanting to use, for example, IP information from one group of servers
# without having to talk to them in the same playbook run to get their
# current IP information.
fact_caching = jsonfile
fact_caching_connection = ~/facts_cache
fact_caching_timeout = 86400</code></pre>
<p>I like to use <code>jsonfile</code> as my backend. It allows to use another project <code>ansible-cmdb</code> <a href="https://github.com/fboender/ansible-cmdb">(project on github)</a> that generates a HTML page of your inventory resources. A nice ‘free’ addition!</p>
<h3 id="debugging-ansible-chapter-in-progress">Debugging ansible [chapter in progress]</h3>
<p>When your job fails - it is good to be effective with debugging.</p>
<ol type="1">
<li>Increase verbosity by using multiple -v <strong>[ -vvvvv]</strong></li>
<li>If variable is undefined - <code>grep -R path_of_your_inventory -e missing_variable</code></li>
<li>If variable (dictionary or a list) is undefined - <code>grep -R path_of_your_inventory -e missing_variable</code></li>
<li>Jinja template debug</li>
<li>Strange behaviour - try to run the code ‘at the destination’</li>
</ol>
<h3 id="infrastructure-as-code">Infrastructure as code</h3>
<p>You already know, that ansible-vault allows you to store your confidential data along with your code. You can go further - and define your ansible installation and configuration as code. See <code>environment.sh</code> to learn how to install the ansible itself inside a <code>virtualenv</code> that is not attached to your operating system (can be changed by non-privileged user), and as additional benefit - upgrading version of ansible is as easy as installing new version in new virtualenv. What is more, you can have multiple versions of Ansible present at the same time.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># recreate ansible 2.x venv</span></a>
<a class="sourceLine" id="cb31-2" title="2">$ <span class="fu">rm</span> -rf venv2</a>
<a class="sourceLine" id="cb31-3" title="3">$ <span class="bu">source</span> environment2.sh</a>
<a class="sourceLine" id="cb31-4" title="4"></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="co"># execute playbook</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="kw">(</span><span class="ex">venv2</span><span class="kw">)</span>$ <span class="ex">ansible-playbook</span> playbooks/ansible1.9_playbook.yml <span class="co"># would fail - deprecated syntax</span></a>
<a class="sourceLine" id="cb31-7" title="7"></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="co"># now lets install ansible 1.9.x next to ansible 2.x</span></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="kw">(</span><span class="ex">venv2</span><span class="kw">)</span>$ <span class="ex">deactivate</span></a>
<a class="sourceLine" id="cb31-10" title="10">$ <span class="bu">source</span> environment.1.9.sh</a>
<a class="sourceLine" id="cb31-11" title="11"></a>
<a class="sourceLine" id="cb31-12" title="12"><span class="co"># execute playbook</span></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="kw">(</span><span class="ex">venv1.9</span><span class="kw">)</span>$ <span class="ex">ansible-playbook</span> playbooks/ansible1.9_playbook.yml <span class="co"># works!</span></a>
<a class="sourceLine" id="cb31-14" title="14"></a>
<a class="sourceLine" id="cb31-15" title="15"><span class="co"># please note that you have both venv1.9 and venv2 present - you need to (de)activate one - that is all</span></a></code></pre></div>
<h4 id="become-user-become">become-user, become</h4>
<p>In Ansible - to become <code>sudo</code> - use the <code>become</code> parameter. Use <code>become_user</code> to specify the username.</p>
<pre><code>- name: Ensure the httpd service is running
  service:
    name: httpd
    state: started
  become: true</code></pre>
<p>Note: You may like to execute Ansible with <code>--ask-sudo-pass</code> or add the user to sudoers file in order to allow non-supervised execution if you require ‘admin’ privilages.</p>
<p><a href="http://docs.ansible.com/ansible/latest/become.html">Read more</a></p>
<h2 id="tips-and-tricks">Tips and tricks</h2>
<h4 id="check--c">–check -C</h4>
<p>Always make sure that your playbook can execute in ‘dry run’ mode (–check), and its execution is not declaring ‘Changed’ objects.</p>
<h4 id="diff--d">–diff -D</h4>
<p>Diff is useful to see nice detail of the files changed. It compare ‘in memory’ the files like <code>diff -BbruN fileA fileB</code>.</p>
<h4 id="execute-hosts-with-regex">Execute hosts with ‘regex’</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" title="1"><span class="ex">ansible</span> -m ping web*</a></code></pre></div>
<h4 id="host-groups-can-be-joined-negated-etc">Host groups can be joined, negated, etc</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" title="1"><span class="ex">ansible</span> -m ping web*:!backend:monitoring:<span class="kw">&amp;</span><span class="ex">allow_change</span></a></code></pre></div>
<h4 id="tagging">Tagging</h4>
<p>You should tag some (not all) objects - a task in a playbook, all tasks included form a role, etc. It allows you to execute the chosen parts of the playbook.</p>
<h4 id="no_logs-true">no_logs: True</h4>
<p>You may see, that some roles print a lot of output in verbose mode. There is also a debug module. This is the place where credentials may leak. Use <code>no_log</code> to hide the output.</p>
<h4 id="debug-module">Debug module</h4>
<p>allows to print a value to the screen - use it!</p>
<h4 id="register-the-output-of-a-task">Register the output of a task</h4>
<p>You can register the output (stdout), rc (return code), stderr of a task with the <code>register</code> command.</p>
<h4 id="conditionals-when">Conditionals: when:</h4>
<h4 id="loop-with-with_items-with_dict-with_together">Loop: with, with_items, with_dict, with_together</h4>
<p><a href="http://docs.ansible.com/ansible/latest/playbooks_conditionals.html">Read more</a></p>
<h2 id="additional-resources">Additional Resources</h2>
<ul>
<li><a href="https://serversforhackers.com/c/an-ansible-tutorial">Servers For Hackers: An Ansible Tutorial</a></li>
<li><a href="https://www.redhat.com/en/blog/system-administrators-guide-getting-started-ansible-fast">A system administrator’s guide to getting started with Ansible - FAST!</a></li>
<li><a href="https://www.ansible.com/products/tower">Ansible Tower</a> - Ansible Tower provides a web UI, dashboard and rest interface to ansible.</li>
<li><a href="https://github.com/ansible/awx">Ansible AWX</a> - The Open Source version of Ansible Tower.</li>
</ul>
</body>
</html>
