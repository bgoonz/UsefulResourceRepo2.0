<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Prerequisites To Writing Express APIs</title>
    <link rel="stylesheet" href="./medium.css" />
    <link rel="stylesheet" href="./mdn.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./toc.css" />
    <script async defer src="./toc.js"></script>
  </head>
  <body>
    <article class="h-entry">
      <header>
        <h1 class="p-name">Prerequisites To Writing Express APIs</h1>
      </header>
      <section data-field="subtitle" class="p-summary">
        This article will cover the basics of express from the perspective of a
        beginner without concerning it’s self with the underlying…
      </section>
      <section data-field="body" class="e-content">
        <section name="683a" class="section section--body section--first">
          <div class="section-divider"><hr class="section-divider" /></div>
          <div class="section-content">
            <div class="section-inner sectionLayout--insetColumn">
              <h3
                name="230f"
                id="230f"
                class="graf graf--h3 graf--leading graf--title"
              >
                 Prerequisites To Writing Express APIs 
              </h3>
              <h4
                name="cb92"
                id="cb92"
                class="graf graf--h4 graf-after--h3 graf--subtitle"
              >
                This article will cover the basics of express from the
                perspective of a beginner without concerning it’s self with the
                underlying mechanisms and theory that underlies the application
                of the framework. 
              </h4>
              <figure
                name="4db5"
                id="4db5"
                class="graf graf--figure graf--layoutOutsetLeft graf-after--h4"
              >
                <img
                  class="graf-image"
                  data-image-id="0*yUozFGA0FQpjcXFf.gif"
                  data-width="714"
                  data-height="426"
                  src="https://cdn-images-1.medium.com/max/600/0*yUozFGA0FQpjcXFf.gif"
                />
              </figure>
              <h3
                name="4100"
                id="4100"
                class="graf graf--h3 graf-after--figure"
              >
                For starters, what is express JS¿
              </h3>
              <p name="5b74" id="5b74" class="graf graf--p graf-after--h3">
                When introduced, node.js gave developers the chance to use
                JavaScript to write software that, up to that point, could only
                be written using lower level languages like C, C++, Java,
                Python…
              </p>
              <p name="777a" id="777a" class="graf graf--p graf-after--p">
                In this tutorial we will cover how to write
                <strong class="markup--strong markup--p-strong"
                  >web services</strong
                >
                that can communicate with clients (the front end application)
                using
                <strong class="markup--strong markup--p-strong">J</strong
                >ava<strong class="markup--strong markup--p-strong">S</strong
                >cript
                <strong class="markup--strong markup--p-strong">O</strong>bject
                <strong class="markup--strong markup--p-strong">N</strong
                >otation (JSON).
              </p>
              <ul class="postList">
                <li name="5334" id="5334" class="graf graf--li graf-after--p">
                  JavaScript is asynchronous, which allows us to take full
                  advantage of the processor it’s running on. Taking full
                  advantage of the processor is crucial because the node process
                  will be running on a single CPU.
                </li>
                <li name="0b8b" id="0b8b" class="graf graf--li graf-after--li">
                  Using JavaScript gives us access to the npm repository. This
                  repository is the largest ecosystem of useful libraries (most
                  of them free to use) in
                  <strong class="markup--strong markup--li-strong"
                    >npm modules</strong
                  >.
                </li>
              </ul>
              <figure
                name="3796"
                id="3796"
                class="graf graf--figure graf-after--li"
              >
                <img
                  class="graf-image"
                  data-image-id="0*PTKhCN2p9S8EDZ4r.gif"
                  data-width="800"
                  data-height="600"
                  src="https://cdn-images-1.medium.com/max/800/0*PTKhCN2p9S8EDZ4r.gif"
                />
              </figure>
              <figure
                name="baad"
                id="baad"
                class="graf graf--figure graf-after--figure"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="20c5"
                id="20c5"
                class="graf graf--h3 graf-after--figure"
              >
                Objective 1 — explain what Node.js is and its core features
              </h3>
              <h3 name="f431" id="f431" class="graf graf--h3 graf-after--h3">
                Overview
              </h3>
              <p name="291d" id="291d" class="graf graf--p graf-after--h3">
                Traditionally, developers only used the JavaScript language in
                web browsers. But, in 2009,
                <strong class="markup--strong markup--p-strong">Node.js</strong>
                was unveiled, and with it, the developer tool kit expanded
                greatly. Node.js gave developers the chance to use JavaScript to
                write software that, up to that point, could only be written
                using C, C++, Java, Python, Ruby, C#, and the like.
              </p>
              <p name="c033" id="c033" class="graf graf--p graf-after--p">
                We will use Node to write server code. Specifically,
                <strong class="markup--strong markup--p-strong"
                  >web services</strong
                >
                that can communicate with clients using the
                <strong class="markup--strong markup--p-strong">J</strong
                >ava<strong class="markup--strong markup--p-strong">S</strong
                >cript
                <strong class="markup--strong markup--p-strong">O</strong>bject
                <strong class="markup--strong markup--p-strong">N</strong
                >otation (JSON) format for data interchange.
              </p>
              <p name="7e38" id="7e38" class="graf graf--p graf-after--p">
                Some of the advantages of using Node.js for writing server-side
                code are:
              </p>
              <ul class="postList">
                <li name="51f9" id="51f9" class="graf graf--li graf-after--p">
                  Uses the same programming language (JavaScript) and paradigm
                  for both client and server. Using the same language, we
                  minimize context switching and make it easy to share code
                  between the client and the server.
                </li>
                <li name="ad6f" id="ad6f" class="graf graf--li graf-after--li">
                  JavaScript is single-threaded, which removes the complexity
                  involved in handling multiple threads.
                </li>
                <li name="c797" id="c797" class="graf graf--li graf-after--li">
                  JavaScript is asynchronous, which allows us to take full
                  advantage of the processor it’s running on. Taking full
                  advantage of the processor is crucial because the node process
                  will be running on a single CPU.
                </li>
                <li name="7654" id="7654" class="graf graf--li graf-after--li">
                  Using JavaScript gives us access to the npm repository. This
                  repository is the largest ecosystem of useful libraries (most
                  of them free to use) in
                  <strong class="markup--strong markup--li-strong"
                    >npm modules</strong
                  >.
                </li>
              </ul>
              <p name="8d36" id="8d36" class="graf graf--p graf-after--li">
                Some of the disadvantages of using Node.js for writing
                server-side code are:
              </p>
              <ul class="postList">
                <li name="0f56" id="0f56" class="graf graf--li graf-after--p">
                  By strictly using JavaScript on the server, we lose the
                  ability to use the right tool (a particular language) for the
                  job.
                </li>
                <li name="cd1e" id="cd1e" class="graf graf--li graf-after--li">
                  Because JavaScript is single-threaded, we can’t take advantage
                  of servers with multiple cores/processors.
                </li>
                <li name="12c7" id="12c7" class="graf graf--li graf-after--li">
                  Because JavaScript is asynchronous, it is harder to learn for
                  developers that have only worked with languages that default
                  to synchronous operations that block the execution thread.
                </li>
                <li name="07dc" id="07dc" class="graf graf--li graf-after--li">
                  In the npm repository, there are often too many packages that
                  do the same thing. This excess of packages makes it harder to
                  choose one and, in some cases, may introduce vulnerabilities
                  into our code.
                </li>
              </ul>
              <p name="39cb" id="39cb" class="graf graf--p graf-after--li">
                To write a simple web server with
                <code class="markup--code markup--p-code">Node.js</code>:
              </p>
              <ol class="postList">
                <li name="b4ff" id="b4ff" class="graf graf--li graf-after--p">
                  Use Node’s
                  <code class="markup--code markup--li-code">HTTP</code> module
                  to abstract away complex network-related operations.
                </li>
                <li name="9e58" id="9e58" class="graf graf--li graf-after--li">
                  Write the single
                  <strong class="markup--strong markup--li-strong"
                    ><em class="markup--em markup--li-em"
                      >request handler</em
                    ></strong
                  >
                  function to handle all requests to the server.
                </li>
              </ol>
              <p name="c5e2" id="c5e2" class="graf graf--p graf-after--li">
                The request handler is a function that takes the
                <code class="markup--code markup--p-code">request</code> coming
                from the client and produces the
                <code class="markup--code markup--p-code">response</code>. The
                function takes two arguments: 1) an object representing the
                <code class="markup--code markup--p-code">request</code> and 2)
                an object representing the
                <code class="markup--code markup--p-code">response</code>.
              </p>
              <p name="9d9d" id="9d9d" class="graf graf--p graf-after--p">
                This process works, but the resulting code is verbose, even for
                the simplest of servers. Also, note that when using only Node.js
                to build a server, we use a single request handler function for
                all requests.
              </p>
              <h3 name="970f" id="970f" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="5054" id="5054" class="graf graf--p graf-after--h3">
                Using only Node.js, let’s write a simple web server that returns
                a message. Create a folder for the server and add an
                <code class="markup--code markup--p-code">index.js</code> file
                inside.
              </p>
              <p name="161d" id="161d" class="graf graf--p graf-after--p">
                Next, add the following code to the
                <code class="markup--code markup--p-code">index.js</code> file:
              </p>
              <pre
                name="2268"
                id="2268"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const http = require(&quot;http&quot;); // built in node.js module to handle http traffic</code></pre>
              <pre
                name="7d96"
                id="7d96"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const hostname = &quot;127.0.0.1&quot;; // the local computer where the server is running<br>const port = 3000; // a port we&#39;ll use to watch for traffic</code></pre>
              <pre
                name="4c3f"
                id="4c3f"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const server = http.createServer((req, res) =&gt; {<br>    // creates our server<br>    res.statusCode = 200; // http status code returned to the client<br>    res.setHeader(&quot;Content-Type&quot;, &quot;text/plain&quot;); // inform the client that we&#39;ll be returning text<br>    res.end(&quot;Hello World from Node\\n&quot;); // end the request and send a response with the specified message<br>});</code></pre>
              <pre
                name="2fa3"
                id="2fa3"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">server.listen(port, hostname, () =&gt; {<br>    // start watching for connections on the port specified<br>    console.log(`Server running at &lt;http://$&gt;{hostname}:${port}/`);<br>});</code></pre>
              <p name="6ee3" id="6ee3" class="graf graf--p graf-after--pre">
                Now navigate to the folder in a terminal/console window and
                type:
                <code class="markup--code markup--p-code">node index.js</code>
                to execute your file. A message that reads &quot;<em
                  class="markup--em markup--p-em"
                  >Server running at </em
                ><a
                  href="http://127.0.0.1:3000"
                  data-href="http://127.0.0.1:3000"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  ><em class="markup--em markup--p-em"
                    >http://127.0.0.1:3000</em
                  ></a
                >&quot; should be displayed, and the server is now waiting for
                connections.
              </p>
              <p name="8c3f" id="8c3f" class="graf graf--p graf-after--p">
                Open a browser and visit:
                <code class="markup--code markup--p-code"
                  >http://localhost:3000</code
                >.
                <code class="markup--code markup--p-code">localhost</code> and
                the IP address
                <code class="markup--code markup--p-code">127.0.0.1</code> point
                to the same thing: your local computer. The browser should show
                the message: &quot;<em class="markup--em markup--p-em"
                  >Hello World from Node</em
                >&quot;. There you have it, your first web server, built from
                scratch using nothing but
                <code class="markup--code markup--p-code">Node.js</code>.
              </p>
              <h3 name="08e2" id="08e2" class="graf graf--h3 graf-after--p">
                Challenge
              </h3>
              <p name="caf3" id="caf3" class="graf graf--p graf-after--h3">
                Write a paragraph about what
                <code class="markup--code markup--p-code">Node.js</code> is and
                explain at least 3 of its core features.
              </p>
              <h3 name="bb8e" id="bb8e" class="graf graf--h3 graf-after--p">
                Objective 2 — explain what Express is and its core features
              </h3>
              <h3 name="a4f9" id="a4f9" class="graf graf--h3 graf-after--h3">
                Overview
              </h3>
              <p name="5251" id="5251" class="graf graf--p graf-after--h3">
                Node’s built-in
                <code class="markup--code markup--p-code">HTTP</code> module
                provides a powerful way to build web applications and services.
                However, it requires a lot of code for everyday tasks like
                sending an HTML page to the browser.
              </p>
              <p name="b670" id="b670" class="graf graf--p graf-after--p">
                Introducing Express, a light and unopinionated framework that
                <strong class="markup--strong markup--p-strong"
                  >sits on top of Node.js</strong
                >, making it easier to create web applications and services.
                Sending an HTML file or image is now a one-line task with the
                <code class="markup--code markup--p-code">sendFile</code> helper
                method in
                <code class="markup--code markup--p-code">Express</code>.
              </p>
              <p name="1b85" id="1b85" class="graf graf--p graf-after--p">
                Ultimately, Express is
                <strong class="markup--strong markup--p-strong"
                  >just a Node.js module</strong
                >
                like any other module.
              </p>
              <p name="7948" id="7948" class="graf graf--p graf-after--p">
                What can we do with Express? So many things! For example:
              </p>
              <ul class="postList">
                <li name="0317" id="0317" class="graf graf--li graf-after--p">
                  Build web applications.
                </li>
                <li name="6ae8" id="6ae8" class="graf graf--li graf-after--li">
                  Serve
                  <em class="markup--em markup--li-em"
                    >Single Page Applications</em
                  >
                  (SPAs).
                </li>
                <li name="308c" id="308c" class="graf graf--li graf-after--li">
                  Build RESTful web services that work with JSON.
                </li>
                <li name="7a9e" id="7a9e" class="graf graf--li graf-after--li">
                  Serve static content, like HTML files, images, audio files,
                  PDFs, and more.
                </li>
                <li name="823e" id="823e" class="graf graf--li graf-after--li">
                  Power real-time applications using technologies like
                  <strong class="markup--strong markup--li-strong"
                    >Web Sockets</strong
                  >
                  or
                  <strong class="markup--strong markup--li-strong"
                    >WebRTC</strong
                  >.
                </li>
              </ul>
              <p name="575e" id="575e" class="graf graf--p graf-after--li">
                Some of the benefits of using Express are that it is:
              </p>
              <ul class="postList">
                <li name="fdf7" id="fdf7" class="graf graf--li graf-after--p">
                  Simple
                </li>
                <li name="7f62" id="7f62" class="graf graf--li graf-after--li">
                  Unopinionated
                </li>
                <li name="63a7" id="63a7" class="graf graf--li graf-after--li">
                  Extensible
                </li>
                <li name="09a9" id="09a9" class="graf graf--li graf-after--li">
                  Light-weight
                </li>
                <li name="d44f" id="d44f" class="graf graf--li graf-after--li">
                  Compatible with
                  <a
                    href="https://www.npmjs.com/package/connect"
                    data-href="https://www.npmjs.com/package/connect"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    >connect middleware (Links to an external site.)</a
                  >. This compatibility means we can tap into an extensive
                  collection of modules written for
                  <code class="markup--code markup--li-code">connect</code>.
                </li>
                <li name="6dbf" id="6dbf" class="graf graf--li graf-after--li">
                  All packaged into a clean, intuitive, and easy-to-use API.
                </li>
                <li name="cc47" id="cc47" class="graf graf--li graf-after--li">
                  Abstracts away common tasks (writing web applications can be
                  verbose, hence the need for a library like this).
                </li>
              </ul>
              <p name="85d3" id="85d3" class="graf graf--p graf-after--li">
                Some of the drawbacks of Express are:
              </p>
              <ul class="postList">
                <li name="e9d2" id="e9d2" class="graf graf--li graf-after--p">
                  It’s not a one-stop solution. Because of its simplicity, it
                  does very little out of the box. Especially when compared to
                  frameworks like
                  <strong class="markup--strong markup--li-strong"
                    >Ruby on Rails</strong
                  >
                  and
                  <strong class="markup--strong markup--li-strong"
                    >Django</strong
                  >.
                </li>
                <li name="9bb7" id="9bb7" class="graf graf--li graf-after--li">
                  We are forced to make more decisions due to the flexibility
                  and control it provides.
                </li>
              </ul>
              <h3 name="1abb" id="1abb" class="graf graf--h3 graf-after--li">
                Main Features of Express
              </h3>
              <div
                name="415e"
                id="415e"
                class="graf graf--mixtapeEmbed graf-after--h3"
              >
                <a
                  href="https://expressjs.com/en/guide/writing-middleware.html"
                  data-href="https://expressjs.com/en/guide/writing-middleware.html"
                  class="markup--anchor markup--mixtapeEmbed-anchor"
                  title="https://expressjs.com/en/guide/writing-middleware.html"
                  ><strong class="markup--strong markup--mixtapeEmbed-strong"
                    >Writing middleware for use in Express apps</strong
                  ><br /><em class="markup--em markup--mixtapeEmbed-em"
                    >Middleware functions are functions that have access to the
                    request object ( req), the response object ( res), and
                    the…</em
                  >expressjs.com</a
                ><a
                  href="https://expressjs.com/en/guide/writing-middleware.html"
                  class="js-mixtapeImage mixtapeImage u-ignoreBlock"
                  data-media-id="9273508283e319a7f84046f8a6647696"
                  data-thumbnail-img-id="0*hnXqAKdkVqTquj5v"
                  style="
                    background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*hnXqAKdkVqTquj5v);
                  "
                ></a>
              </div>
              <p
                name="d72d"
                id="d72d"
                class="graf graf--p graf--empty graf-after--mixtapeEmbed"
              >
                <br />
              </p>
              <figure
                name="f644"
                id="f644"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="0*rdSEy1R5exC2Rpul.png"
                  data-width="410"
                  data-height="308"
                  src="https://cdn-images-1.medium.com/max/800/0*rdSEy1R5exC2Rpul.png"
                />
              </figure>
              <h3
                name="bb8d"
                id="bb8d"
                class="graf graf--h3 graf-after--figure"
              >
                Middleware
              </h3>
              <p name="01f5" id="01f5" class="graf graf--p graf-after--h3">
                Middleware functions can get the request and response objects,
                operate on them, and (when specified) trigger some action.
                Examples are logging or security.
              </p>
              <p name="2d3e" id="2d3e" class="graf graf--p graf-after--p">
                Express’s middleware stack is an array of functions.
              </p>
              <p name="e63f" id="e63f" class="graf graf--p graf-after--p">
                Middleware <em class="markup--em markup--p-em">can</em> change
                the request or response, but it doesn’t have to.
              </p>
              <h3 name="b633" id="b633" class="graf graf--h3 graf-after--p">
                Routing
              </h3>
              <p name="b13a" id="b13a" class="graf graf--p graf-after--h3">
                Routing is a way to select which request handler function is
                executed. It does so based on the URL visited and the HTTP
                method used. Routing provides a way to break an application into
                smaller parts.
              </p>
              <h3 name="6d73" id="6d73" class="graf graf--h3 graf-after--p">
                Routers for Application Modularity
              </h3>
              <p name="5b3b" id="5b3b" class="graf graf--p graf-after--h3">
                We can break up applications into
                <strong class="markup--strong markup--p-strong">routers</strong
                >. We could have a router to serve our SPA and another router
                for our API. Each router can have its own middleware and
                routing. This combination provides improved functionality.
              </p>
              <h3 name="1e2e" id="1e2e" class="graf graf--h3 graf-after--p">
                Convenience Helpers
              </h3>
              <p name="dd75" id="dd75" class="graf graf--p graf-after--h3">
                Express has many helpers that provide out of the box
                functionality to make writing web applications and API servers
                easier.
              </p>
              <p name="691e" id="691e" class="graf graf--p graf-after--p">
                A lot of those helpers are extension methods added to the
                request and response objects.
              </p>
              <p name="fe19" id="fe19" class="graf graf--p graf-after--p">
                Examples
                <a
                  href="https://expressjs.com/en/4x/api.html"
                  data-href="https://expressjs.com/en/4x/api.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >from the Api Reference (Links to an external site.)</a
                >
                include:
                <code class="markup--code markup--p-code"
                  >response.redirect()</code
                >,
                <code class="markup--code markup--p-code"
                  >response.status()</code
                >,
                <code class="markup--code markup--p-code">response.send()</code
                >, and
                <code class="markup--code markup--p-code">request.ip</code>.
              </p>
              <h3 name="0643" id="0643" class="graf graf--h3 graf-after--p">
                Views
              </h3>
              <p name="b01b" id="b01b" class="graf graf--p graf-after--h3">
                Views provide a way to dynamically render HTML on the server and
                even generate it using other languages.
              </p>
              <h3 name="f17f" id="f17f" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="c68a" id="c68a" class="graf graf--p graf-after--h3">
                Let’s write our first server using Express:
              </p>
              <ul class="postList">
                <li name="1a5f" id="1a5f" class="graf graf--li graf-after--p">
                  Create a new file called
                  <code class="markup--code markup--li-code">server.js</code> to
                  host our server code.
                </li>
                <li name="2d2f" id="2d2f" class="graf graf--li graf-after--li">
                  Type
                  <code class="markup--code markup--li-code">npm init -y</code>
                  to generate a
                  <code class="markup--code markup--li-code">package.json</code
                  >.
                </li>
                <li name="8b3a" id="8b3a" class="graf graf--li graf-after--li">
                  Install the
                  <code class="markup--code markup--li-code">express</code> npm
                  module using:
                  <code class="markup--code markup--li-code"
                    >npm install express</code
                  >.
                </li>
              </ul>
              <p name="dca2" id="dca2" class="graf graf--p graf-after--li">
                Inside
                <code class="markup--code markup--p-code">server.js</code> add
                the following code:
              </p>
              <pre
                name="749f"
                id="749f"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const express = require(&#39;express&#39;); // import the express package</code></pre>
              <pre
                name="5ee1"
                id="5ee1"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const server = express(); // creates the server</code></pre>
              <pre
                name="64c4"
                id="64c4"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// handle requests to the root of the api, the / route<br>server.get(&#39;/&#39;, (req, res) =&gt; {<br>  res.send(&#39;Hello from Express&#39;);<br>});</code></pre>
              <pre
                name="af4b"
                id="af4b"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// watch for connections on port 5000<br>server.listen(5000, () =&gt;<br>  console.log(&#39;Server running on &lt;http://localhost:5000&gt;&#39;)<br>);</code></pre>
              <p name="6a07" id="6a07" class="graf graf--p graf-after--pre">
                Run the server by typing:
                <code class="markup--code markup--p-code">node server.js</code>
                and visit
                <code class="markup--code markup--p-code"
                  >http://localhost:5000</code
                >
                in the browser.
              </p>
              <p name="d424" id="d424" class="graf graf--p graf-after--p">
                To stop the server, type
                <code class="markup--code markup--p-code">Ctrl + c</code> at the
                terminal window.
              </p>
              <h3 name="a4c3" id="a4c3" class="graf graf--h3 graf-after--p">
                Challenge
              </h3>
              <p name="1937" id="1937" class="graf graf--p graf-after--h3">
                On your own: Write a paragraph about what Express is and explain
                how it is used in modern web application development.
              </p>
              <h3 name="4046" id="4046" class="graf graf--h3 graf-after--p">
                Objective 3 — create an API that can respond to GET requests
              </h3>
              <h3 name="5945" id="5945" class="graf graf--h3 graf-after--h3">
                Overview
              </h3>
              <p name="24a4" id="24a4" class="graf graf--p graf-after--h3">
                In this overview, we’re walking through the steps necessary to
                build a simple Web API that returns the string “Hello World” on
                every incoming
                <code class="markup--code markup--p-code">GET</code> request.
                The program should return the string every time a request comes
                into the root route (&quot;/&quot;). For now, you don&#39;t need
                to code along, just read through the steps.
              </p>
              <p name="b43f" id="b43f" class="graf graf--p graf-after--p">
                To make things easier, we’ll use an existing repository as the
                base for our API. Later in the week, as we learn more about
                Node.js and Express, we’ll create an API from scratch.
              </p>
              <p name="70c8" id="70c8" class="graf graf--p graf-after--p">
                To build our first API, we will:
              </p>
              <ol class="postList">
                <li name="ff64" id="ff64" class="graf graf--li graf-after--p">
                  clone the
                  <a
                    href="https://github.com/LambdaSchool/node-express-mini"
                    data-href="https://github.com/LambdaSchool/node-express-mini"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    >node-express-mini repository (Links to an external
                    site.)</a
                  >
                  to a folder on our computer.
                </li>
                <li name="288f" id="288f" class="graf graf--li graf-after--li">
                  Navigate into the folder using
                  <code class="markup--code markup--li-code">cd</code>.
                </li>
                <li name="2043" id="2043" class="graf graf--li graf-after--li">
                  Use
                  <code class="markup--code markup--li-code">npm install</code>
                  to download all dependencies.
                </li>
                <li name="be2a" id="be2a" class="graf graf--li graf-after--li">
                  Add a file called
                  <code class="markup--code markup--li-code">index.js</code> at
                  the folder&#39;s root, next to the
                  <code class="markup--code markup--li-code">package.json</code>
                  file.
                </li>
                <li name="d92a" id="d92a" class="graf graf--li graf-after--li">
                  Open the
                  <code class="markup--code markup--li-code">index.js</code>
                  file using our favorite code editor.
                </li>
                <li name="d337" id="d337" class="graf graf--li graf-after--li">
                  Add the following code:
                </li>
              </ol>
              <pre
                name="c9d5"
                id="c9d5"
                class="graf graf--pre graf-after--li"
              ><code class="markup--code markup--pre-code">// require the express npm module, needs to be added to the project using &quot;npm install express&quot;<br>const express = require(&#39;express&#39;);</code></pre>
              <pre
                name="d945"
                id="d945"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// creates an express application using the express module<br>const server = express();</code></pre>
              <pre
                name="2956"
                id="2956"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// configures our server to execute a function for every GET request to &quot;/&quot;<br>// the second argument passed to the .get() method is the &quot;Route Handler Function&quot;<br>// the route handler function will run on every GET request to &quot;/&quot;<br>server.get(&#39;/&#39;, (req, res) =&gt; {<br>  // express will pass the request and response objects to this function<br>  // the .send() on the response object can be used to send a response to the client<br>  res.send(&#39;Hello World&#39;);<br>});</code></pre>
              <pre
                name="de14"
                id="de14"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// once the server is fully configured we can have it &quot;listen&quot; for connections on a particular &quot;port&quot;<br>// the callback function passed as the second argument will run once when the server starts<br>server.listen(8000, () =&gt; console.log(&#39;API running on port 8000&#39;));</code></pre>
              <p name="6d67" id="6d67" class="graf graf--p graf-after--pre">
                <strong class="markup--strong markup--p-strong"
                  >make sure to save your changes to </strong
                ><code class="markup--code markup--p-code"
                  ><strong class="markup--strong markup--p-strong"
                    >index.js</strong
                  ></code
                ><strong class="markup--strong markup--p-strong">.</strong>
              </p>
              <p name="64c9" id="64c9" class="graf graf--p graf-after--p">
                We are using the
                <code class="markup--code markup--p-code">express</code> npm
                module in our code, so we need to add it as a dependency to our
                project. To do this:
              </p>
              <ul class="postList">
                <li name="e9eb" id="e9eb" class="graf graf--li graf-after--p">
                  Open a terminal/console/command prompt window and navigate to
                  the root of our project.
                </li>
                <li name="b744" id="b744" class="graf graf--li graf-after--li">
                  Add express to our
                  <code class="markup--code markup--li-code">package.json</code>
                  file by typing
                  <code class="markup--code markup--li-code"
                    >npm install express</code
                  >.
                </li>
              </ul>
              <p name="d8a1" id="d8a1" class="graf graf--p graf-after--li">
                Now we’re ready to test our API!
              </p>
              <p name="65d5" id="65d5" class="graf graf--p graf-after--p">
                In the terminal, still at the root of our project:
              </p>
              <ul class="postList">
                <li name="04b6" id="04b6" class="graf graf--li graf-after--p">
                  Type:
                  <code class="markup--code markup--li-code"
                    >npm run server</code
                  >
                  to run our API. The message
                  <em class="markup--em markup--li-em"
                    >&quot;Api running on port 8000&quot;</em
                  >
                  should appear on the terminal.
                </li>
                <li name="440e" id="440e" class="graf graf--li graf-after--li">
                  Open a web browser and navigate to “<a
                    href="http://localhost:8000"
                    data-href="http://localhost:8000"
                    class="markup--anchor markup--li-anchor"
                    target="_blank"
                    >http://localhost:8000</a
                  >&quot;.
                </li>
              </ul>
              <p name="26ff" id="26ff" class="graf graf--p graf-after--li">
                There we have it, our first API!
              </p>
              <p name="f009" id="f009" class="graf graf--p graf-after--p">
                A lot is going on in those few lines of code (only six lines if
                we remove the comments and white space). We will cover every
                piece of it in detail over the following modules, but here is a
                quick rundown of the most important concepts.
              </p>
              <p name="a171" id="a171" class="graf graf--p graf-after--p">
                First, we used
                <code class="markup--code markup--p-code">require()</code> to
                <strong class="markup--strong markup--p-strong">import</strong>
                the
                <code class="markup--code markup--p-code">express module</code>
                and make it available to our application.
                <code class="markup--code markup--p-code">require()</code> is
                similar to the
                <code class="markup--code markup--p-code">import</code> keyword
                we have used before. The line
                <code class="markup--code markup--p-code"
                  >const express = require(&#39;express&#39;);</code
                >
                is equivalent to
                <code class="markup--code markup--p-code"
                  >import express from &#39;express&#39;;</code
                >
                if we were using ES2015 syntax.
              </p>
              <p name="fc38" id="fc38" class="graf graf--p graf-after--p">
                The following line creates our Express application. The return
                of calling
                <code class="markup--code markup--p-code">express()</code> is an
                instance of an Express application that we can use to configure
                our
                <strong class="markup--strong markup--p-strong">server</strong>
                and, eventually, start listening for and responding to requests.
                Notice we use the word server, not API. An Express application
                is generic, which means we can use it to serve static content
                (HTML, CSS, audio, video, PDFs, and more). We can also use an
                Express application to serve dynamically generated web pages,
                build real-time communications servers, and more. We will use it
                statically to accept requests from clients and respond with data
                in JSON format.
              </p>
              <p name="b397" id="b397" class="graf graf--p graf-after--p">
                An Express application publishes a set of methods we can use to
                configure functions. We are using the <code
                  class="markup--code markup--p-code"
                  >.get()</code
                >
                method to set up a
                <strong class="markup--strong markup--p-strong"
                  >route handler</strong
                >
                function that will run on every
                <code class="markup--code markup--p-code">GET</code> request. As
                a part of this handler function, we specify the URL which will
                trigger the request. In this case, the URL is the site&#39;s
                root (represented by a
                <code class="markup--code markup--p-code">/</code>). There are
                also methods to handle the
                <code class="markup--code markup--p-code">POST</code>,
                <code class="markup--code markup--p-code">PUT</code>, and
                <code class="markup--code markup--p-code">DELETE</code> HTTP
                verbs.
              </p>
              <p name="bbf5" id="bbf5" class="graf graf--p graf-after--p">
                The first two arguments passed by
                <code class="markup--code markup--p-code">express</code> to a
                route handler function are 1) an object representing the
                <code class="markup--code markup--p-code">request</code> and 2)
                an object representing the
                <code class="markup--code markup--p-code">response</code>.
                Express expands those objects with a set of useful properties
                and methods. Our example uses the <code
                  class="markup--code markup--p-code"
                  >.send()</code
                >
                method of the response object to specify the data we will send
                to the client as the response body. You can call the first two
                arguments anything you want, but it is prevalent to see them
                dubbed <code class="markup--code markup--p-code">req</code> and
                <code class="markup--code markup--p-code">res</code>. We at
                Lambda call them
                <strong class="markup--strong markup--p-strong"
                  >the homies</strong
                >
                as they always hang out together.
              </p>
              <p name="2331" id="2331" class="graf graf--p graf-after--p">
                That’s all the configuring we need to do for this first example.
                We’ll see other ways of configuring our server as we go forward.
              </p>
              <p name="185a" id="185a" class="graf graf--p graf-after--p">
                After configuring the server, it’s time to turn it on. We use
                the <code class="markup--code markup--p-code">.listen()</code>
                method to monitor a port on the computer for any incoming
                connections and respond to those we have configured. Our server
                will only respond to
                <code class="markup--code markup--p-code">GET</code> requests
                made to the
                <code class="markup--code markup--p-code">/</code> route on port
                <code class="markup--code markup--p-code">8000</code>.
              </p>
              <p name="897c" id="897c" class="graf graf--p graf-after--p">
                That’s it for our first Web API, and now it’s time for you to
                follow along as we add a new
                <strong class="markup--strong markup--p-strong"
                  >endpoint</strong
                >
                to our server that returns JSON data!
              </p>
              <h3 name="ca9e" id="ca9e" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="c537" id="c537" class="graf graf--p graf-after--h3">
                Let’s try returning JSON instead of just a simple string.
              </p>
              <p name="d105" id="d105" class="graf graf--p graf-after--p">
                Please follow the steps outlined on the overview, but, to save
                time, copy and paste the content of
                <code class="markup--code markup--p-code">index.js</code>
                instead of typing it. Then run your API through a browser to
                make sure it works.
              </p>
              <p name="dc90" id="dc90" class="graf graf--p graf-after--p">
                Now follow along as we code a new
                <em class="markup--em markup--p-em">endpoint</em> that returns
                an array of movie characters in JSON format.
              </p>
              <p name="11e8" id="11e8" class="graf graf--p graf-after--p">
                The first step is to define a new
                <em class="markup--em markup--p-em">route handler</em> to
                respond to
                <code class="markup--code markup--p-code">GET</code> requests at
                the
                <code class="markup--code markup--p-code">/hobbits</code>
                endpoint.
              </p>
              <pre
                name="3f37"
                id="3f37"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.get(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  // route handler code here<br>});</code></pre>
              <p name="52d3" id="52d3" class="graf graf--p graf-after--pre">
                Next, we define the return data that our endpoint will send back
                to the client. We do this inside the newly defined route handler
                function.
              </p>
              <pre
                name="e0c6"
                id="e0c6"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const hobbits = [<br>  {<br>    id: 1,<br>    name: &#39;Samwise Gamgee&#39;,<br>  },<br>  {<br>    id: 2,<br>    name: &#39;Frodo Baggins&#39;,<br>  },<br>];</code></pre>
              <p name="2c0d" id="2c0d" class="graf graf--p graf-after--pre">
                Now we can return the
                <code class="markup--code markup--p-code">hobbits</code> array.
                We could use <code class="markup--code markup--p-code"
                  >.send(hobbits)</code
                >
                as we did for the string on the
                <code class="markup--code markup--p-code">/</code> endpoint, but
                this time we&#39;ll learn about two other useful methods we find
                in the response object.
              </p>
              <pre
                name="7e13"
                id="7e13"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">res.status(200).json(hobbits);</code></pre>
              <p name="7dc2" id="7dc2" class="graf graf--p graf-after--pre">
                We should provide as much useful information as possible to the
                clients using our API. One such piece of data is the
                <code class="markup--code markup--p-code"
                  >HTTP status code</code
                >
                that reflects the client&#39;s operation outcome. In this case,
                the client is trying to get a list of a particular
                <code class="markup--code markup--p-code">resource</code>, a
                <code class="markup--code markup--p-code">hobbits</code> list.
                Sending back a
                <code class="markup--code markup--p-code">200 OK</code> status
                code communicates to the client that the operation was
                successful.
              </p>
              <p name="85b4" id="85b4" class="graf graf--p graf-after--p">
                We will see other status codes as we continue to build new
                endpoints during this week. You can see a list by following
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status"
                  data-href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >this link to the documentation about HTTP Response Codes on
                  the Mozilla Developer Network site (Links to an external
                  site.)</a
                >.
              </p>
              <p name="20ba" id="20ba" class="graf graf--p graf-after--p">
                We can use the <code class="markup--code markup--p-code"
                  >.status()</code
                >
                method of the response object to send any valid
                <code class="markup--code markup--p-code">HTTP status code</code
                >.
              </p>
              <p name="beb1" id="beb1" class="graf graf--p graf-after--p">
                We are also chaining the <code
                  class="markup--code markup--p-code"
                  >.json()</code
                >
                method of the response object. We do this to communicate to both
                the client making the request and the next developer working
                with this code that we intend to send the data in
                <code class="markup--code markup--p-code">JSON format</code>.
              </p>
              <p name="eb6e" id="eb6e" class="graf graf--p graf-after--p">
                The complete code for
                <code class="markup--code markup--p-code">index.js</code> should
                now look like so:
              </p>
              <pre
                name="2559"
                id="2559"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const express = require(&#39;express&#39;);</code></pre>
              <pre
                name="624a"
                id="624a"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const server = express();</code></pre>
              <pre
                name="acdf"
                id="acdf"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">server.get(&#39;/&#39;, (req, res) =&gt; {<br>  res.send(&#39;Hello World&#39;);<br>});</code></pre>
              <pre
                name="30f9"
                id="30f9"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">server.get(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  const hobbits = [<br>    {<br>      id: 1,<br>      name: &#39;Samwise Gamgee&#39;,<br>    },<br>    {<br>      id: 2,<br>      name: &#39;Frodo Baggins&#39;,<br>    },<br>  ];</code></pre>
              <pre
                name="f903"
                id="f903"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  res.status(200).json(hobbits);<br>});</code></pre>
              <pre
                name="5b3f"
                id="5b3f"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">server.listen(8000, () =&gt; console.log(&#39;API running on port 8000&#39;));</code></pre>
              <p name="6e30" id="6e30" class="graf graf--p graf-after--pre">
                Now we can visit
                <code class="markup--code markup--p-code"
                  >http://localhost:8000/hobbits</code
                >
                in our browser, and we should get back our JSON array.
              </p>
              <p name="dbda" id="dbda" class="graf graf--p graf-after--p">
                If you are using the Google Chrome browser,
                <a
                  href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc"
                  data-href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >this extension (Links to an external site.)</a
                >
                can format the JSON data in a more readable fashion.
              </p>
              <p name="f5ff" id="f5ff" class="graf graf--p graf-after--p">
                Congratulations! You just built an API that can return data in
                JSON format.
              </p>
              <h3
                name="f05d"
                id="f05d"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="9bef"
                id="9bef"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p
                name="9913"
                id="9913"
                class="graf graf--p graf--empty graf-after--figure"
              >
                <br />
              </p>
              <p
                name="e529"
                id="e529"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <h3 name="fcdf" id="fcdf" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <p name="e37f" id="e37f" class="graf graf--p graf-after--h3">
                Let’s look at a basic example of routing in action.
              </p>
              <p name="07b6" id="07b6" class="graf graf--p graf-after--p">
                First, to make our Express application respond to
                <code class="markup--code markup--p-code">GET</code> requests on
                different URLs, add the following endpoints:
              </p>
              <pre
                name="46ae"
                id="46ae"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">// this request handler executes when making a GET request to /about<br>server.get(&#39;/about&#39;, (req, res) =&gt; {<br>  res.status(200).send(&#39;&lt;h1&gt;About Us&lt;/h1&gt;&#39;);<br>});</code></pre>
              <pre
                name="8564"
                id="8564"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// this request handler executes when making a GET request to /contact<br>server.get(&#39;/contact&#39;, (req, res) =&gt; {<br>  res.status(200).send(&#39;&lt;h1&gt;Contact Form&lt;/h1&gt;&#39;);<br>});</code></pre>
              <p name="948c" id="948c" class="graf graf--p graf-after--pre">
                Two things to note:
              </p>
              <ul class="postList">
                <li name="2a49" id="2a49" class="graf graf--li graf-after--p">
                  we are using the same HTTP Method on both endpoints, but
                  express looks at the URL and executes the corresponding
                  request handler.
                </li>
                <li name="d0fa" id="d0fa" class="graf graf--li graf-after--li">
                  we can return a string with valid HTML!
                </li>
              </ul>
              <p name="59a3" id="59a3" class="graf graf--p graf-after--li">
                Open a browser and navigate to the
                <code class="markup--code markup--p-code">/about</code> and
                <code class="markup--code markup--p-code">/contact</code>
                routes. The appropriate route handler will execute.
              </p>
              <h3 name="9f0b" id="9f0b" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="0db8" id="0db8" class="graf graf--p graf-after--h3">
                Please follow along as we write endpoints that execute different
                request handlers on the same URL by changing the HTTP method.
              </p>
              <p name="c091" id="c091" class="graf graf--p graf-after--p">
                Let’s start by adding the following code after the
                <code class="markup--code markup--p-code">GET</code> endpoint to
                <code class="markup--code markup--p-code">/hobbits</code>:
              </p>
              <pre
                name="60e7"
                id="60e7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">// this request handler executes when making a POST request to /hobbits<br>server.post(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  res.status(201).json({ url: &#39;/hobbits&#39;, operation: &#39;POST&#39; });<br>});</code></pre>
              <p name="eefa" id="eefa" class="graf graf--p graf-after--pre">
                Note that we return HTTP status code 201 (created) for
                successful
                <code class="markup--code markup--p-code">POST</code>
                operations.
              </p>
              <p name="1d45" id="1d45" class="graf graf--p graf-after--p">
                Next, we need to add an endpoint for
                <code class="markup--code markup--p-code">PUT</code> requests to
                the same URL.
              </p>
              <pre
                name="898a"
                id="898a"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">// this request handler executes when making a PUT request to /hobbits<br>server.put(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  res.status(200).json({ url: &#39;/hobbits&#39;, operation: &#39;PUT&#39; });<br>});</code></pre>
              <p name="bd6f" id="bd6f" class="graf graf--p graf-after--pre">
                For successful
                <code class="markup--code markup--p-code">PUT</code> operations,
                we use HTTP Status Code 200 (OK).
              </p>
              <p name="70eb" id="70eb" class="graf graf--p graf-after--p">
                Finally, let’s write an endpoint to handle
                <code class="markup--code markup--p-code">DELETE</code>
                requests.
              </p>
              <pre
                name="b098"
                id="b098"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">// this request handler executes when making a DELETE request to /hobbits<br>server.delete(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  res.status(204);<br>});</code></pre>
              <p name="d71e" id="d71e" class="graf graf--p graf-after--pre">
                We are returning HTTP Status Code 204 (No Content). Suppose you
                are returning any data to the client, perhaps the removed
                resource, on successful deletes. In that case, you’d change that
                to be 200 instead.
              </p>
              <p name="37b3" id="37b3" class="graf graf--p graf-after--p">
                You may have noticed that we are not reading any data from the
                request, as that is something we’ll learn later in the module.
                We are about to learn how to use a tool called
                <code class="markup--code markup--p-code">Postman</code> to test
                our <code class="markup--code markup--p-code">POST</code>,
                <code class="markup--code markup--p-code">PUT</code>, and
                <code class="markup--code markup--p-code">DELETE</code>
                endpoints.
              </p>
              <h3 name="94c7" id="94c7" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <h3 name="a9ee" id="a9ee" class="graf graf--h3 graf-after--h3">
                Reading and Using Route Parameters
              </h3>
              <p name="d533" id="d533" class="graf graf--p graf-after--h3">
                Let’s revisit our
                <code class="markup--code markup--p-code">DELETE</code>
                endpoint.
              </p>
              <pre
                name="9fc2"
                id="9fc2"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.delete(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  res.status(204);<br>});</code></pre>
              <p name="0f2f" id="0f2f" class="graf graf--p graf-after--pre">
                How does the client let the API know which hobbit should be
                deleted or updated? One way, the one we’ll use, is through
                <code class="markup--code markup--p-code">route parameters</code
                >. Let&#39;s add support for route parameters to our
                <code class="markup--code markup--p-code">DELETE</code>
                endpoint.
              </p>
              <p name="5357" id="5357" class="graf graf--p graf-after--p">
                We define route parameters by adding it to the URL with a colon
                (<code class="markup--code markup--p-code">:</code>) in front of
                it. Express adds it to the <code
                  class="markup--code markup--p-code"
                  >.params</code
                >
                property part of the request object. Let&#39;s see it in action:
              </p>
              <pre
                name="4bdc"
                id="4bdc"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.delete(&#39;/hobbits/:id&#39;, (req, res) =&gt; {<br>  const id = req.params.id;<br>  // or we could destructure it like so: const { id } = req.params;<br>  res.status(200).json({<br>    url: `/hobbits/${id}`,<br>    operation: `DELETE for hobbit with id ${id}`,<br>  });<br>});</code></pre>
              <p name="7714" id="7714" class="graf graf--p graf-after--pre">
                This route handler will execute every
                <code class="markup--code markup--p-code">DELETE</code> for a
                URL that begins with
                <code class="markup--code markup--p-code">/hobbits/</code>
                followed by any value. So,
                <code class="markup--code markup--p-code">DELETE</code> requests
                to
                <code class="markup--code markup--p-code">/hobbits/123</code>
                and
                <code class="markup--code markup--p-code">/hobbits/frodo</code>
                will both trigger this request handler. The value passed after
                <code class="markup--code markup--p-code">/hobbits/</code> will
                end up as the
                <code class="markup--code markup--p-code">id</code> property on
                <code class="markup--code markup--p-code">req.params</code>.
              </p>
              <p name="fbfc" id="fbfc" class="graf graf--p graf-after--p">
                The value for a route parameter will always be
                <code class="markup--code markup--p-code">string</code>, even if
                the value passed is numeric. When hitting
                <code class="markup--code markup--p-code">/hobbits/123</code> in
                our example, the type of
                <code class="markup--code markup--p-code">req.params.id</code>
                will be <code class="markup--code markup--p-code">string</code>.
              </p>
              <p name="38aa" id="38aa" class="graf graf--p graf-after--p">
                Express routing has support for multiple route parameters. For
                example, defining a route URL that reads
                <code class="markup--code markup--p-code"
                  >/hobbits/:id/friends/:friendId</code
                >, will add properties for
                <code class="markup--code markup--p-code">id</code> and
                <code class="markup--code markup--p-code">friendId</code> to
                <code class="markup--code markup--p-code">req.params</code>.
              </p>
              <h3 name="7e1a" id="7e1a" class="graf graf--h3 graf-after--p">
                Using the Query String
              </h3>
              <p name="2f00" id="2f00" class="graf graf--p graf-after--h3">
                The query string is another strategy using the URL to pass
                information from clients to the server. The query string is
                structured as a set of key/value pairs. Each pair takes the form
                of <code class="markup--code markup--p-code">key=value</code>,
                and pairs are separated by an
                <code class="markup--code markup--p-code">&amp;</code>. To mark
                the beginning of the query string, we add <code
                  class="markup--code markup--p-code"
                  >?</code
                >
                and the end of the URL, followed by the set of key/value pairs.
              </p>
              <p name="b8fe" id="b8fe" class="graf graf--p graf-after--p">
                An example of a query string would be:
                <code class="markup--code markup--p-code"
                  >https://www.google.com/search?q=lambda&amp;tbo=1</code
                >. The query string portion is <code
                  class="markup--code markup--p-code"
                  >?q=lambda&amp;tbo=1</code
                >
                and the key/value pairs are
                <code class="markup--code markup--p-code">q=lambda</code> and
                <code class="markup--code markup--p-code">tbo=1</code>.
              </p>
              <p name="6c05" id="6c05" class="graf graf--p graf-after--p">
                Let’s add sorting capabilities to our API. We’ll provide a way
                for clients to hit our
                <code class="markup--code markup--p-code">/hobbits</code> and
                pass the field they want to use to sort the responses, and our
                API will sort the data by that field in ascending order.
              </p>
              <p name="30a1" id="30a1" class="graf graf--p graf-after--p">
                Here’s the new code for the
                <code class="markup--code markup--p-code">GET /hobbits</code>
                endpoint:
              </p>
              <pre
                name="bcc4"
                id="bcc4"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.get(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  // query string parameters get added to req.query<br>  const sortField = req.query.sortby || &#39;id&#39;;<br>  const hobbits = [<br>    {<br>      id: 1,<br>      name: &#39;Samwise Gamgee&#39;,<br>    },<br>    {<br>      id: 2,<br>      name: &#39;Frodo Baggins&#39;,<br>    },<br>  ];</code></pre>
              <pre
                name="2236"
                id="2236"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  // apply the sorting<br>  const response = hobbits.sort(<br>    (a, b) =&gt; (a[sortField] &lt; b[sortField] ? -1 : 1)<br>  );</code></pre>
              <pre
                name="5b1b"
                id="5b1b"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  res.status(200).json(response);<br>});</code></pre>
              <p name="a6ae" id="a6ae" class="graf graf--p graf-after--pre">
                Visit
                <code class="markup--code markup--p-code"
                  >localhost:8000/hobbits?sortby=name</code
                >, and the list should be sorted by
                <code class="markup--code markup--p-code">name</code>. Visit
                <code class="markup--code markup--p-code"
                  >localhost:8000/hobbits?sortby=id</code
                >, and the list should now be sorted by
                <code class="markup--code markup--p-code">id</code>. If no
                <code class="markup--code markup--p-code">sortby</code>
                parameter is provided, it should default to sorting by
                <code class="markup--code markup--p-code">id</code>.
              </p>
              <p name="356f" id="356f" class="graf graf--p graf-after--p">
                To read values from the query string, we use the
                <code class="markup--code markup--p-code">req.query</code>
                object added by Express. There will be a key and a value in the
                <code class="markup--code markup--p-code">req.query</code>
                object for each key/value pair found in the query string.
              </p>
              <p name="35cb" id="35cb" class="graf graf--p graf-after--p">
                The parameter’s value will be of type
                <code class="markup--code markup--p-code">array</code> if more
                than one value is passed for the same key and
                <code class="markup--code markup--p-code">string</code> when
                only one value is passed. For example, in the query string <code
                  class="markup--code markup--p-code"
                  >?id=123</code
                >,
                <code class="markup--code markup--p-code">req.query.id</code>
                will be a string, but for <code
                  class="markup--code markup--p-code"
                  >?id=123&amp;id=234</code
                >, it will be an array.
              </p>
              <p name="3649" id="3649" class="graf graf--p graf-after--p">
                Another gotcha is that the names of query string parameters are
                case sensitive,
                <code class="markup--code markup--p-code">sortby</code> and
                <code class="markup--code markup--p-code">sortBy</code> are two
                different parameters.
              </p>
              <p name="7f61" id="7f61" class="graf graf--p graf-after--p">
                The rest of the code sorts the array before sending it back to
                the client.
              </p>
              <h3 name="a964" id="a964" class="graf graf--h3 graf-after--p">
                Reading Data from the Request Body
              </h3>
              <p name="9172" id="9172" class="graf graf--p graf-after--h3">
                We begin by taking another look at the
                <code class="markup--code markup--p-code">POST /hobbits</code>
                endpoint. We need to read the hobbit&#39;s information to add it
                to the
                <code class="markup--code markup--p-code">hobbits</code> array.
                Let&#39;s do that next:
              </p>
              <pre
                name="2350"
                id="2350"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">// add this code right after const server = express();<br>server.use(express.json());</code></pre>
              <pre
                name="960e"
                id="960e"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">let hobbits = [<br>  {<br>    id: 1,<br>    name: &#39;Bilbo Baggins&#39;,<br>    age: 111,<br>  },<br>  {<br>    id: 2,<br>    name: &#39;Frodo Baggins&#39;,<br>    age: 33,<br>  },<br>];<br>let nextId = 3;</code></pre>
              <pre
                name="9751"
                id="9751"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// and modify the post endpoint like so:<br>server.post(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  const hobbit = req.body;<br>  hobbit.id = nextId++;</code></pre>
              <pre
                name="2e87"
                id="2e87"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  hobbits.push(hobbit);</code></pre>
              <pre
                name="0b21"
                id="0b21"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  res.status(201).json(hobbits);<br>});</code></pre>
              <p name="103f" id="103f" class="graf graf--p graf-after--pre">
                To make this work with the hobbits array, we first move it out
                of the get endpoint into the outer scope. Now we have access to
                it from all route handlers.
              </p>
              <p name="4b5b" id="4b5b" class="graf graf--p graf-after--p">
                Then we define a variable for manual id generation. When using a
                database, this is not necessary as the database management
                system generates ids automatically.
              </p>
              <p name="7b37" id="7b37" class="graf graf--p graf-after--p">
                To read data from the request body, we need to do two things:
              </p>
              <ul class="postList">
                <li name="02f1" id="02f1" class="graf graf--li graf-after--p">
                  Add the line:
                  <code class="markup--code markup--li-code"
                    >server.use(express.json());</code
                  >
                  after the express application has been created.
                </li>
                <li name="5111" id="5111" class="graf graf--li graf-after--li">
                  Read the data from the body property that Express adds to the
                  request object. Express takes all the client’s information
                  from the body and makes it available as a nice JavaScript
                  object.
                </li>
              </ul>
              <p name="7795" id="7795" class="graf graf--p graf-after--li">
                <strong class="markup--strong markup--p-strong"
                  >Note that we are skipping data validation to keep this demo
                  simple, but in a production application, you would validate
                  before attempting to save to the database.</strong
                >
              </p>
              <p name="a4fe" id="a4fe" class="graf graf--p graf-after--p">
                Let’s test it using Postman:
              </p>
              <ul class="postList">
                <li name="2351" id="2351" class="graf graf--li graf-after--p">
                  Change the method to POST.
                </li>
                <li name="ca2a" id="ca2a" class="graf graf--li graf-after--li">
                  Select the
                  <code class="markup--code markup--li-code">Body</code> tab
                  underneath the address bar.
                </li>
                <li name="ce2e" id="ce2e" class="graf graf--li graf-after--li">
                  Click on the
                  <code class="markup--code markup--li-code">raw</code> radio
                  button.
                </li>
                <li name="fbac" id="fbac" class="graf graf--li graf-after--li">
                  From the dropdown menu to the right of the
                  <code class="markup--code markup--li-code">binary</code> radio
                  button, select `JSON (application/json).
                </li>
                <li name="447b" id="447b" class="graf graf--li graf-after--li">
                  Add the following JSON object as the body:
                </li>
              </ul>
              <pre
                name="f738"
                id="f738"
                class="graf graf--pre graf-after--li"
              ><code class="markup--code markup--pre-code">{<br>  &quot;name&quot;: &quot;Samwise Gamgee&quot;,<br>  &quot;age&quot;: 30<br>}</code></pre>
              <p name="1d6e" id="1d6e" class="graf graf--p graf-after--pre">
                Click on <code class="markup--code markup--p-code">Send</code>,
                and the API should return the list of hobbits, including Sam!
              </p>
              <h3 name="45d1" id="45d1" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="1dec" id="1dec" class="graf graf--p graf-after--h3">
                Please code along as we implement the
                <code class="markup--code markup--p-code">PUT</code> endpoint
                and a way for the client to specify the sort direction.
              </p>
              <h3 name="81a3" id="81a3" class="graf graf--h3 graf-after--p">
                Implement Update Functionality
              </h3>
              <p name="a3ef" id="a3ef" class="graf graf--p graf-after--h3">
                Let’s continue practicing reading route parameters and
                information from the request body. Let’s take a look at our
                existing PUT endpoint:
              </p>
              <pre
                name="ca43"
                id="ca43"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.put(&#39;/hobbits&#39;, (req, res) =&gt; {<br>  res.status(200).json({ url: &#39;/hobbits&#39;, operation: &#39;PUT&#39; });<br>});</code></pre>
              <p name="05da" id="05da" class="graf graf--p graf-after--pre">
                We start by adding support for a route parameter the clients can
                use to specify the id of the hobbit they intend to update:
              </p>
              <pre
                name="aecd"
                id="aecd"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.put(&#39;/hobbits/:id&#39;, (req, res) =&gt; {<br>  res.status(200).json({ url: &#39;/hobbits&#39;, operation: &#39;PUT&#39; });<br>});</code></pre>
              <p name="56a1" id="56a1" class="graf graf--p graf-after--pre">
                Next, we read the hobbit information from the request body using
                <code class="markup--code markup--p-code">req.body</code> and
                use it to update the existing hobbit.
              </p>
              <pre
                name="adf0"
                id="adf0"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.put(&#39;/hobbits/:id&#39;, (req, res) =&gt; {<br>  const hobbit = hobbits.find(h =&gt; h.id == req.params.id);</code></pre>
              <pre
                name="053a"
                id="053a"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  if (!hobbit) {<br>    res.status(404).json({ message: &#39;Hobbit does not exist&#39; });<br>  } else {<br>    // modify the existing hobbit<br>    Object.assign(hobbit, req.body);</code></pre>
              <pre
                name="eeab"
                id="eeab"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">    res.status(200).json(hobbit);<br>  }<br>});</code></pre>
              <p name="ff84" id="ff84" class="graf graf--p graf-after--pre">
                Concentrate on the code related to reading the
                <code class="markup--code markup--p-code">id</code> from the
                <code class="markup--code markup--p-code">req.params</code>
                object and reading the hobbit information from
                <code class="markup--code markup--p-code">req.body</code>. The
                rest of the code will change as this is a simple example using
                an in-memory array. Most production APIs will use a database.
              </p>
              <h3 name="7b4a" id="7b4a" class="graf graf--h3 graf-after--p">
                Challenge
              </h3>
              <p name="8dae" id="8dae" class="graf graf--p graf-after--h3">
                For the following exercises, use the provided database helper
                functions inside
                <code class="markup--code markup--p-code">/data/db.js</code> to
                work with the database users.
              </p>
              <p name="09fd" id="09fd" class="graf graf--p graf-after--p">
                Implement a
                <code class="markup--code markup--p-code">GET</code> endpoint
                that will accept an
                <code class="markup--code markup--p-code">id</code> as a route
                parameter and return the user corresponding to that
                <code class="markup--code markup--p-code">id</code>. If the user
                is not found, return the correct HTTP Status Code.
              </p>
              <p name="e08f" id="e08f" class="graf graf--p graf-after--p">
                Implement all CRUD operations on users, including getting by ID.
              </p>
              <p name="83e8" id="83e8" class="graf graf--p graf-after--p">
                Add sorting and pagination support to the GET all endpoint. For
                pagination, the client should supply the API with sorting
                information, the number of users per page, and the page number.
              </p>
              <h3 name="6b09" id="6b09" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <p name="b7f8" id="b7f8" class="graf graf--p graf-after--h3">
                <code class="markup--code markup--p-code">REST</code> is a
                generally agreed-upon set of principles and constraints. They
                are
                <strong class="markup--strong markup--p-strong"
                  >recommendations</strong
                >, not a standard.
              </p>
              <pre
                name="522c"
                id="522c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">// inside /api/apiRoutes.js &lt;- this can be place anywhere and called anything<br>const express = require(&#39;express&#39;);<br><br>// if the other routers are not nested inside /api then the paths would change<br>const userRoutes = require(&#39;./users/userRoutes&#39;);<br>const productRoutes = require(&#39;./products/productRoutes&#39;);<br>const clientRoutes = require(&#39;./clients/clientRoutes&#39;);<br><br>const router = express.Router(); // notice the Uppercase R<br><br>// this file will only be used when the route begins with &quot;/api&quot;<br>// so we can remove that from the URLs, so &quot;/api/users&quot; becomes simply &quot;/users&quot;<br>router.use(&#39;/users&#39;, userRoutes);<br>router.use(&#39;/products&#39;, productRoutes);<br>router.use(&#39;/clients&#39;, clientRoutes);<br><br>// .. and any other endpoint related to the user&#39;s resource<br><br>// after the route has been fully configured, we then export it so it can be required where needed<br>module.exports = router; // standard convention dictates that this is the last line on the file</code></pre>
              <p
                name="7c1f"
                id="7c1f"
                class="graf graf--p graf--empty graf-after--pre"
              >
                <br />
              </p>
              <figure
                name="2a33"
                id="2a33"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="e4b5"
                id="e4b5"
                class="graf graf--h3 graf-after--figure"
              >
                Objective 1 — explain the role of a foreign key
              </h3>
              <h3 name="3f24" id="3f24" class="graf graf--h3 graf-after--h3">
                Overview
              </h3>
              <p name="d39a" id="d39a" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong"
                  >Foreign keys</strong
                >
                are a type of table field used for creating links between
                tables. Like
                <strong class="markup--strong markup--p-strong"
                  >primary keys</strong
                >, they are most often integers that identify (rather than
                store) data. However, whereas a primary key is used to id rows
                in a table, foreign keys are used to connect a record in one
                table to a record in a second table.
              </p>
              <h3 name="c1c0" id="c1c0" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="6e5a" id="6e5a" class="graf graf--p graf-after--h3">
                Consider the following
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">ranchers</code>
                tables.
              </p>
              <p name="0603" id="0603" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/b88ebcd8fa3a4fa3a36cf99c939f6067"
                  data-href="https://www.notion.so/b88ebcd8fa3a4fa3a36cf99c939f6067"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="5c82" id="5c82" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/a4ccaec69c484ce0bcd03d2e8a83e489"
                  data-href="https://www.notion.so/a4ccaec69c484ce0bcd03d2e8a83e489"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="5ca0" id="5ca0" class="graf graf--p graf-after--p">
                The <code class="markup--code markup--p-code">farm_id</code> in
                the
                <code class="markup--code markup--p-code">ranchers</code> table
                is an example of a
                <code class="markup--code markup--p-code">foreign key</code>.
                Each entry in the
                <code class="markup--code markup--p-code">farm_id</code>
                (foreign key) column corresponds to an
                <code class="markup--code markup--p-code">id</code> (primary
                key) in the
                <code class="markup--code markup--p-code">farms</code> table.
                This allows us to track which farm each rancher belongs to while
                keeping the tables normalized.
              </p>
              <p name="fadd" id="fadd" class="graf graf--p graf-after--p">
                If we could only see the
                <code class="markup--code markup--p-code">ranchers</code> table,
                we would know that John, Jane, and Jen all work together and
                that Jim and Jay also work together. However, to know where any
                of them work, we would need to look at the
                <code class="markup--code markup--p-code">farms</code> table.
              </p>
              <h3 name="e2ad" id="e2ad" class="graf graf--h3 graf-after--p">
                Challenge
              </h3>
              <p name="a78c" id="a78c" class="graf graf--p graf-after--h3">
                Open
                <a
                  href="https://www.w3schools.com/sql/trysql.asp?filename=trysql_op_in"
                  data-href="https://www.w3schools.com/sql/trysql.asp?filename=trysql_op_in"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >SQLTryIT (Links to an external site.)</a
                >.
              </p>
              <p name="11ec" id="11ec" class="graf graf--p graf-after--p">
                How many records in the products table belong to the category
                “confections”?
              </p>
              <h3 name="48fe" id="48fe" class="graf graf--h3 graf-after--p">
                Objective 2 — query data from multiple tables
              </h3>
              <p name="e8c8" id="e8c8" class="graf graf--p graf-after--h3">
                Now that we understand the basics of querying data from a single
                table, let’s move on to selecting data from multiple tables
                using JOIN operations.
              </p>
              <h3 name="5528" id="5528" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <p name="f0e0" id="f0e0" class="graf graf--p graf-after--h3">
                We can use a
                <code class="markup--code markup--p-code">JOIN</code> to combine
                query data from multiple tables using a single
                <code class="markup--code markup--p-code">SELECT</code>
                statement.
              </p>
              <p name="4985" id="4985" class="graf graf--p graf-after--p">
                There are different types of joins; some are listed below:
              </p>
              <ul class="postList">
                <li name="9c7e" id="9c7e" class="graf graf--li graf-after--p">
                  inner joins.
                </li>
                <li name="7cd3" id="7cd3" class="graf graf--li graf-after--li">
                  outer joins.
                </li>
                <li name="96e6" id="96e6" class="graf graf--li graf-after--li">
                  left joins.
                </li>
                <li name="0e55" id="0e55" class="graf graf--li graf-after--li">
                  right joins.
                </li>
                <li name="d582" id="d582" class="graf graf--li graf-after--li">
                  cross joins.
                </li>
                <li name="6716" id="6716" class="graf graf--li graf-after--li">
                  non-equality joins.
                </li>
                <li name="b7f0" id="b7f0" class="graf graf--li graf-after--li">
                  self joins.
                </li>
              </ul>
              <p name="e724" id="e724" class="graf graf--p graf-after--li">
                Using
                <code class="markup--code markup--p-code">joins</code> requires
                that the two tables of interest contain at least one field with
                shared information. For example, if a
                <em class="markup--em markup--p-em">departments</em> table has
                an <em class="markup--em markup--p-em">id</em> field, and an
                employee table has a
                <em class="markup--em markup--p-em">department_id</em> field,
                and the values that exist in the
                <em class="markup--em markup--p-em">id</em> column of the
                <em class="markup--em markup--p-em">departments</em> table live
                in the
                <em class="markup--em markup--p-em">department_id</em> field of
                the employee table, we can use those fields to join both tables
                like so:
              </p>
              <pre
                name="a9c5"
                id="a9c5"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from employees<br>join departments on employees.department_id = departments.id</code></pre>
              <p name="dbe3" id="dbe3" class="graf graf--p graf-after--pre">
                This query will return the data from both tables for every
                instance where the
                <code class="markup--code markup--p-code">ON</code> condition is
                true. If there are employees with no value for department<em
                  class="markup--em markup--p-em"
                  >id or where the value stored in the field does not correspond
                  to an existing id in the</em
                >
                departments
                <em class="markup--em markup--p-em"
                  >table, then that record will NOT be returned. In a similar
                  fashion, any records from the</em
                >
                departments
                <em class="markup--em markup--p-em"
                  >table that don&#39;t have an employee associated with them
                  will also be omitted from the results. Basically, if the</em
                >
                id* does not show as the value of department_id for an employee,
                it won&#39;t be able to join.
              </p>
              <p name="ce96" id="ce96" class="graf graf--p graf-after--p">
                We can shorten the condition by giving the table names an alias.
                This is a common practice. Below is the same example using
                aliases, picking which fields to return and sorting the results:
              </p>
              <pre
                name="2392"
                id="2392"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select d.id, d.name, e.id, e.first_name, e.last_name, e.salary<br>from employees as e<br>join departments as d<br>  on e.department_id = d.id<br>order by d.name, e.last_name</code></pre>
              <p name="10af" id="10af" class="graf graf--p graf-after--pre">
                Notice that we can take advantage of white space and indentation
                to make queries more readable.
              </p>
              <p name="dd4b" id="dd4b" class="graf graf--p graf-after--p">
                There are several ways of writing joins, but the one shown here
                should work on all database management systems and avoid some
                pitfalls, so we recommend it.
              </p>
              <p name="32d2" id="32d2" class="graf graf--p graf-after--p">
                The syntax for performing a similar join using Knex is as
                follows:
              </p>
              <pre
                name="b87f"
                id="b87f"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;employees as e&#39;)<br>  .join(&#39;departments as d&#39;, &#39;e.department_id&#39;, &#39;d.id&#39;)<br>  .select(&#39;d.id&#39;, &#39;d.name&#39;, &#39;e.first_name&#39;, &#39;e.last_name&#39;, &#39;e.salary&#39;)</code></pre>
              <h3 name="56de" id="56de" class="graf graf--h3 graf-after--pre">
                Follow Along
              </h3>
              <p name="2484" id="2484" class="graf graf--p graf-after--h3">
                A good explanation of how the different types of joins can be
                seen
                <a
                  href="https://www.w3resource.com/sql/joins/sql-joins.php"
                  data-href="https://www.w3resource.com/sql/joins/sql-joins.php"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >in this article from w3resource.com (Links to an external
                  site.)</a
                >.
              </p>
              <h3 name="e143" id="e143" class="graf graf--h3 graf-after--p">
                Challenge
              </h3>
              <p name="9fdf" id="9fdf" class="graf graf--p graf-after--h3">
                Use
                <a
                  href="https://www.w3schools.com/Sql/tryit.asp?filename=trysql_select_top"
                  data-href="https://www.w3schools.com/Sql/tryit.asp?filename=trysql_select_top"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >this online tool (Links to an external site.)</a
                >
                to write the following queries:
              </p>
              <ul class="postList">
                <li name="9ccf" id="9ccf" class="graf graf--li graf-after--p">
                  list the products, including their category name.
                </li>
                <li name="b07f" id="b07f" class="graf graf--li graf-after--li">
                  list the products, including the supplier name.
                </li>
                <li name="7b08" id="7b08" class="graf graf--li graf-after--li">
                  list the products, including both the category name and
                  supplier name.
                </li>
              </ul>
              <h3 name="291b" id="291b" class="graf graf--h3 graf-after--li">
                What is SQL Joins?
              </h3>
              <p name="9c08" id="9c08" class="graf graf--p graf-after--h3">
                An SQL JOIN clause combines rows from two or more tables. It
                creates a set of rows in a temporary table.
              </p>
              <h3 name="b567" id="b567" class="graf graf--h3 graf-after--p">
                How to Join two tables in SQL?
              </h3>
              <p name="f531" id="f531" class="graf graf--p graf-after--h3">
                A JOIN works on two or more tables if they have at least one
                common field and have a relationship between them.
              </p>
              <p name="f5d8" id="f5d8" class="graf graf--p graf-after--p">
                JOIN keeps the base tables (structure and data) unchanged.
              </p>
              <h3 name="3ac8" id="3ac8" class="graf graf--h3 graf-after--p">
                Join vs. Subquery
              </h3>
              <ul class="postList">
                <li name="eeea" id="eeea" class="graf graf--li graf-after--h3">
                  JOINs are faster than a subquery and it is very rare that the
                  opposite.
                </li>
                <li name="3b2e" id="3b2e" class="graf graf--li graf-after--li">
                  In JOINs the RDBMS calculates an execution plan, that can
                  predict, what data should be loaded and how much it will take
                  to processed and as a result this process save some times,
                  unlike the subquery there is no pre-process calculation and
                  run all the queries and load all their data to do the
                  processing.
                </li>
                <li name="84ce" id="84ce" class="graf graf--li graf-after--li">
                  A JOIN is checked conditions first and then put it into table
                  and displays; where as a subquery take separate temp table
                  internally and checking condition.
                </li>
                <li name="3002" id="3002" class="graf graf--li graf-after--li">
                  When joins are using, there should be connection between two
                  or more than two tables and each table has a relation with
                  other while subquery means query inside another query, has no
                  need to relation, it works on columns and conditions.
                </li>
              </ul>
              <h3 name="e2a5" id="e2a5" class="graf graf--h3 graf-after--li">
                SQL JOINS: EQUI JOIN and NON EQUI JOIN
              </h3>
              <p name="a6cc" id="a6cc" class="graf graf--p graf-after--h3">
                The are two types of SQL JOINS — EQUI JOIN and NON EQUI JOIN
              </p>
              <ol class="postList">
                <li name="31e6" id="31e6" class="graf graf--li graf-after--p">
                  SQL EQUI JOIN :
                </li>
              </ol>
              <p name="c058" id="c058" class="graf graf--p graf-after--li">
                The SQL EQUI JOIN is a simple SQL join uses the equal sign(=) as
                the comparison operator for the condition. It has two
                types — SQL Outer join and SQL Inner join.
              </p>
              <ol class="postList">
                <li name="d86b" id="d86b" class="graf graf--li graf-after--p">
                  SQL NON EQUI JOIN :
                </li>
              </ol>
              <p name="48d8" id="48d8" class="graf graf--p graf-after--li">
                The
                <strong class="markup--strong markup--p-strong"
                  >SQL NON EQUI JOIN</strong
                >
                is a join uses comparison operator other than the equal sign
                like &gt;, &lt;, &gt;=, &lt;= with the condition.
              </p>
              <p name="f670" id="f670" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >SQL EQUI JOIN : INNER JOIN and OUTER JOIN</strong
                >
              </p>
              <p name="46d1" id="46d1" class="graf graf--p graf-after--p">
                The SQL EQUI JOIN can be classified into two types — INNER JOIN
                and OUTER JOIN
              </p>
              <ol class="postList">
                <li name="c9b5" id="c9b5" class="graf graf--li graf-after--p">
                  SQL INNER JOIN
                </li>
              </ol>
              <p name="d44b" id="d44b" class="graf graf--p graf-after--li">
                This type of EQUI JOIN returns all rows from tables where the
                key record of one table is equal to the key records of another
                table.
              </p>
              <ol class="postList">
                <li name="6bc6" id="6bc6" class="graf graf--li graf-after--p">
                  SQL OUTER JOIN
                </li>
              </ol>
              <p name="d249" id="d249" class="graf graf--p graf-after--li">
                This type of EQUI JOIN returns all rows from one table and only
                those rows from the secondary table where the joined condition
                is satisfying i.e. the columns are equal in both tables.
              </p>
              <p name="584b" id="584b" class="graf graf--p graf-after--p">
                In order to perform a JOIN query, the required information we
                need are:
              </p>
              <p name="47ae" id="47ae" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">a)</strong> The
                name of the tables<strong
                  class="markup--strong markup--p-strong"
                  >b)</strong
                >
                Name of the columns of two or more tables, based on which a
                condition will perform.
              </p>
              <p name="305b" id="305b" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">Syntax:</strong>
              </p>
              <pre
                name="0beb"
                id="0beb"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">FROM table1<br>join_type table2<br>[ON (join_condition)]</code></pre>
              <p name="e301" id="e301" class="graf graf--p graf-after--pre">
                <strong class="markup--strong markup--p-strong"
                  >Parameters:</strong
                >
              </p>
              <p name="74e7" id="74e7" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/3e2d9e2f028e4b7abf2da81156a54364"
                  data-href="https://www.notion.so/3e2d9e2f028e4b7abf2da81156a54364"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="b5f7" id="b5f7" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >Pictorial Presentation of SQL Joins:</strong
                >
              </p>
              <figure
                name="e324"
                id="e324"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="0*bbwqJEpV2a9WZG-t.gif"
                  data-width="525"
                  data-height="694"
                  src="https://cdn-images-1.medium.com/max/800/0*bbwqJEpV2a9WZG-t.gif"
                />
              </figure>
              <p name="8ba2" id="8ba2" class="graf graf--p graf-after--figure">
                <strong class="markup--strong markup--p-strong"
                  >Example:</strong
                >
              </p>
              <p name="42a1" id="42a1" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >Sample table: company</strong
                >
              </p>
              <p name="3c98" id="3c98" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >Sample table: foods</strong
                >
              </p>
              <p name="a770" id="a770" class="graf graf--p graf-after--p">
                To join two tables ‘company’ and ‘foods’, the following SQL
                statement can be used :
              </p>
              <p name="83b3" id="83b3" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >SQL Code:</strong
                >
              </p>
              <pre
                name="96d1"
                id="96d1"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">SELECT  company.company_id,company.company_name,<br>foods.item_id,foods.item_name<br>FROM company,foods;</code></pre>
              <p name="6513" id="6513" class="graf graf--p graf-after--pre">
                Copy
              </p>
              <p name="3e3b" id="3e3b" class="graf graf--p graf-after--p">
                Output:
              </p>
              <pre
                name="20dd"
                id="20dd"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">COMPAN COMPANY_NAME              ITEM_ID  ITEM_NAME<br>------ ------------------------- -------- ---------------<br>18     Order All                 1        Chex Mix<br>18     Order All                 6        Cheez-It<br>18     Order All                 2        BN Biscuit<br>18     Order All                 3        Mighty Munch<br>18     Order All                 4        Pot Rice<br>18     Order All                 5        Jaffa Cakes<br>18     Order All                 7        Salt n Shake<br>15     Jack Hill Ltd             1        Chex Mix<br>15     Jack Hill Ltd             6        Cheez-It<br>15     Jack Hill Ltd             2        BN Biscuit<br>15     Jack Hill Ltd             3        Mighty Munch<br>15     Jack Hill Ltd             4        Pot Rice<br>15     Jack Hill Ltd             5        Jaffa Cakes<br>15     Jack Hill Ltd             7        Salt n Shake<br>16     Akas Foods                1        Chex Mix<br>16     Akas Foods                6        Cheez-It<br>16     Akas Foods                2        BN Biscuit<br>16     Akas Foods                3        Mighty Munch<br>16     Akas Foods                4        Pot Rice<br>16     Akas Foods                5        Jaffa Cakes<br>16     Akas Foods                7        Salt n Shake<br>.........<br>.........<br>.........</code></pre>
              <p name="bec9" id="bec9" class="graf graf--p graf-after--pre">
                <strong class="markup--strong markup--p-strong"
                  >JOINS: Relational Databases</strong
                >
              </p>
              <ul class="postList">
                <li name="74c4" id="74c4" class="graf graf--li graf-after--p">
                  <a
                    href="https://www.w3resource.com/oracle/joins/index.php"
                    data-href="https://www.w3resource.com/oracle/joins/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >Oracle JOINS</strong
                    ></a
                  >
                </li>
                <li name="f8da" id="f8da" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/mysql/advance-query-in-mysql/mysql-joins.php"
                    data-href="https://www.w3resource.com/mysql/advance-query-in-mysql/mysql-joins.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >MySQL JOINS</strong
                    ></a
                  >
                </li>
                <li name="33a5" id="33a5" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/PostgreSQL/postgresql-join.php"
                    data-href="https://www.w3resource.com/PostgreSQL/postgresql-join.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >PostgreSQL JOINS</strong
                    ></a
                  >
                </li>
                <li name="b578" id="b578" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sqlite/sqlite-inner-join.php"
                    data-href="https://www.w3resource.com/sqlite/sqlite-inner-join.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQLite JOINS</strong
                    ></a
                  >
                </li>
              </ul>
              <p name="1763" id="1763" class="graf graf--p graf-after--li">
                <strong class="markup--strong markup--p-strong"
                  >Key points to remember:</strong
                >
              </p>
              <p name="128a" id="128a" class="graf graf--p graf-after--p">
                <em class="markup--em markup--p-em"
                  >Click on the following to get the slides presentation -</em
                >
              </p>
              <figure
                name="a61e"
                id="a61e"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="0*lP_nQo6VtVu_68nx.png"
                  data-width="360"
                  data-height="221"
                  src="https://cdn-images-1.medium.com/max/800/0*lP_nQo6VtVu_68nx.png"
                />
              </figure>
              <h3
                name="af6f"
                id="af6f"
                class="graf graf--h3 graf--empty graf-after--figure"
              >
                <br />
              </h3>
              <p name="4aa6" id="4aa6" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong"
                  >Practice SQL Exercises</strong
                >
              </p>
              <ul class="postList">
                <li name="0765" id="0765" class="graf graf--li graf-after--p">
                  <a
                    href="https://www.w3resource.com/sql-exercises/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Exercises, Practice, Solution</strong
                    ></a
                  >
                </li>
                <li name="4cd9" id="4cd9" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-retrieve-from-table.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-retrieve-from-table.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Retrieve data from tables [33 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="7204" id="7204" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-boolean-operators.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-boolean-operators.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Boolean and Relational operators [12
                      Exercises]</strong
                    ></a
                  >
                </li>
                <li name="3d4e" id="3d4e" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-wildcard-special-operators.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-wildcard-special-operators.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Wildcard and Special operators [22 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="7afb" id="7afb" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-aggregate-functions.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-aggregate-functions.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Aggregate Functions [25 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="cc71" id="cc71" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-fromatting-output-exercises.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-fromatting-output-exercises.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Formatting query output [10 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="77bf" id="77bf" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql/joins/s/sql-exercises/ql-exercises-quering-on-multiple-table.php"
                    data-href="https://www.w3resource.com/sql/joins/s/sql-exercises/ql-exercises-quering-on-multiple-table.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Quering on Multiple Tables [7 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="0bc2" id="0bc2" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sorting-and-filtering-hr/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/sorting-and-filtering-hr/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >FILTERING and SORTING on HR Database [38
                      Exercises]</strong
                    ></a
                  >
                </li>
                <li name="e28a" id="e28a" class="graf graf--li graf-after--li">
                  SQL JOINS
                </li>
                <li name="84a2" id="84a2" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-joins-exercises.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-joins-exercises.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL JOINS [29 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="f97b" id="f97b" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/joins-hr/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/joins-hr/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL JOINS on HR Database [27 Exercises]</strong
                    ></a
                  >
                </li>
                <li
                  name="b33e"
                  id="b33e"
                  class="graf graf--li graf--empty graf-after--li"
                >
                  <br />
                </li>
                <li name="0983" id="0983" class="graf graf--li graf-after--li">
                  SQL SUBQUERIES
                </li>
                <li name="423b" id="423b" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/subqueries/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/subqueries/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL SUBQUERIES [39 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="a4d7" id="a4d7" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-subqueries-exercises.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-subqueries-exercises.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL SUBQUERIES on HR Database [55 Exercises]</strong
                    ></a
                  >
                </li>
                <li
                  name="b63d"
                  id="b63d"
                  class="graf graf--li graf--empty graf-after--li"
                >
                  <br />
                </li>
                <li name="2c29" id="2c29" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/union/sql-union.php"
                    data-href="https://www.w3resource.com/sql-exercises/union/sql-union.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL Union[9 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="92c5" id="92c5" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/view/sql-view.php"
                    data-href="https://www.w3resource.com/sql-exercises/view/sql-view.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL View[16 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="d3e5" id="d3e5" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/sql-user-management.php"
                    data-href="https://www.w3resource.com/sql-exercises/sql-user-management.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SQL User Account Management [16 Exercise]</strong
                    ></a
                  >
                </li>
                <li name="e280" id="e280" class="graf graf--li graf-after--li">
                  Movie Database
                </li>
                <li name="5198" id="5198" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/movie-database-exercise/basic-exercises-on-movie-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/movie-database-exercise/basic-exercises-on-movie-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >BASIC queries on movie Database [10 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="ddd5" id="ddd5" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/movie-database-exercise/subqueries-exercises-on-movie-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/movie-database-exercise/subqueries-exercises-on-movie-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SUBQUERIES on movie Database [16 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="5363" id="5363" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/movie-database-exercise/joins-exercises-on-movie-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/movie-database-exercise/joins-exercises-on-movie-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >JOINS on movie Database [24 Exercises]</strong
                    ></a
                  >
                </li>
                <li
                  name="b248"
                  id="b248"
                  class="graf graf--li graf--empty graf-after--li"
                >
                  <br />
                </li>
                <li name="d5ba" id="d5ba" class="graf graf--li graf-after--li">
                  Soccer Database
                </li>
                <li name="a586" id="a586" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >Introduction</strong
                    ></a
                  >
                </li>
                <li name="d585" id="d585" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/basic-exercises-on-soccer-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/basic-exercises-on-soccer-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >BASIC queries on soccer Database [29 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="b626" id="b626" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/subqueries-exercises-on-soccer-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/subqueries-exercises-on-soccer-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SUBQUERIES on soccer Database [33 Exercises]</strong
                    ></a
                  >
                </li>
                <li name="95e1" id="95e1" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/joins-exercises-on-soccer-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/soccer-database-exercise/joins-exercises-on-soccer-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >JOINS queries on soccer Database [61 Exercises]</strong
                    ></a
                  >
                </li>
                <li
                  name="05ba"
                  id="05ba"
                  class="graf graf--li graf--empty graf-after--li"
                >
                  <br />
                </li>
                <li name="2b7b" id="2b7b" class="graf graf--li graf-after--li">
                  Hospital Database
                </li>
                <li name="788d" id="788d" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/hospital-database-exercise/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/hospital-database-exercise/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >Introduction</strong
                    ></a
                  >
                </li>
                <li name="0c32" id="0c32" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/hospital-database-exercise/sql-exercise-on-hospital-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/hospital-database-exercise/sql-exercise-on-hospital-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >BASIC, SUBQUERIES, and JOINS [39 Exercises]</strong
                    ></a
                  >
                </li>
                <li
                  name="228b"
                  id="228b"
                  class="graf graf--li graf--empty graf-after--li"
                >
                  <br />
                </li>
                <li name="54d4" id="54d4" class="graf graf--li graf-after--li">
                  Employee Database
                </li>
                <li name="c6fb" id="c6fb" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/employee-database-exercise/index.php"
                    data-href="https://www.w3resource.com/sql-exercises/employee-database-exercise/index.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >BASIC queries on employee Database [115
                      Exercises]</strong
                    ></a
                  >
                </li>
                <li name="0419" id="0419" class="graf graf--li graf-after--li">
                  <a
                    href="https://www.w3resource.com/sql-exercises/employee-database-exercise/subqueries-exercises-on-employee-database.php"
                    data-href="https://www.w3resource.com/sql-exercises/employee-database-exercise/subqueries-exercises-on-employee-database.php"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    ><strong class="markup--strong markup--li-strong"
                      >SUBQUERIES on employee Database [77 Exercises]</strong
                    ></a
                  >
                </li>
                <li
                  name="cb3e"
                  id="cb3e"
                  class="graf graf--li graf--empty graf-after--li"
                >
                  <br />
                </li>
                <li name="b3da" id="b3da" class="graf graf--li graf-after--li">
                  More to come!
                </li>
              </ul>
              <h3 name="5a68" id="5a68" class="graf graf--h3 graf-after--li">
                Objective 3 — write database access methods
              </h3>
              <h3 name="5387" id="5387" class="graf graf--h3 graf-after--h3">
                Overview
              </h3>
              <p name="4378" id="4378" class="graf graf--p graf-after--h3">
                While we can write database code directly into our endpoints,
                best practices dictate that all database logic exists in
                separate, modular methods. These files containing database
                access helpers are often called
                <strong class="markup--strong markup--p-strong">models</strong>
              </p>
              <h3 name="f1ae" id="f1ae" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="00c1" id="00c1" class="graf graf--p graf-after--h3">
                To handle CRUD operations for a single resource, we would want
                to create a
                <strong class="markup--strong markup--p-strong">model</strong>
                (or database access file) containing the following methods:
              </p>
              <pre
                name="f510"
                id="f510"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function find() {<br>}</code></pre>
              <pre
                name="c7b2"
                id="c7b2"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function findById(id) {<br>}</code></pre>
              <pre
                name="9c69"
                id="9c69"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function add(user) {<br>}</code></pre>
              <pre
                name="ccd6"
                id="ccd6"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function update(changes, id) {<br>}</code></pre>
              <pre
                name="5848"
                id="5848"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function remove(id) {<br>}</code></pre>
              <p name="0574" id="0574" class="graf graf--p graf-after--pre">
                Each of these functions would use Knex logic to perform the
                necessary database operation.
              </p>
              <pre
                name="8e72"
                id="8e72"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function find() {<br>  return db(&#39;users&#39;);<br>}</code></pre>
              <p name="a6fe" id="a6fe" class="graf graf--p graf-after--pre">
                For each method, we can choose what value to return. For
                example, we may prefer
                <code class="markup--code markup--p-code">findById()</code> to
                return a single
                <code class="markup--code markup--p-code">user</code> object
                rather than an array.
              </p>
              <pre
                name="44ba"
                id="44ba"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function findById(id) {<br>// first() returns the first entry in the db matching the query<br>  return db(&#39;users&#39;).where({ id }).first();<br>}</code></pre>
              <p name="156b" id="156b" class="graf graf--p graf-after--pre">
                We can also use existing methods like
                <code class="markup--code markup--p-code">findById()</code> to
                help
                <code class="markup--code markup--p-code">add()</code> return
                the new user (instead of just the id).
              </p>
              <pre
                name="0d97"
                id="0d97"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function add(user) {<br>  db(&#39;users&#39;).insert(user)<br>    .then(ids =&gt; {<br>      return findById(ids[0]);<br>    });<br>}</code></pre>
              <p name="29e9" id="29e9" class="graf graf--p graf-after--pre">
                Once all methods are written as desired, we can export them like
                so:
              </p>
              <pre
                name="038c"
                id="038c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">module.exports = {<br>  find,<br>  findById,<br>  add,<br>  update,<br>  delete,<br>}</code></pre>
              <p name="046a" id="046a" class="graf graf--p graf-after--pre">
                …and use the helpers in our endpoints
              </p>
              <pre
                name="47c1"
                id="47c1"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const User = require(&#39;./user-model.js&#39;);</code></pre>
              <pre
                name="f2d7"
                id="f2d7"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">router.get(&#39;/&#39;, (req, res) =&gt; {<br>  User.find()<br>    .then(users =&gt; {<br>      res.json(users);<br>    })<br>    .catch(&amp;nbsp;err =&gt; {});<br>});</code></pre>
              <p name="0a03" id="0a03" class="graf graf--p graf-after--pre">
                There should no be
                <code class="markup--code markup--p-code">knex</code> code in
                the endpoints themselves.
              </p>
              <p
                name="26b9"
                id="26b9"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <p
                name="cfd7"
                id="cfd7"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <figure
                name="5801"
                id="5801"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p
                name="c442"
                id="c442"
                class="graf graf--p graf--empty graf-after--figure"
              >
                <br />
              </p>
              <p
                name="e949"
                id="e949"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <figure
                name="8bd3"
                id="8bd3"
                class="graf graf--figure graf--iframe graf-after--p"
              >
                <iframe
                  src="https://replit.com/@bgoonz/express-knex-postgres-boilerplate?lite=true&amp;amp%3Breferrer=https%3A%2F%2Fbryanguner.medium.com&amp;lite=true"
                  width="700"
                  height="525"
                  frameborder="0"
                  scrolling="no"
                ></iframe>
              </figure>
              <p
                name="cb1d"
                id="cb1d"
                class="graf graf--p graf--empty graf-after--figure"
              >
                <br />
              </p>
              <p
                name="286a"
                id="286a"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <p
                name="26b1"
                id="26b1"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <p
                name="04ec"
                id="04ec"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <figure
                name="609d"
                id="609d"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="8cb1"
                id="8cb1"
                class="graf graf--h3 graf-after--figure"
              >
                A database is a collection of data organized for easy retrieval
                and manipulation.
              </h3>
              <p name="096f" id="096f" class="graf graf--p graf-after--h3">
                We’re concerned only with digital databases, those that run on
                computers or other electronic devices. Digital databases have
                been around since the 1960s. Relational databases, those which
                store “related” data, are the oldest and most common type of
                database in use today.
              </p>
              <h3 name="6dbd" id="6dbd" class="graf graf--h3 graf-after--p">
                Data Persistence
              </h3>
              <p name="0f59" id="0f59" class="graf graf--p graf-after--h3">
                A database is often necessary because our application or code
                requires data persistence. This term refers to data that is
                infrequently accessed and not likely to be modified. In less
                technical terms, the information will be safely stored and
                remain untouched unless intentionally modified.
              </p>
              <p name="83cc" id="83cc" class="graf graf--p graf-after--p">
                A familiar example of non-persistent data would be JavaScript
                objects and arrays, which reset each time the code runs.
              </p>
              <h3 name="a83b" id="a83b" class="graf graf--h3 graf-after--p">
                Relational Databases
              </h3>
              <p name="9245" id="9245" class="graf graf--p graf-after--h3">
                In relational databases,
                <strong class="markup--strong markup--p-strong"
                  >the data is stored in tabular format grouped into rows and
                  columns</strong
                >
                (similar to spreadsheets). A collection of rows is called a
                table. Each row represents a single record in the table and is
                made up of one or more columns.
              </p>
              <p name="6510" id="6510" class="graf graf--p graf-after--p">
                These kinds of databases are relational because a
                <em class="markup--em markup--p-em">relation</em> is a
                mathematical idea equivalent to a table. So relational databases
                are databases that store their data in tables.
              </p>
              <h3 name="b4f3" id="b4f3" class="graf graf--h3 graf-after--p">
                Tables
              </h3>
              <p name="c357" id="c357" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong"
                  >Below are some basic facts about tables:</strong
                >
              </p>
              <blockquote
                name="7901"
                id="7901"
                class="graf graf--pullquote graf-after--p"
              >
                Tables organize data in rows and columns.
              </blockquote>
              <blockquote
                name="aa8a"
                id="aa8a"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Each row in a table represents one distinct record.
              </blockquote>
              <blockquote
                name="fd30"
                id="fd30"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Each column represents a field or attribute that is common to
                all the records.
              </blockquote>
              <blockquote
                name="d493"
                id="d493"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Fields should have a descriptive name and a data type
                appropriate for the attribute it represents.
              </blockquote>
              <blockquote
                name="452f"
                id="452f"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Tables usually have more rows than columns.
              </blockquote>
              <blockquote
                name="5573"
                id="5573"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Tables have primary keys that uniquely identify each row.
              </blockquote>
              <blockquote
                name="6487"
                id="6487"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Foreign keys represent the relationships with other tables.
              </blockquote>
              <figure
                name="dd02"
                id="dd02"
                class="graf graf--figure graf-after--pullquote"
              >
                <img
                  class="graf-image"
                  data-image-id="0*7ZPYzWNRcs2PBL6p.jpg"
                  data-width="401"
                  data-height="419"
                  src="https://cdn-images-1.medium.com/max/800/0*7ZPYzWNRcs2PBL6p.jpg"
                />
              </figure>
              <figure
                name="fdfd"
                id="fdfd"
                class="graf graf--figure graf-after--figure"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="fc41"
                id="fc41"
                class="graf graf--h3 graf-after--figure"
              >
                SQL:
              </h3>
              <p name="cbc2" id="cbc2" class="graf graf--p graf-after--h3">
                SQL is a standard language, which means that it almost certainly
                will be supported, no matter how your database is managed. That
                said, be aware that the SQL language can vary depending on
                database management tools. This lesson focuses on a set of core
                commands that never change. Learning the standard commands is an
                excellent introduction since the knowledge transfers between
                database products.
              </p>
              <p name="bd02" id="bd02" class="graf graf--p graf-after--p">
                The syntax for SQL is English-like and requires fewer symbols
                than programming languages like C, Java, and JavaScript.
              </p>
              <p name="7e95" id="7e95" class="graf graf--p graf-after--p">
                It is declarative and concise, which means there is a lot less
                to learn to use it effectively.
              </p>
              <p name="8364" id="8364" class="graf graf--p graf-after--p">
                When learning SQL, it is helpful to understand that each command
                is designed for a different purpose. If we classify the commands
                by purpose, we’ll end up with the following sub-categories of
                SQL:
              </p>
              <ul class="postList">
                <li name="aba8" id="aba8" class="graf graf--li graf-after--p">
                  <strong class="markup--strong markup--li-strong"
                    >Data Definition Language (DDL)</strong
                  >: used to modify database objects. Some examples are:
                  <code class="markup--code markup--li-code">CREATE TABLE</code
                  >,
                  <code class="markup--code markup--li-code">ALTER TABLE</code>,
                  and
                  <code class="markup--code markup--li-code">DROP TABLE</code>.
                </li>
                <li name="4f3f" id="4f3f" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Data Manipulation Language (DML)</strong
                  >: used to manipulate the data stored in the database. Some
                  examples are:
                  <code class="markup--code markup--li-code">INSERT</code>,
                  <code class="markup--code markup--li-code">UPDATE</code>, and
                  <code class="markup--code markup--li-code">DELETE</code>.
                </li>
                <li name="e1f2" id="e1f2" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Data Query Language (DQL)</strong
                  >: used to ask questions about the data stored in the
                  database. The most commonly used SQL command is
                  <code class="markup--code markup--li-code">SELECT</code>, and
                  it falls in this category.
                </li>
                <li name="4474" id="4474" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Data Control Language (DCL)</strong
                  >: used to manage database security and user’s access to data.
                  These commands fall into the realm of Database Administrators.
                  Some examples are
                  <code class="markup--code markup--li-code">GRANT</code> and
                  <code class="markup--code markup--li-code">REVOKE</code>.
                </li>
                <li name="921b" id="921b" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Transaction Control Commands</strong
                  >: used for managing groups of statements that must execute as
                  a unit or not execute at all. Examples are
                  <code class="markup--code markup--li-code">COMMIT</code> and
                  <code class="markup--code markup--li-code">ROLLBACK</code>.
                </li>
              </ul>
              <p name="91cf" id="91cf" class="graf graf--p graf-after--li">
                As a developer, you’ll need to get familiar with DDL and become
                proficient using DML and DQL. This lesson will cover only DML
                and DQL commands.
              </p>
              <h3
                name="5c45"
                id="5c45"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="42e2"
                id="42e2"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p name="5c03" id="5c03" class="graf graf--p graf-after--figure">
                The four SQL operations covered in this section will allow a
                user to
                <strong class="markup--strong markup--p-strong">query</strong>,
                <strong class="markup--strong markup--p-strong">insert</strong>,
                and
                <strong class="markup--strong markup--p-strong">modify</strong>
                a database table.
              </p>
              <h3 name="de0c" id="de0c" class="graf graf--h3 graf-after--p">
                Query
              </h3>
              <p name="7149" id="7149" class="graf graf--p graf-after--h3">
                A
                <strong class="markup--strong markup--p-strong">query</strong>
                is a SQL statement used to retrieve data from a database. The
                command used to write queries is
                <code class="markup--code markup--p-code">SELECT</code>, and it
                is one of the most commonly used SQL commands.
              </p>
              <p name="bede" id="bede" class="graf graf--p graf-after--p">
                The basic syntax for a
                <code class="markup--code markup--p-code">SELECT</code>
                statement is this:
              </p>
              <pre
                name="61d7"
                id="61d7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select &lt;selection&gt; from &lt;table name&gt;;</code></pre>
              <p name="0b50" id="0b50" class="graf graf--p graf-after--pre">
                To see all the fields on a table, we can use a
                <code class="markup--code markup--p-code">*</code> as the
                <code class="markup--code markup--p-code">selection</code>.
              </p>
              <pre
                name="14d7"
                id="14d7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from employees;</code></pre>
              <p name="949b" id="949b" class="graf graf--p graf-after--pre">
                The preceding statement would show all the records and all the
                columns for each record in the
                <code class="markup--code markup--p-code">employees</code>
                table.
              </p>
              <p name="2d09" id="2d09" class="graf graf--p graf-after--p">
                To pick the fields we want to see, we use a comma-separated
                list:
              </p>
              <pre
                name="44a5"
                id="44a5"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select first_name, last_name, salary from employees;</code></pre>
              <p name="5d3f" id="5d3f" class="graf graf--p graf-after--pre">
                The return of that statement would hold all records from the
                listed fields.
              </p>
              <p name="71d1" id="71d1" class="graf graf--p graf-after--p">
                We can extend the
                <code class="markup--code markup--p-code">SELECT</code>
                command&#39;s capabilities using
                <code class="markup--code markup--p-code">clauses</code> for
                things like filtering, sorting, pagination, and more.
              </p>
              <p name="34c7" id="34c7" class="graf graf--p graf-after--p">
                It is possible to query multiple tables in a single query. But,
                in this section, we only perform queries on a single table. We
                will cover performing queries on multiple tables in another
                section.
              </p>
              <h3 name="7c25" id="7c25" class="graf graf--h3 graf-after--p">
                Insert
              </h3>
              <p name="4581" id="4581" class="graf graf--p graf-after--h3">
                To
                <strong class="markup--strong markup--p-strong">insert</strong>
                new data into a table, we’ll use the
                <code class="markup--code markup--p-code">INSERT</code> command.
                The basic syntax for an
                <code class="markup--code markup--p-code">INSERT</code>
                statement is this:
              </p>
              <pre
                name="9ada"
                id="9ada"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">insert into &lt;table name&gt; (&lt;selection&gt;) values (&lt;values&gt;)</code></pre>
              <p name="432b" id="432b" class="graf graf--p graf-after--pre">
                Using this formula, we can specify which values will be inserted
                into which fields like so:
              </p>
              <pre
                name="1898"
                id="1898"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">insert into Customers (Country, CustomerName, ContactName, Address, City, PostalCode)<br>values (&#39;USA&#39;, &#39;WebDev School&#39;, &#39;Austen Allred&#39;, &#39;1 WebDev Court&#39;, &#39;Provo&#39;, &#39;84601&#39;);</code></pre>
              <h3 name="18fd" id="18fd" class="graf graf--h3 graf-after--pre">
                Modify
              </h3>
              <p name="abe7" id="abe7" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong"
                  >Modifying</strong
                >
                a database consists of updating and removing records. For these
                operations, we’ll use
                <code class="markup--code markup--p-code">UPDATE</code> and
                <code class="markup--code markup--p-code">DELETE</code>
                commands, respectively.
              </p>
              <p name="83c8" id="83c8" class="graf graf--p graf-after--p">
                The basic syntax for an
                <code class="markup--code markup--p-code">UPDATE</code>
                statement is:
              </p>
              <pre
                name="6511"
                id="6511"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">update &lt;table name&gt; set &lt;field&gt; = &lt;value&gt; where &lt;condition&gt;;</code></pre>
              <p name="aaa7" id="aaa7" class="graf graf--p graf-after--pre">
                The basic syntax for a
                <code class="markup--code markup--p-code">DELETE</code>
                statement is:
              </p>
              <pre
                name="cb82"
                id="cb82"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">delete from &lt;table name&gt; where &lt;condition&gt;;</code></pre>
              <h3
                name="f3bf"
                id="f3bf"
                class="graf graf--h3 graf--empty graf-after--pre"
              >
                <br />
              </h3>
              <figure
                name="a506"
                id="a506"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="2713"
                id="2713"
                class="graf graf--h3 graf-after--figure"
              >
                Filtering results using WHERE clause
              </h3>
              <p name="de5d" id="de5d" class="graf graf--p graf-after--h3">
                When querying a database, the default result will be every entry
                in the given table. However, often, we are looking for a
                specific record or a set of records that meets certain criteria.
              </p>
              <p name="e07e" id="e07e" class="graf graf--p graf-after--p">
                A <code class="markup--code markup--p-code">WHERE</code> clause
                can help in both cases.
              </p>
              <p name="4682" id="4682" class="graf graf--p graf-after--p">
                Here’s an example where we might only want to find customers
                living in Berlin.
              </p>
              <pre
                name="127c"
                id="127c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select City, CustomerName, ContactName<br>from Customers<br>where City = &#39;Berlin&#39;</code></pre>
              <p name="927a" id="927a" class="graf graf--p graf-after--pre">
                We can also chain together
                <code class="markup--code markup--p-code">WHERE</code> clauses
                using <code class="markup--code markup--p-code">OR</code> and
                <code class="markup--code markup--p-code">AND</code> to limit
                our results further.
              </p>
              <p name="5e3b" id="5e3b" class="graf graf--p graf-after--p">
                The following query includes only records that match both
                criteria.
              </p>
              <pre
                name="b765"
                id="b765"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select City, CustomerName, ContactName<br>from Customers<br>where Country = &#39;France&#39; and City = &#39;Paris&#39;</code></pre>
              <p name="166e" id="166e" class="graf graf--p graf-after--pre">
                And this query includes records that match either criteria.
              </p>
              <pre
                name="2e09"
                id="2e09"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select City, CustomerName, ContactName<br>from Customers<br>where Country = &#39;France&#39; or City = &#39;Paris&#39;</code></pre>
              <p name="09ce" id="09ce" class="graf graf--p graf-after--pre">
                These operators can be combined and grouped with parentheses to
                add complex selection logic. They behave similarly to what
                you’re used to in programming languages.
              </p>
              <p name="5c01" id="5c01" class="graf graf--p graf-after--p">
                You can read more about SQLite operators from
                <a
                  href="https://www.w3resource.com/sqlite/operators.php"
                  data-href="https://www.w3resource.com/sqlite/operators.php"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >w3resource (Links to an external site.)</a
                >.
              </p>
              <p name="9650" id="9650" class="graf graf--p graf-after--p">
                To select a single record, we can use a
                <code class="markup--code markup--p-code">WHERE</code> statement
                with a uniquely identifying field, like an id:
              </p>
              <pre
                name="7b89"
                id="7b89"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from Customers<br>where CustomerId=3;</code></pre>
              <p name="f79a" id="f79a" class="graf graf--p graf-after--pre">
                Other comparison operators also work in
                <code class="markup--code markup--p-code">WHERE</code>
                conditions, such as
                <code class="markup--code markup--p-code">&gt;</code>,
                <code class="markup--code markup--p-code">&lt;</code>,
                <code class="markup--code markup--p-code">&lt;=</code>, and
                <code class="markup--code markup--p-code">&gt;=</code>.
              </p>
              <pre
                name="9e52"
                id="9e52"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from employees where salary &gt;= 50000</code></pre>
              <h3 name="662e" id="662e" class="graf graf--h3 graf-after--pre">
                Ordering results using the ORDER BY clause
              </h3>
              <p name="174f" id="174f" class="graf graf--p graf-after--h3">
                Query results are shown in the same order the data was inserted.
                To control how the data is sorted, we can use the
                <code class="markup--code markup--p-code">ORDER BY</code>
                clause. Let&#39;s see an example.
              </p>
              <pre
                name="0545"
                id="0545"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">-- sorts the results first by salary in descending order, then by the last name in ascending order<br>select * from employees order by salary desc, last_name;</code></pre>
              <p name="0272" id="0272" class="graf graf--p graf-after--pre">
                We can pass a list of field names to
                <code class="markup--code markup--p-code">order by</code> and
                optionally choose
                <code class="markup--code markup--p-code">asc</code> or
                <code class="markup--code markup--p-code">desc</code> for the
                sort direction. The default is
                <code class="markup--code markup--p-code">asc</code>, so it
                doesn&#39;t need to be specified.
              </p>
              <p name="daf0" id="daf0" class="graf graf--p graf-after--p">
                Some SQL engines also support using field abbreviations when
                sorting.
              </p>
              <pre
                name="7beb"
                id="7beb"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select name, salary, department from employees order by 3, 2 desc;</code></pre>
              <p name="0d73" id="0d73" class="graf graf--p graf-after--pre">
                In this case, the results are sorted by the department in
                ascending order first and then by salary in descending order.
                The numbers refer to the fields’ position in the
                <em class="markup--em markup--p-em">selection</em> portion of
                the query, so
                <code class="markup--code markup--p-code">1</code> would be
                <em class="markup--em markup--p-em">name</em>,
                <code class="markup--code markup--p-code">2</code> would be
                <em class="markup--em markup--p-em">salary</em>, and so on.
              </p>
              <p name="ef09" id="ef09" class="graf graf--p graf-after--p">
                Note that the
                <code class="markup--code markup--p-code">WHERE</code> clause
                should come after the
                <code class="markup--code markup--p-code">FROM</code> clause.
                The
                <code class="markup--code markup--p-code">ORDER BY</code> clause
                always goes last.
              </p>
              <pre
                name="f9cd"
                id="f9cd"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from employees where salary &gt; 50000 order by last_name;</code></pre>
              <h3 name="62aa" id="62aa" class="graf graf--h3 graf-after--pre">
                Limiting results using the LIMIT clause
              </h3>
              <p name="5ecc" id="5ecc" class="graf graf--p graf-after--h3">
                When we wish to see only a limited number of records, we can use
                a <code class="markup--code markup--p-code">LIMIT</code> clause.
              </p>
              <p name="2b4c" id="2b4c" class="graf graf--p graf-after--p">
                The following returns the first ten records in the products
                table:
              </p>
              <pre
                name="b362"
                id="b362"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from products<br>limit 10</code></pre>
              <p name="4237" id="4237" class="graf graf--p graf-after--pre">
                <code class="markup--code markup--p-code">LIMIT</code> clauses
                are often used in conjunction with
                <code class="markup--code markup--p-code">ORDER BY</code>. The
                following shows us the five cheapest products:
              </p>
              <pre
                name="a5fe"
                id="a5fe"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from products<br>order by price desc<br>limit 5</code></pre>
              <h3 name="63dd" id="63dd" class="graf graf--h3 graf-after--pre">
                Inserting data using INSERT
              </h3>
              <p name="95b3" id="95b3" class="graf graf--p graf-after--h3">
                An insert statement adds a new record to the database. All
                non-null fields must be listed out in the same order as their
                values. Some fields, like ids and timestamps, may be
                auto-generated and do not need to be included in an
                <code class="markup--code markup--p-code">INSERT</code>
                statement.
              </p>
              <pre
                name="450f"
                id="450f"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">-- we can add fields in any order; the values need to be in the same ordinal position<br>-- the id will be assigned automatically<br>  insert into Customers (Country, CustomerName, ContactName, Address, City, PostalCode)<br>  values (&#39;USA&#39;, &#39;WebDev School&#39;, &#39;Austen Allred&#39;, &#39;1 WebDev Court&#39;, &#39;Provo&#39;, &#39;84601&#39;);</code></pre>
              <p name="d138" id="d138" class="graf graf--p graf-after--pre">
                The values in an insert statement must not violate any
                restrictions and constraints that the database has in place,
                such as expected datatypes. We will learn more about constraints
                and schema design in a later section.
              </p>
              <h3 name="64ec" id="64ec" class="graf graf--h3 graf-after--p">
                Modifying recording using UPDATE
              </h3>
              <p name="3085" id="3085" class="graf graf--p graf-after--h3">
                When modifying a record, we identify a single record or a set of
                records to update using a
                <code class="markup--code markup--p-code">WHERE</code> clause.
                Then we can set the new value(s) in place.
              </p>
              <pre
                name="e11e"
                id="e11e"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">update Customers<br>set City = &#39;Silicon Valley&#39;, Country = &#39;USA&#39;<br>where CustomerName = &#39;WebDev School&#39;</code></pre>
              <p name="fbc5" id="fbc5" class="graf graf--p graf-after--pre">
                Technically the
                <code class="markup--code markup--p-code">WHERE</code> clause is
                not required, but leaving it off would result in every record
                within the table receiving the update.
              </p>
              <h3 name="b420" id="b420" class="graf graf--h3 graf-after--p">
                Removing records using DELETE
              </h3>
              <p name="c6cb" id="c6cb" class="graf graf--p graf-after--h3">
                When removing a record or set of records, we need only identify
                which record(s) to remove using a
                <code class="markup--code markup--p-code">WHERE</code> clause:
              </p>
              <pre
                name="1bfc"
                id="1bfc"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">delete from Customers<br>where CustomerName = &#39;WebDev School`;</code></pre>
              <p name="0c6c" id="0c6c" class="graf graf--p graf-after--pre">
                Once again, the
                <code class="markup--code markup--p-code">WHERE</code> clause is
                not required, but leaving it off would remove every record in
                the table, so it&#39;s essential.
              </p>
              <h3
                name="df72"
                id="df72"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="0cc5"
                id="0cc5"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p name="5cdd" id="5cdd" class="graf graf--p graf-after--figure">
                Raw SQL is a critical baseline skill. However, Node developers
                generally use an
                <strong class="markup--strong markup--p-strong"
                  >Object Relational Mapper (ORM)</strong
                >
                or
                <strong class="markup--strong markup--p-strong"
                  >query builder</strong
                >
                to write database commands in a backend codebase. Both
                <strong class="markup--strong markup--p-strong">ORMs</strong>
                and
                <strong class="markup--strong markup--p-strong"
                  >query builders</strong
                >
                are JavaScript libraries that allow us to interface with the
                database using a JavaScript version of the SQL language.
              </p>
              <p name="df91" id="df91" class="graf graf--p graf-after--p">
                For example, instead of a raw SQL
                <code class="markup--code markup--p-code">SELECT</code>:
              </p>
              <pre
                name="8ecc"
                id="8ecc"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">SELECT * FROM users;</code></pre>
              <p name="da9f" id="da9f" class="graf graf--p graf-after--pre">
                We could use a query builder to write the same logic in
                JavaScript:
              </p>
              <pre
                name="51b5"
                id="51b5"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db.select(&#39;*&#39;).from(&#39;users&#39;);</code></pre>
              <p name="c5e6" id="c5e6" class="graf graf--p graf-after--pre">
                <strong class="markup--strong markup--p-strong"
                  >Query builders</strong
                >
                are lightweight and easy to get off the ground, whereas
                <strong class="markup--strong markup--p-strong">ORMs</strong>
                use an object-oriented model and provide more heavy lifting
                within their rigid structure.
              </p>
              <p name="0c46" id="0c46" class="graf graf--p graf-after--p">
                We will use a
                <strong class="markup--strong markup--p-strong"
                  >query builder</strong
                >
                called
                <a
                  href="https://knexjs.org/"
                  data-href="https://knexjs.org/"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >knex.js (Links to an external site.)</a
                >.
              </p>
              <h3
                name="bbea"
                id="bbea"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="ea0b"
                id="ea0b"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="e275"
                id="e275"
                class="graf graf--h3 graf-after--figure"
              >
                Knex Setup
              </h3>
              <p name="b23c" id="b23c" class="graf graf--p graf-after--h3">
                To use Knex in a repository, we’ll need to add two libraries:
              </p>
              <pre
                name="d476"
                id="d476"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">npm install knex sqlite3</code></pre>
              <p name="9d35" id="9d35" class="graf graf--p graf-after--pre">
                <code class="markup--code markup--p-code">knex</code> is our
                query builder library, and
                <code class="markup--code markup--p-code">sqlite3</code> allows
                us to interface with a
                <code class="markup--code markup--p-code">sqlite</code>
                database. We&#39;ll learn more about
                <code class="markup--code markup--p-code">sqlite</code> and
                other
                <strong class="markup--strong markup--p-strong"
                  >database management systems</strong
                >
                in the following module. For now, know that you need both
                libraries.
              </p>
              <p name="5af6" id="5af6" class="graf graf--p graf-after--p">
                Next, we use Knex to set up a config file:
              </p>
              <pre
                name="9dd4"
                id="9dd4"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const knex = require(&#39;knex&#39;);</code></pre>
              <pre
                name="1a58"
                id="1a58"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const config = {<br>  client: &#39;sqlite3&#39;,<br>  connection: {<br>    filename: &#39;./data/posts.db3&#39;,<br>  },<br>  useNullAsDefault: true,<br>};</code></pre>
              <pre
                name="f847"
                id="f847"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">module.exports = knex(config);</code></pre>
              <p name="9f80" id="9f80" class="graf graf--p graf-after--pre">
                To use the query builder elsewhere in our code, we need to call
                <code class="markup--code markup--p-code">knex</code> and pass
                in a
                <code class="markup--code markup--p-code">config</code> object.
                We&#39;ll be discussing Knex configuration more in a future
                module. Still, we only need the
                <code class="markup--code markup--p-code">client</code>,
                <code class="markup--code markup--p-code">connection</code>, and
                <code class="markup--code markup--p-code"
                  >useNullAsDefault</code
                >
                keys as shown above. The
                <code class="markup--code markup--p-code">filename</code> should
                point towards the pre-existing database file, which can be
                recognized by the <code class="markup--code markup--p-code"
                  >.db3</code
                >
                extension.
              </p>
              <p name="ba8f" id="ba8f" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">GOTCHA</strong>:
                The file path to the database should be with respect to the
                <strong class="markup--strong markup--p-strong">root</strong> of
                the repo, not the configuration file itself.
              </p>
              <p name="45f7" id="45f7" class="graf graf--p graf-after--p">
                Once Knex is configured, we can import the above config file
                anywhere in our codebase to access the database.
              </p>
              <pre
                name="025d"
                id="025d"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const db = require(&#39;../data/db-config.js);</code></pre>
              <p name="8cd1" id="8cd1" class="graf graf--p graf-after--pre">
                The <code class="markup--code markup--p-code">db</code> object
                provides methods that allow us to begin building queries.
              </p>
              <h3 name="b219" id="b219" class="graf graf--h3 graf-after--p">
                SELECT using Knex
              </h3>
              <p name="a48c" id="a48c" class="graf graf--p graf-after--h3">
                In Knex, the equivalent of
                <code class="markup--code markup--p-code"
                  >SELECT * FROM users</code
                >
                is:
              </p>
              <pre
                name="0368"
                id="0368"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db.select(&#39;*&#39;).from(&#39;users&#39;);</code></pre>
              <p name="70ab" id="70ab" class="graf graf--p graf-after--pre">
                There’s a simpler way to write the same command:
              </p>
              <pre
                name="8b4a"
                id="8b4a"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;users&#39;);</code></pre>
              <p name="ccab" id="ccab" class="graf graf--p graf-after--pre">
                Using this, we could write a
                <code class="markup--code markup--p-code">GET</code> endpoint.
              </p>
              <pre
                name="788a"
                id="788a"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">router.get(&#39;/api/users&#39;, (req, res) =&gt; {<br>  db(&#39;users&#39;)<br>  .then(users =&gt; {<br>    res.json(users);<br>  })<br>  .catch (err =&gt; {<br>    res.status(500).json({ message: &#39;Failed to get users&#39; });<br>  });<br>});</code></pre>
              <p name="c792" id="c792" class="graf graf--p graf-after--pre">
                <strong class="markup--strong markup--p-strong">NOTE</strong>:
                All Knex queries return promises.
              </p>
              <p name="06da" id="06da" class="graf graf--p graf-after--p">
                Knex also allows for a where clause. In Knex, we could write
                <code class="markup--code markup--p-code"
                  >SELECT * FROM users WHERE id=1</code
                >
                as
              </p>
              <pre
                name="67ab"
                id="67ab"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;users&#39;).where({ id: 1 });</code></pre>
              <p name="cec1" id="cec1" class="graf graf--p graf-after--pre">
                This method will resolve to an array containing a single entry
                like so:
                <code class="markup--code markup--p-code"
                  >[{ id: 1, name: &#39;bill&#39; }]</code
                >.
              </p>
              <p name="20ec" id="20ec" class="graf graf--p graf-after--p">
                Using this, we might add a
                <code class="markup--code markup--p-code">GET</code> endpoint
                where a specific user:
              </p>
              <pre
                name="c734"
                id="c734"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">server.get(&#39;api/users/:id&#39;, (req, res) =&gt; {<br>  const { id } = req.params;</code></pre>
              <pre
                name="3e59"
                id="3e59"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  db(&#39;users&#39;).where({ id })<br>  .then(users =&gt; {<br>    // we must check the length to find our if our user exists<br>    if (users.length) {<br>      res.json(users);<br>    } else {<br>      res.status(404).json({ message: &#39;Could not find user with given id.&#39; })<br>   })<br>  .catch (err =&gt; {<br>    res.status(500).json({ message: &#39;Failed to get user&#39; });<br>  });<br>});</code></pre>
              <h3 name="5aed" id="5aed" class="graf graf--h3 graf-after--pre">
                INSERT using Knex
              </h3>
              <p name="d655" id="d655" class="graf graf--p graf-after--h3">
                In Knex, the equivalent of
                <code class="markup--code markup--p-code"
                  >INSERT INTO users (name, age) VALUES (&#39;Eva&#39;,
                  32)</code
                >
                is:
              </p>
              <pre
                name="02cf"
                id="02cf"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;users&#39;).insert({ name: &#39;Eva&#39;, age: 32 });</code></pre>
              <p name="baaf" id="baaf" class="graf graf--p graf-after--pre">
                The insert method in Knex will resolve to an array containing
                the newly created id for that user like so:
                <code class="markup--code markup--p-code">[3]</code>.
              </p>
              <h3 name="10fa" id="10fa" class="graf graf--h3 graf-after--p">
                UPDATE using Knex
              </h3>
              <p name="3bdb" id="3bdb" class="graf graf--p graf-after--h3">
                In knex, the equivalent of
                <code class="markup--code markup--p-code"
                  >UPDATE users SET name=&#39;Ava&#39;, age=33 WHERE id=3;</code
                >
                is:
              </p>
              <pre
                name="243d"
                id="243d"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;users&#39;).where({ id: 3 })<br>.update({name: &#39;Ava&#39;, age: 33 });</code></pre>
              <p name="b81c" id="b81c" class="graf graf--p graf-after--pre">
                Note that the
                <code class="markup--code markup--p-code">where</code> method
                comes before
                <code class="markup--code markup--p-code">update</code>, unlike
                in SQL.
              </p>
              <p name="1394" id="1394" class="graf graf--p graf-after--p">
                Update will resolve to a count of rows updated.
              </p>
              <h3 name="b552" id="b552" class="graf graf--h3 graf-after--p">
                DELETE using Knex
              </h3>
              <p name="6c6c" id="6c6c" class="graf graf--p graf-after--h3">
                In Knex, the equivalent of
                <code class="markup--code markup--p-code"
                  >DELETE FROM users WHERE age=33;</code
                >
                is:
              </p>
              <pre
                name="6db0"
                id="6db0"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;users&#39;).where({ age: 33}).del();</code></pre>
              <p
                name="c0e0"
                id="c0e0"
                class="graf graf--p graf-after--pre graf--trailing"
              >
                Once again, the
                <code class="markup--code markup--p-code">where</code> must come
                before the <code class="markup--code markup--p-code">del</code>.
                This method will resolve to a count of records removed.
              </p>
            </div>
          </div>
        </section>
        <section name="8002" class="section section--body">
          <div class="section-divider"><hr class="section-divider" /></div>
          <div class="section-content">
            <div class="section-inner sectionLayout--insetColumn">
              <h3
                name="b8c5"
                id="b8c5"
                class="graf graf--h3 graf--empty graf--leading"
              >
                <br />
              </h3>
              <figure
                name="bffa"
                id="bffa"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="8da8"
                id="8da8"
                class="graf graf--h3 graf--empty graf-after--figure"
              >
                <br />
              </h3>
              <p
                name="b1f2"
                id="b1f2"
                class="graf graf--p graf--empty graf-after--h3"
              >
                <br />
              </p>
              <h3 name="bf54" id="bf54" class="graf graf--h3 graf-after--p">
                Here’s a small project you can practice with.
              </h3>
              <figure
                name="106d"
                id="106d"
                class="graf graf--figure graf--iframe graf-after--h3"
              >
                <iframe
                  src="https://replit.com/@bgoonz/node-db1-project?lite=true&amp;amp%3Breferrer=https%3A%2F%2Fbryanguner.medium.com&amp;lite=true"
                  width="700"
                  height="525"
                  frameborder="0"
                  scrolling="no"
                ></iframe>
              </figure>
              <p
                name="1a10"
                id="1a10"
                class="graf graf--p graf--empty graf-after--figure"
              >
                <br />
              </p>
              <p
                name="4620"
                id="4620"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <p name="43eb" id="43eb" class="graf graf--p graf-after--p">
                SQLlite Studio is an application that allows us to create, open,
                view, and modify SQLite databases. To fully understand what
                SQLite Studio is and how it works, we must also understand the
                concept of the Database Management Systems (DBMS).
              </p>
              <h3 name="5992" id="5992" class="graf graf--h3 graf-after--p">
                What is a DBMS?
              </h3>
              <p name="f6be" id="f6be" class="graf graf--p graf-after--h3">
                To manage digital databases we use specialized software called
                <strong class="markup--strong markup--p-strong">D</strong
                >ata<strong class="markup--strong markup--p-strong">B</strong
                >ase
                <strong class="markup--strong markup--p-strong">M</strong
                >anagement
                <strong class="markup--strong markup--p-strong">S</strong>ystems
                (DBMS). These systems typically run on servers and are managed
                by
                <strong class="markup--strong markup--p-strong">D</strong
                >ata<strong class="markup--strong markup--p-strong">B</strong
                >ase
                <strong class="markup--strong markup--p-strong">A</strong
                >dministrators (DBAs).
              </p>
              <p name="086d" id="086d" class="graf graf--p graf-after--p">
                In less technical terms, we need a type of software that will
                allow us to create, access, and generally manage our databases.
                In the world of relational databases, we specifically use
                Relational Database Mangement Systems (RDBMs). Some examples are
                Postgres, SQLite, MySQL, and Oracle.
              </p>
              <p name="f413" id="f413" class="graf graf--p graf-after--p">
                Choosing a DBMS determines everything from how you set up your
                database, to where and how the data is stored, to what SQL
                commands you can use. Most systems share the core of the SQL
                language that you’ve already learned.
              </p>
              <p name="8e28" id="8e28" class="graf graf--p graf-after--p">
                In other words, you can expect
                <code class="markup--code markup--p-code">SELECT</code>,
                <code class="markup--code markup--p-code">UPDATE</code>,
                <code class="markup--code markup--p-code">INSERT</code>,
                <code class="markup--code markup--p-code">WHERE</code> , and the
                like to be the same across all DBMSs, but the subtleties of the
                language may vary.
              </p>
              <h3 name="2a19" id="2a19" class="graf graf--h3 graf-after--p">
                What is SQLite?
              </h3>
              <p name="3e91" id="3e91" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong">SQLite</strong>
                is the DBMS, as the name suggests, it is a more lightweight
                system and thus easier to get set up than some others.
              </p>
              <p name="4d73" id="4d73" class="graf graf--p graf-after--p">
                SQLite allows us to store databases as single files. SQLite
                projects have a <code class="markup--code markup--p-code"
                  >.db3</code
                >
                extension. That is the database.
              </p>
              <p name="c660" id="c660" class="graf graf--p graf-after--p">
                SQLite is
                <em class="markup--em markup--p-em">not a database</em> (like
                relational, graph, or document are databases) but rather
                <em class="markup--em markup--p-em"
                  >a database management system</em
                >.
              </p>
              <h3 name="5d56" id="5d56" class="graf graf--h3 graf-after--p">
                Opening an existing database in SQLite Studio
              </h3>
              <p name="b41f" id="b41f" class="graf graf--p graf-after--h3">
                One useful visual interface we might use with a SQLite database
                is called
                <strong class="markup--strong markup--p-strong"
                  >SQLite Studio</strong
                >.
                <a
                  href="https://sqlitestudio.pl/"
                  data-href="https://sqlitestudio.pl/"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Install SQLITE Studio here. (Links to an external site.)</a
                >
              </p>
              <p name="23a3" id="23a3" class="graf graf--p graf-after--p">
                Once installed, we can use SQLite Studio to open any <code
                  class="markup--code markup--p-code"
                  >.db3</code
                >
                file from a previous lesson. We may view the tables, view the
                data, and even make changes to the database.
              </p>
              <p name="dbfe" id="dbfe" class="graf graf--p graf-after--p">
                For a more detailed look at SQLite Studio, follow along in the
                video above.
              </p>
              <h3
                name="5e64"
                id="5e64"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="1338"
                id="1338"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p name="4bb6" id="4bb6" class="graf graf--p graf-after--figure">
                A
                <strong class="markup--strong markup--p-strong"
                  >database schema</strong
                >
                is the shape of our database. It defines what tables we’ll have,
                which columns should exist within the tables and any
                restrictions on each column.
              </p>
              <p name="e416" id="e416" class="graf graf--p graf-after--p">
                A well-designed database schema keeps the data well organized
                and can help ensure high-quality data.
              </p>
              <p name="6591" id="6591" class="graf graf--p graf-after--p">
                Note that while schema design is usually left to Database
                Administrators (DBAs), understanding schema helps when designing
                APIs and database logic. And in a smaller team, this step may
                fall on the developer.
              </p>
              <h3
                name="a5ae"
                id="a5ae"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="362c"
                id="362c"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p name="433c" id="433c" class="graf graf--p graf-after--figure">
                For a look at schema design in SQLite Studio, follow along in
                the video above.
              </p>
              <p name="7b9c" id="7b9c" class="graf graf--p graf-after--p">
                When designing a single table, we need to ask three things:
              </p>
              <ul class="postList">
                <li name="2e1a" id="2e1a" class="graf graf--li graf-after--p">
                  What fields (or columns) are present?
                </li>
                <li name="52e7" id="52e7" class="graf graf--li graf-after--li">
                  What type of data do we expect for each field?
                </li>
                <li name="8aff" id="8aff" class="graf graf--li graf-after--li">
                  Are there other restrictions needed for each column?
                </li>
              </ul>
              <p name="a7eb" id="a7eb" class="graf graf--p graf-after--li">
                Looking at the following schema diagram for an
                <code class="markup--code markup--p-code">accounts</code> table,
                we can the answer to each other those questions:
              </p>
              <p name="0109" id="0109" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/9790405dda624818822293a383eec2d2"
                  data-href="https://www.notion.so/9790405dda624818822293a383eec2d2"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <h3 name="1d93" id="1d93" class="graf graf--h3 graf-after--p">
                Table Fields
              </h3>
              <p name="8c08" id="8c08" class="graf graf--p graf-after--h3">
                Choosing which fields to include in a table is relatively
                straight forward. What information needs to be tracked regarding
                this resource? In the real world, this is determined by the
                intended use of the product or app.
              </p>
              <p name="2361" id="2361" class="graf graf--p graf-after--p">
                However, this is one requirement every table should satisfy: a
                <strong class="markup--strong markup--p-strong"
                  >primary key</strong
                >. A primary key is a way to identify each entry in the database
                uniquely. It is most often represented as a auto-incrementing
                integer called
                <code class="markup--code markup--p-code">id</code> or
                <code class="markup--code markup--p-code">[tablename]Id</code>.
              </p>
              <h3 name="7bc7" id="7bc7" class="graf graf--h3 graf-after--p">
                Datatypes
              </h3>
              <p name="a66f" id="a66f" class="graf graf--p graf-after--h3">
                Each field must also have a specified datatype. The datatype
                available depends on our DBMS. Some supported datatype in SQLite
                include:
              </p>
              <ul class="postList">
                <li name="92fb" id="92fb" class="graf graf--li graf-after--p">
                  <strong class="markup--strong markup--li-strong"
                    >Null:</strong
                  >
                  Missing or unknown information.
                </li>
                <li name="32ef" id="32ef" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Integer:</strong
                  >
                  Whole numbers.
                </li>
                <li name="181d" id="181d" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Real:</strong
                  >
                  Any number, including decimals.
                </li>
                <li name="ebce" id="ebce" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Text:</strong
                  >
                  Character data.
                </li>
                <li name="c00e" id="c00e" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Blob:</strong
                  >
                  a large binary object that can be used to store miscellaneous
                  data.
                </li>
              </ul>
              <p name="48a9" id="48a9" class="graf graf--p graf-after--li">
                Any data inserted into the table must match the datatypes
                determined in schema design.
              </p>
              <h3 name="d620" id="d620" class="graf graf--h3 graf-after--p">
                Constraints
              </h3>
              <p name="18dc" id="18dc" class="graf graf--p graf-after--h3">
                Beyond datatypes, we may add additional
                <strong class="markup--strong markup--p-strong"
                  >constraints</strong
                >
                on each field. Some examples include:
              </p>
              <ul class="postList">
                <li name="14ca" id="14ca" class="graf graf--li graf-after--p">
                  <strong class="markup--strong markup--li-strong"
                    >Not Null:</strong
                  >
                  The field cannot be left empty
                </li>
                <li name="b533" id="b533" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Unique:</strong
                  >
                  No two records can have the same value in this field
                </li>
                <li name="f0c4" id="f0c4" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Primary key:</strong
                  > — Indicates this field is the primary key. Both the not null
                  and unique constraints will be enforced.
                </li>
                <li name="f116" id="f116" class="graf graf--li graf-after--li">
                  <strong class="markup--strong markup--li-strong"
                    >Default:</strong
                  > — Sets a default value if none is provided.
                </li>
              </ul>
              <p name="2515" id="2515" class="graf graf--p graf-after--li">
                As with data types, any data that does not satisfy the schema
                constraints will be rejected from the database.
              </p>
              <h3
                name="d2c0"
                id="d2c0"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <h3
                name="d95c"
                id="d95c"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p
                name="6ebb"
                id="6ebb"
                class="graf graf--p graf--empty graf-after--h3"
              >
                <br />
              </p>
              <figure
                name="7f35"
                id="7f35"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="80e5"
                id="80e5"
                class="graf graf--h3 graf-after--figure"
              >
                Multi-Table Design
              </h3>
              <p name="e62a" id="e62a" class="graf graf--p graf-after--h3">
                Another critical component of schema design is to understand how
                different tables relate to each other. This will be covered in
                later lesson.
              </p>
              <p name="1c26" id="1c26" class="graf graf--p graf-after--p">
                Knex provides a
                <strong class="markup--strong markup--p-strong"
                  >schema builder</strong
                >, which allows us to write code to design our database schema.
                However, beyond thinking about columns and constraints, we must
                also consider updates.
              </p>
              <p name="23c9" id="23c9" class="graf graf--p graf-after--p">
                When a schema needs to be updated, a developer must feel
                confident that the changes go into effect everywhere. This means
                schema updates on the developer’s local machine, on any testing
                or staging versions, on the production database, and then on any
                other developer’s local machines. This is where
                <strong class="markup--strong markup--p-strong"
                  >migrations</strong
                >
                come into play.
              </p>
              <p name="e3a7" id="e3a7" class="graf graf--p graf-after--p">
                A
                <code class="markup--code markup--p-code"
                  >database migration</code
                >
                describes changes made to the structure of a database.
                Migrations include things like adding new objects, adding new
                tables, and modifying existing objects or tables.
              </p>
              <h3
                name="86cb"
                id="86cb"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="bda3"
                id="bda3"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="ea3b"
                id="ea3b"
                class="graf graf--h3 graf-after--figure"
              >
                Knex Cli
              </h3>
              <p name="e0f2" id="e0f2" class="graf graf--p graf-after--h3">
                To use migrations (and to make Knex setup easier), we need to
                use
                <strong class="markup--strong markup--p-strong">knex cli</strong
                >. Install knex globally with
                <code class="markup--code markup--p-code"
                  >npm install -g knex</code
                >.
              </p>
              <p name="56f6" id="56f6" class="graf graf--p graf-after--p">
                This allows you to use Knex commands within any repo that has
                <code class="markup--code markup--p-code">knex</code> as a local
                dependency. If you have any issues with this global install, you
                can use the
                <code class="markup--code markup--p-code">npx knex</code>
                command instead.
              </p>
              <h3 name="3bd5" id="3bd5" class="graf graf--h3 graf-after--p">
                Initializing Knex
              </h3>
              <p name="b1d2" id="b1d2" class="graf graf--p graf-after--h3">
                To start, add the
                <code class="markup--code markup--p-code">knex</code> and
                <code class="markup--code markup--p-code">sqlite3</code>
                libraries to your repository.
              </p>
              <p name="268c" id="268c" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >npm install knex sqlite3</code
                >
              </p>
              <p name="0fd2" id="0fd2" class="graf graf--p graf-after--p">
                We’ve seen how to use manually create a config object to get
                started with Knex, but the best practice is to use the following
                command:
              </p>
              <pre
                name="aa02"
                id="aa02"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">knex init</code></pre>
              <p name="c5c2" id="c5c2" class="graf graf--p graf-after--pre">
                Or, if Knex isn’t globally installed:
              </p>
              <pre
                name="f0a1"
                id="f0a1"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">npx knex init</code></pre>
              <p name="c360" id="c360" class="graf graf--p graf-after--pre">
                This command will generate a file in your root folder called
                <code class="markup--code markup--p-code">knexfile.js</code>. It
                will be auto populated with three config objects, based on
                different environments. We can delete all except for the
                development object.
              </p>
              <pre
                name="a54c"
                id="a54c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">module.exports = {</code></pre>
              <pre
                name="b610"
                id="b610"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  development: {<br>    client: &#39;sqlite3&#39;,<br>    connection: {<br>      filename: &#39;./dev.sqlite3&#39;<br>    }<br>  }</code></pre>
              <pre
                name="2b13"
                id="2b13"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">};</code></pre>
              <p name="9d6b" id="9d6b" class="graf graf--p graf-after--pre">
                We’ll need to update the location (or desired location) of the
                database as well as add the
                <code class="markup--code markup--p-code"
                  >useNullAsDefault</code
                >
                option. The latter option prevents crashes when working with
                <code class="markup--code markup--p-code">sqlite3</code>.
              </p>
              <pre
                name="e99c"
                id="e99c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">module.exports = {</code></pre>
              <pre
                name="516f"
                id="516f"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  development: {<br>    // our DBMS driver<br>    client: &#39;sqlite3&#39;,<br>    // the location of our db<br>    connection: {<br>      filename: &#39;./data/database_file.db3&#39;,<br>    },<br>    // necessary when using sqlite3<br>    useNullAsDefault: true<br>  }</code></pre>
              <pre
                name="c761"
                id="c761"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">};</code></pre>
              <p name="46bb" id="46bb" class="graf graf--p graf-after--pre">
                Now, wherever we configure our database, we may use the
                following syntax instead of hardcoding in a config object.
              </p>
              <pre
                name="9996"
                id="9996"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const knex = require(&#39;knex&#39;);</code></pre>
              <pre
                name="ae61"
                id="ae61"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const config = require(&#39;../knexfile.js&#39;);</code></pre>
              <pre
                name="6ecb"
                id="6ecb"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// we must select the development object from our knexfile<br>const db = knex(config.development);</code></pre>
              <pre
                name="762d"
                id="762d"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// export for use in codebase<br>module.exports = db;</code></pre>
              <h3 name="5f11" id="5f11" class="graf graf--h3 graf-after--pre">
                Knex Migrations
              </h3>
              <p name="bc71" id="bc71" class="graf graf--p graf-after--h3">
                Once our
                <code class="markup--code markup--p-code">knexfile</code> is set
                up, we can begin creating
                <strong class="markup--strong markup--p-strong"
                  >migrations</strong
                >. Though it&#39;s not required, we are going to add an
                <code class="markup--code markup--p-code">addition</code> option
                to the config object to specify a directory for the migration
                files.
              </p>
              <pre
                name="6d41"
                id="6d41"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">development: {<br>    client: &#39;sqlite3&#39;,<br>    connection: {<br>      filename: &#39;./data/produce.db3&#39;,<br>    },<br>    useNullAsDefault: true,<br>    // generates migration files in a data/migrations/ folder<br>    migrations: {<br>      directory: &#39;./data/migrations&#39;<br>    }<br>  }</code></pre>
              <p name="77b3" id="77b3" class="graf graf--p graf-after--pre">
                We can generate a new migration with the following command:
              </p>
              <p name="0ea6" id="0ea6" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:make [migration-name]</code
                >
              </p>
              <p name="59fd" id="59fd" class="graf graf--p graf-after--p">
                If we needed to create an accounts table, we might run:
              </p>
              <p name="4156" id="4156" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:make create-accounts</code
                >
              </p>
              <p name="2475" id="2475" class="graf graf--p graf-after--p">
                Note that inside
                <code class="markup--code markup--p-code"
                  >data/migrations/</code
                >
                a new file has appeared. Migrations have a timestamp in their
                filenames automatically. Wither you like this or not,
                <strong class="markup--strong markup--p-strong"
                  >do not edit migration names.</strong
                >
              </p>
              <p name="a03e" id="a03e" class="graf graf--p graf-after--p">
                The migration file should have both an
                <code class="markup--code markup--p-code">up</code> and a
                <code class="markup--code markup--p-code">down</code> function.
                Within the
                <code class="markup--code markup--p-code">up</code> function, we
                write the ended database changes. Within the
                <code class="markup--code markup--p-code">down</code> function,
                we write the code to undo the
                <code class="markup--code markup--p-code">up</code> functions.
                This allows us to undo any changes made to the schema if
                necessary.
              </p>
              <pre
                name="dc84"
                id="dc84"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">exports.up = function(knex, Promise) {<br>  // don&#39;t forget the return statement<br>  return knex.schema.createTable(&#39;accounts&#39;, tbl =&gt; {<br>    // creates a primary key called id<br>    tbl.increments();<br>    // creates a text field called name which is both required and unique<br>    tbl.text(&#39;name&#39;, 128).unique().notNullable();<br>    // creates a numeric field called budget which is required<br>    tbl.decimal(&#39;budget&#39;).notNullable();<br>  });<br>};</code></pre>
              <pre
                name="0656"
                id="0656"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">exports.down = function(knex, Promise) {<br>  // drops the entire table<br>  return knex.schema.dropTableIfExists(&#39;accounts&#39;);<br>};</code></pre>
              <p name="88f7" id="88f7" class="graf graf--p graf-after--pre">
                References for these methods are found in the
                <strong class="markup--strong markup--p-strong"
                  >schema builder</strong
                >
                section of the
                <a
                  href="https://knexjs.org/"
                  data-href="https://knexjs.org/"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Knex docs (Links to an external site.)</a
                >.
              </p>
              <p name="4502" id="4502" class="graf graf--p graf-after--p">
                At this point, the table is
                <strong class="markup--strong markup--p-strong">not</strong> yet
                created. To run this (and any other) migrations, use the
                command:
              </p>
              <p name="3643" id="3643" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:latest</code
                >
              </p>
              <p name="2d6c" id="2d6c" class="graf graf--p graf-after--p">
                Note if the database does not exist, this command will
                auto-generate one. We can use SQLite Studio to confirm that the
                accounts table has been created.
              </p>
              <h3 name="ba80" id="ba80" class="graf graf--h3 graf-after--p">
                Changes and Rollbacks
              </h3>
              <p name="fa06" id="fa06" class="graf graf--p graf-after--h3">
                If later down the road, we realize you need to update your
                schema, you shouldn’t edit the migration file. Instead, you will
                want to create a new migration with the command:
              </p>
              <p name="f6b3" id="f6b3" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:make accounts-schema-update</code
                >
              </p>
              <p name="4b1c" id="4b1c" class="graf graf--p graf-after--p">
                Once we’ve written our updates into this file we save and close
                with:
              </p>
              <p name="839e" id="839e" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:latest</code
                >
              </p>
              <p name="17ee" id="17ee" class="graf graf--p graf-after--p">
                If we migrate our database and then quickly realize something
                isn’t right, we can edit the migration file. However, first, we
                need to
                <strong class="markup--strong markup--p-strong"
                  >rolllback</strong
                >
                (or undo) our last migration with:
              </p>
              <p name="3a47" id="3a47" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:rollback</code
                >
              </p>
              <p name="67c2" id="67c2" class="graf graf--p graf-after--p">
                Finally, we are free to rerun that file with
                <code class="markup--code markup--p-code">knex migrate</code>
                latest.
              </p>
              <p name="7217" id="7217" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">NOTE</strong>: A
                rollback should not be used to edit an old migration file once
                that file has accepted into a main branch. However, an entire
                team may use a rollback to return to a previous version of a
                database.
              </p>
              <h3 name="858a" id="858a" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <p name="0f9e" id="0f9e" class="graf graf--p graf-after--h3">
                Knex provides a
                <strong class="markup--strong markup--p-strong"
                  >schema builder</strong
                >, which allows us to write code to design our database schema.
                However, beyond thinking about columns and constraints, we must
                also consider updates.
              </p>
              <p name="d481" id="d481" class="graf graf--p graf-after--p">
                When a schema needs to be updated, a developer must feel
                confident that the changes go into effect everywhere. This means
                schema updates on the developer’s local machine, on any testing
                or staging versions, on the production database, and then on any
                other developer’s local machines. This is where
                <strong class="markup--strong markup--p-strong"
                  >migrations</strong
                >
                come into play.
              </p>
              <p name="b42a" id="b42a" class="graf graf--p graf-after--p">
                A
                <code class="markup--code markup--p-code"
                  >database migration</code
                >
                describes changes made to the structure of a database.
                Migrations include things like adding new objects, adding new
                tables, and modifying existing objects or tables.
              </p>
              <h3
                name="a0fb"
                id="a0fb"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="e205"
                id="e205"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="1228"
                id="1228"
                class="graf graf--h3 graf-after--figure"
              >
                Knex Cli
              </h3>
              <p name="ee29" id="ee29" class="graf graf--p graf-after--h3">
                To use migrations (and to make Knex setup easier), we need to
                use
                <strong class="markup--strong markup--p-strong">knex cli</strong
                >. Install knex globally with
                <code class="markup--code markup--p-code"
                  >npm install -g knex</code
                >.
              </p>
              <p name="31d8" id="31d8" class="graf graf--p graf-after--p">
                This allows you to use Knex commands within any repo that has
                <code class="markup--code markup--p-code">knex</code> as a local
                dependency. If you have any issues with this global install, you
                can use the
                <code class="markup--code markup--p-code">npx knex</code>
                command instead.
              </p>
              <h3 name="ce3e" id="ce3e" class="graf graf--h3 graf-after--p">
                Initializing Knex
              </h3>
              <p name="b54a" id="b54a" class="graf graf--p graf-after--h3">
                To start, add the
                <code class="markup--code markup--p-code">knex</code> and
                <code class="markup--code markup--p-code">sqlite3</code>
                libraries to your repository.
              </p>
              <p name="5221" id="5221" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >npm install knex sqlite3</code
                >
              </p>
              <p name="07fe" id="07fe" class="graf graf--p graf-after--p">
                We’ve seen how to use manually create a config object to get
                started with Knex, but the best practice is to use the following
                command:
              </p>
              <pre
                name="c625"
                id="c625"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">knex init</code></pre>
              <p name="1d64" id="1d64" class="graf graf--p graf-after--pre">
                Or, if Knex isn’t globally installed:
              </p>
              <pre
                name="4f26"
                id="4f26"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">npx knex init</code></pre>
              <p name="342c" id="342c" class="graf graf--p graf-after--pre">
                This command will generate a file in your root folder called
                <code class="markup--code markup--p-code">knexfile.js</code>. It
                will be auto populated with three config objects, based on
                different environments. We can delete all except for the
                development object.
              </p>
              <pre
                name="6166"
                id="6166"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">module.exports = {</code></pre>
              <pre
                name="00b0"
                id="00b0"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  development: {<br>    client: &#39;sqlite3&#39;,<br>    connection: {<br>      filename: &#39;./dev.sqlite3&#39;<br>    }<br>  }</code></pre>
              <pre
                name="3b9a"
                id="3b9a"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">};</code></pre>
              <p name="1f45" id="1f45" class="graf graf--p graf-after--pre">
                We’ll need to update the location (or desired location) of the
                database as well as add the
                <code class="markup--code markup--p-code"
                  >useNullAsDefault</code
                >
                option. The latter option prevents crashes when working with
                <code class="markup--code markup--p-code">sqlite3</code>.
              </p>
              <pre
                name="ba51"
                id="ba51"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">module.exports = {</code></pre>
              <pre
                name="cf6b"
                id="cf6b"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  development: {<br>    // our DBMS driver<br>    client: &#39;sqlite3&#39;,<br>    // the location of our db<br>    connection: {<br>      filename: &#39;./data/database_file.db3&#39;,<br>    },<br>    // necessary when using sqlite3<br>    useNullAsDefault: true<br>  }</code></pre>
              <pre
                name="6c2a"
                id="6c2a"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">};</code></pre>
              <p name="caa8" id="caa8" class="graf graf--p graf-after--pre">
                Now, wherever we configure our database, we may use the
                following syntax instead of hardcoding in a config object.
              </p>
              <pre
                name="2cb4"
                id="2cb4"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const knex = require(&#39;knex&#39;);</code></pre>
              <pre
                name="6ba3"
                id="6ba3"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">const config = require(&#39;../knexfile.js&#39;);</code></pre>
              <pre
                name="3088"
                id="3088"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// we must select the development object from our knexfile<br>const db = knex(config.development);</code></pre>
              <pre
                name="39a5"
                id="39a5"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">// export for use in codebase<br>module.exports = db;</code></pre>
              <h3 name="1123" id="1123" class="graf graf--h3 graf-after--pre">
                Knex Migrations
              </h3>
              <p name="394f" id="394f" class="graf graf--p graf-after--h3">
                Once our
                <code class="markup--code markup--p-code">knexfile</code> is set
                up, we can begin creating
                <strong class="markup--strong markup--p-strong"
                  >migrations</strong
                >. Though it&#39;s not required, we are going to add an
                <code class="markup--code markup--p-code">addition</code> option
                to the config object to specify a directory for the migration
                files.
              </p>
              <pre
                name="1e0e"
                id="1e0e"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">development: {<br>    client: &#39;sqlite3&#39;,<br>    connection: {<br>      filename: &#39;./data/produce.db3&#39;,<br>    },<br>    useNullAsDefault: true,<br>    // generates migration files in a data/migrations/ folder<br>    migrations: {<br>      directory: &#39;./data/migrations&#39;<br>    }<br>  }</code></pre>
              <p name="dd7d" id="dd7d" class="graf graf--p graf-after--pre">
                We can generate a new migration with the following command:
              </p>
              <p name="5619" id="5619" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:make [migration-name]</code
                >
              </p>
              <p name="696d" id="696d" class="graf graf--p graf-after--p">
                If we needed to create an accounts table, we might run:
              </p>
              <p name="d346" id="d346" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:make create-accounts</code
                >
              </p>
              <p name="e2cc" id="e2cc" class="graf graf--p graf-after--p">
                Note that inside
                <code class="markup--code markup--p-code"
                  >data/migrations/</code
                >
                a new file has appeared. Migrations have a timestamp in their
                filenames automatically. Wither you like this or not,
                <strong class="markup--strong markup--p-strong"
                  >do not edit migration names.</strong
                >
              </p>
              <p name="1aa9" id="1aa9" class="graf graf--p graf-after--p">
                The migration file should have both an
                <code class="markup--code markup--p-code">up</code> and a
                <code class="markup--code markup--p-code">down</code> function.
                Within the
                <code class="markup--code markup--p-code">up</code> function, we
                write the ended database changes. Within the
                <code class="markup--code markup--p-code">down</code> function,
                we write the code to undo the
                <code class="markup--code markup--p-code">up</code> functions.
                This allows us to undo any changes made to the schema if
                necessary.
              </p>
              <pre
                name="ac93"
                id="ac93"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">exports.up = function(knex, Promise) {<br>  // don&#39;t forget the return statement<br>  return knex.schema.createTable(&#39;accounts&#39;, tbl =&gt; {<br>    // creates a primary key called id<br>    tbl.increments();<br>    // creates a text field called name which is both required and unique<br>    tbl.text(&#39;name&#39;, 128).unique().notNullable();<br>    // creates a numeric field called budget which is required<br>    tbl.decimal(&#39;budget&#39;).notNullable();<br>  });<br>};</code></pre>
              <pre
                name="8bff"
                id="8bff"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">exports.down = function(knex, Promise) {<br>  // drops the entire table<br>  return knex.schema.dropTableIfExists(&#39;accounts&#39;);<br>};</code></pre>
              <p name="509c" id="509c" class="graf graf--p graf-after--pre">
                References for these methods are found in the
                <strong class="markup--strong markup--p-strong"
                  >schema builder</strong
                >
                section of the
                <a
                  href="https://knexjs.org/"
                  data-href="https://knexjs.org/"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Knex docs (Links to an external site.)</a
                >.
              </p>
              <p name="b88e" id="b88e" class="graf graf--p graf-after--p">
                At this point, the table is
                <strong class="markup--strong markup--p-strong">not</strong> yet
                created. To run this (and any other) migrations, use the
                command:
              </p>
              <p name="1e50" id="1e50" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:latest</code
                >
              </p>
              <p name="1d18" id="1d18" class="graf graf--p graf-after--p">
                Note if the database does not exist, this command will
                auto-generate one. We can use SQLite Studio to confirm that the
                accounts table has been created.
              </p>
              <h3 name="299b" id="299b" class="graf graf--h3 graf-after--p">
                Changes and Rollbacks
              </h3>
              <p name="3c96" id="3c96" class="graf graf--p graf-after--h3">
                If later down the road, we realize you need to update your
                schema, you shouldn’t edit the migration file. Instead, you will
                want to create a new migration with the command:
              </p>
              <p name="8358" id="8358" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:make accounts-schema-update</code
                >
              </p>
              <p name="8b38" id="8b38" class="graf graf--p graf-after--p">
                Once we’ve written our updates into this file we save and close
                with:
              </p>
              <p name="af6d" id="af6d" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:latest</code
                >
              </p>
              <p name="53cb" id="53cb" class="graf graf--p graf-after--p">
                If we migrate our database and then quickly realize something
                isn’t right, we can edit the migration file. However, first, we
                need to
                <strong class="markup--strong markup--p-strong"
                  >rolllback</strong
                >
                (or undo) our last migration with:
              </p>
              <p name="f2e3" id="f2e3" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex migrate:rollback</code
                >
              </p>
              <p name="a496" id="a496" class="graf graf--p graf-after--p">
                Finally, we are free to rerun that file with
                <code class="markup--code markup--p-code">knex migrate</code>
                latest.
              </p>
              <p name="4cbe" id="4cbe" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">NOTE</strong>: A
                rollback should not be used to edit an old migration file once
                that file has accepted into a main branch. However, an entire
                team may use a rollback to return to a previous version of a
                database.
              </p>
              <h3 name="4922" id="4922" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <p name="c564" id="c564" class="graf graf--p graf-after--h3">
                Often we want to pre-populate our database with sample data for
                testing.
                <strong class="markup--strong markup--p-strong">Seeds</strong>
                allow us to add and reset sample data easily.
              </p>
              <h3 name="9e0b" id="9e0b" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="8f0d" id="8f0d" class="graf graf--p graf-after--h3">
                The Knex command-line tool offers a way to
                <strong class="markup--strong markup--p-strong">seed</strong>
                our database; in other words, pre-populate our tables.
              </p>
              <p name="1318" id="1318" class="graf graf--p graf-after--p">
                Similarly to migrations, we want to customize where our seed
                files are generated using our
                <code class="markup--code markup--p-code">knexfile</code>
              </p>
              <pre
                name="80c7"
                id="80c7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">development: {<br>    client: &#39;sqlite3&#39;,<br>    connection: {<br>      filename: &#39;./data/produce.db3&#39;,<br>    },<br>    useNullAsDefault: true,<br>    // generates migration files in a data/migrations/ folder<br>    migrations: {<br>      directory: &#39;./data/migrations&#39;<br>    },<br>    seeds: {<br>      directory: &#39;./data/seeds&#39;<br>    }<br>  }</code></pre>
              <p name="9519" id="9519" class="graf graf--p graf-after--pre">
                To create a seed run:
                <code class="markup--code markup--p-code"
                  >knex seed:make 001-seedName</code
                >
              </p>
              <p name="6431" id="6431" class="graf graf--p graf-after--p">
                Numbering is a good idea because Knex doesn’t attach a timestamp
                to the name like migrate does. Adding numbers to the file name,
                we can control the order in which they run.
              </p>
              <p name="1c4f" id="1c4f" class="graf graf--p graf-after--p">
                We want to create seeds for our accounts table:
              </p>
              <p name="d549" id="d549" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code"
                  >knex seed:make 001-accounts</code
                >
              </p>
              <p name="5bd2" id="5bd2" class="graf graf--p graf-after--p">
                A file will appear in the designated seed folder.
              </p>
              <pre
                name="acad"
                id="acad"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">exports.seed = function(knex, Promise) {<br>  // we want to remove all data before seeding<br>  // truncate will reset the primary key each time<br>  return knex(&#39;accounts&#39;).truncate()<br>    .then(function () {<br>      // add data into insert<br>      return knex(&#39;accounts&#39;).insert([<br>        { name: &#39;Stephenson&#39;, budget: 10000 },<br>        { name: &#39;Gordon &amp; Gale&#39;, budget: 40400 },<br>      ]);<br>    });<br>};</code></pre>
              <p name="57ed" id="57ed" class="graf graf--p graf-after--pre">
                Run the seed files by typing:
              </p>
              <p name="95db" id="95db" class="graf graf--p graf-after--p">
                <code class="markup--code markup--p-code">knex seed:run</code>
              </p>
              <p
                name="512d"
                id="512d"
                class="graf graf--p graf-after--p graf--trailing"
              >
                You can now use SQLite Studio to confirm that the accounts table
                has two entries.
              </p>
            </div>
          </div>
        </section>
        <section name="572b" class="section section--body">
          <div class="section-divider"><hr class="section-divider" /></div>
          <div class="section-content">
            <div class="section-inner sectionLayout--insetColumn">
              <h3
                name="4d58"
                id="4d58"
                class="graf graf--h3 graf--empty graf--leading"
              >
                <br />
              </h3>
              <figure
                name="c2eb"
                id="c2eb"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="ee41"
                id="ee41"
                class="graf graf--h3 graf-after--figure"
              >
                SQL &amp; PostgreSQL
              </h3>
              <p name="c1a4" id="c1a4" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong"
                  >Foreign keys</strong
                >
                are a type of table field used for creating links between
                tables. Like
                <strong class="markup--strong markup--p-strong"
                  >primary keys</strong
                >, they are most often integers that identify (rather than
                store) data. However, whereas a primary key is used to id rows
                in a table, foreign keys are used to connect a record in one
                table to a record in a second table.
              </p>
              <h3
                name="c6a0"
                id="c6a0"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <p name="9b9c" id="9b9c" class="graf graf--p graf-after--h3">
                Consider the following
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">ranchers</code>
                tables.
              </p>
              <p name="7dbf" id="7dbf" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/5b20c5e233dd4a70a33d6ab2c2e1c8bb"
                  data-href="https://www.notion.so/5b20c5e233dd4a70a33d6ab2c2e1c8bb"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="f1e3" id="f1e3" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/0b0a909c24a9474fb9df80938546f12a"
                  data-href="https://www.notion.so/0b0a909c24a9474fb9df80938546f12a"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="9808" id="9808" class="graf graf--p graf-after--p">
                The <code class="markup--code markup--p-code">farm_id</code> in
                the
                <code class="markup--code markup--p-code">ranchers</code> table
                is an example of a
                <code class="markup--code markup--p-code">foreign key</code>.
                Each entry in the
                <code class="markup--code markup--p-code">farm_id</code>
                (foreign key) column corresponds to an
                <code class="markup--code markup--p-code">id</code> (primary
                key) in the
                <code class="markup--code markup--p-code">farms</code> table.
                This allows us to track which farm each rancher belongs to while
                keeping the tables normalized.
              </p>
              <p name="d47a" id="d47a" class="graf graf--p graf-after--p">
                If we could only see the
                <code class="markup--code markup--p-code">ranchers</code> table,
                we would know that John, Jane, and Jen all work together and
                that Jim and Jay also work together. However, to know where any
                of them work, we would need to look at the
                <code class="markup--code markup--p-code">farms</code> table.
              </p>
              <p name="5d84" id="5d84" class="graf graf--p graf-after--p">
                Now that we understand the basics of querying data from a single
                table, let’s move on to selecting data from multiple tables
                using JOIN operations.
              </p>
              <h3 name="9ec5" id="9ec5" class="graf graf--h3 graf-after--p">
                Overview
              </h3>
              <p name="e9a9" id="e9a9" class="graf graf--p graf-after--h3">
                We can use a
                <code class="markup--code markup--p-code">JOIN</code> to combine
                query data from multiple tables using a single
                <code class="markup--code markup--p-code">SELECT</code>
                statement.
              </p>
              <p name="29a1" id="29a1" class="graf graf--p graf-after--p">
                There are different types of joins; some are listed below:
              </p>
              <ul class="postList">
                <li name="d886" id="d886" class="graf graf--li graf-after--p">
                  inner joins.
                </li>
                <li name="43f5" id="43f5" class="graf graf--li graf-after--li">
                  outer joins.
                </li>
                <li name="882e" id="882e" class="graf graf--li graf-after--li">
                  left joins.
                </li>
                <li name="ad86" id="ad86" class="graf graf--li graf-after--li">
                  right joins.
                </li>
                <li name="4d8b" id="4d8b" class="graf graf--li graf-after--li">
                  cross joins.
                </li>
                <li name="eb21" id="eb21" class="graf graf--li graf-after--li">
                  non-equality joins.
                </li>
                <li name="fc6a" id="fc6a" class="graf graf--li graf-after--li">
                  self joins.
                </li>
              </ul>
              <p name="2e12" id="2e12" class="graf graf--p graf-after--li">
                Using
                <code class="markup--code markup--p-code">joins</code> requires
                that the two tables of interest contain at least one field with
                shared information. For example, if a
                <em class="markup--em markup--p-em">departments</em> table has
                an <em class="markup--em markup--p-em">id</em> field, and an
                employee table has a
                <em class="markup--em markup--p-em">department_id</em> field,
                and the values that exist in the
                <em class="markup--em markup--p-em">id</em> column of the
                <em class="markup--em markup--p-em">departments</em> table live
                in the
                <em class="markup--em markup--p-em">department_id</em> field of
                the employee table, we can use those fields to join both tables
                like so:
              </p>
              <pre
                name="6cca"
                id="6cca"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select * from employees<br>join departments on employees.department_id = departments.id</code></pre>
              <p name="0230" id="0230" class="graf graf--p graf-after--pre">
                This query will return the data from both tables for every
                instance where the
                <code class="markup--code markup--p-code">ON</code> condition is
                true. If there are employees with no value for department<em
                  class="markup--em markup--p-em"
                  >id or where the value stored in the field does not correspond
                  to an existing id in the</em
                >
                departments
                <em class="markup--em markup--p-em"
                  >table, then that record will NOT be returned. In a similar
                  fashion, any records from the</em
                >
                departments
                <em class="markup--em markup--p-em"
                  >table that don&#39;t have an employee associated with them
                  will also be omitted from the results. Basically, if the</em
                >
                id* does not show as the value of department_id for an employee,
                it won&#39;t be able to join.
              </p>
              <p name="588e" id="588e" class="graf graf--p graf-after--p">
                We can shorten the condition by giving the table names an alias.
                This is a common practice. Below is the same example using
                aliases, picking which fields to return and sorting the results:
              </p>
              <pre
                name="5cac"
                id="5cac"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">select d.id, d.name, e.id, e.first_name, e.last_name, e.salary<br>from employees as e<br>join departments as d<br>  on e.department_id = d.id<br>order by d.name, e.last_name</code></pre>
              <p name="481f" id="481f" class="graf graf--p graf-after--pre">
                Notice that we can take advantage of white space and indentation
                to make queries more readable.
              </p>
              <p name="c4fd" id="c4fd" class="graf graf--p graf-after--p">
                There are several ways of writing joins, but the one shown here
                should work on all database management systems and avoid some
                pitfalls, so we recommend it.
              </p>
              <p name="5f7c" id="5f7c" class="graf graf--p graf-after--p">
                The syntax for performing a similar join using Knex is as
                follows:
              </p>
              <pre
                name="8c6e"
                id="8c6e"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">db(&#39;employees as e&#39;)<br>  .join(&#39;departments as d&#39;, &#39;e.department_id&#39;, &#39;d.id&#39;)<br>  .select(&#39;d.id&#39;, &#39;d.name&#39;, &#39;e.first_name&#39;, &#39;e.last_name&#39;, &#39;e.salary&#39;)</code></pre>
              <h3 name="4b3a" id="4b3a" class="graf graf--h3 graf-after--pre">
                Follow Along
              </h3>
              <p name="9ad6" id="9ad6" class="graf graf--p graf-after--h3">
                A good explanation of how the different types of joins can be
                seen
                <a
                  href="https://www.w3resource.com/sql/joins/sql-joins.php"
                  data-href="https://www.w3resource.com/sql/joins/sql-joins.php"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >in this article from w3resource.com (Links to an external
                  site.)</a
                >.
              </p>
              <h3 name="c6a2" id="c6a2" class="graf graf--h3 graf-after--p">
                What is SQL Joins?
              </h3>
              <p name="428e" id="428e" class="graf graf--p graf-after--h3">
                An SQL JOIN clause combines rows from two or more tables. It
                creates a set of rows in a temporary table.
              </p>
              <h3 name="6ab6" id="6ab6" class="graf graf--h3 graf-after--p">
                How to Join two tables in SQL?
              </h3>
              <p name="af0d" id="af0d" class="graf graf--p graf-after--h3">
                A JOIN works on two or more tables if they have at least one
                common field and have a relationship between them.
              </p>
              <p name="b95d" id="b95d" class="graf graf--p graf-after--p">
                JOIN keeps the base tables (structure and data) unchanged.
              </p>
              <h3 name="66b8" id="66b8" class="graf graf--h3 graf-after--p">
                Join vs. Subquery
              </h3>
              <ul class="postList">
                <li name="6fdc" id="6fdc" class="graf graf--li graf-after--h3">
                  JOINs are faster than a subquery and it is very rare that the
                  opposite.
                </li>
                <li name="c648" id="c648" class="graf graf--li graf-after--li">
                  In JOINs the RDBMS calculates an execution plan, that can
                  predict, what data should be loaded and how much it will take
                  to processed and as a result this process save some times,
                  unlike the subquery there is no pre-process calculation and
                  run all the queries and load all their data to do the
                  processing.
                </li>
                <li name="d59c" id="d59c" class="graf graf--li graf-after--li">
                  A JOIN is checked conditions first and then put it into table
                  and displays; where as a subquery take separate temp table
                  internally and checking condition.
                </li>
                <li name="08ff" id="08ff" class="graf graf--li graf-after--li">
                  When joins are using, there should be connection between two
                  or more than two tables and each table has a relation with
                  other while subquery means query inside another query, has no
                  need to relation, it works on columns and conditions.
                </li>
              </ul>
              <h3 name="0f78" id="0f78" class="graf graf--h3 graf-after--li">
                SQL JOINS: EQUI JOIN and NON EQUI JOIN
              </h3>
              <p name="c494" id="c494" class="graf graf--p graf-after--h3">
                The are two types of SQL JOINS — EQUI JOIN and NON EQUI JOIN
              </p>
              <ol class="postList">
                <li name="2bb1" id="2bb1" class="graf graf--li graf-after--p">
                  SQL EQUI JOIN :
                </li>
              </ol>
              <p name="f074" id="f074" class="graf graf--p graf-after--li">
                The SQL EQUI JOIN is a simple SQL join uses the equal sign(=) as
                the comparison operator for the condition. It has two
                types — SQL Outer join and SQL Inner join.
              </p>
              <ol class="postList">
                <li name="a9be" id="a9be" class="graf graf--li graf-after--p">
                  SQL NON EQUI JOIN :
                </li>
              </ol>
              <p name="4a19" id="4a19" class="graf graf--p graf-after--li">
                The
                <strong class="markup--strong markup--p-strong"
                  >SQL NON EQUI JOIN</strong
                >
                is a join uses comparison operator other than the equal sign
                like &gt;, &lt;, &gt;=, &lt;= with the condition.
              </p>
              <p name="dfe9" id="dfe9" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >SQL EQUI JOIN : INNER JOIN and OUTER JOIN</strong
                >
              </p>
              <p name="f0ba" id="f0ba" class="graf graf--p graf-after--p">
                The SQL EQUI JOIN can be classified into two types — INNER JOIN
                and OUTER JOIN
              </p>
              <ol class="postList">
                <li name="cf44" id="cf44" class="graf graf--li graf-after--p">
                  SQL INNER JOIN
                </li>
              </ol>
              <p name="4c05" id="4c05" class="graf graf--p graf-after--li">
                This type of EQUI JOIN returns all rows from tables where the
                key record of one table is equal to the key records of another
                table.
              </p>
              <ol class="postList">
                <li name="22a6" id="22a6" class="graf graf--li graf-after--p">
                  SQL OUTER JOIN
                </li>
              </ol>
              <p name="0402" id="0402" class="graf graf--p graf-after--li">
                This type of EQUI JOIN returns all rows from one table and only
                those rows from the secondary table where the joined condition
                is satisfying i.e. the columns are equal in both tables.
              </p>
              <p name="9f91" id="9f91" class="graf graf--p graf-after--p">
                In order to perform a JOIN query, the required information we
                need are:
              </p>
              <p name="056c" id="056c" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">a)</strong> The
                name of the tables<strong
                  class="markup--strong markup--p-strong"
                  >b)</strong
                >
                Name of the columns of two or more tables, based on which a
                condition will perform.
              </p>
              <p name="64e8" id="64e8" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong">Syntax:</strong>
              </p>
              <pre
                name="1350"
                id="1350"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">FROM table1<br>join_type table2<br>[ON (join_condition)]</code></pre>
              <p name="8bfd" id="8bfd" class="graf graf--p graf-after--pre">
                <strong class="markup--strong markup--p-strong"
                  >Parameters:</strong
                >
              </p>
              <p name="32c9" id="32c9" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/5522c3e6d5d0443eb870f7a34f60c7ff"
                  data-href="https://www.notion.so/5522c3e6d5d0443eb870f7a34f60c7ff"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="8ad8" id="8ad8" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >Pictorial Presentation of SQL Joins:</strong
                >
              </p>
              <figure
                name="298c"
                id="298c"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="0*2DcsnJXF_FOGhUtL.gif"
                  data-width="525"
                  data-height="694"
                  src="https://cdn-images-1.medium.com/max/800/0*2DcsnJXF_FOGhUtL.gif"
                />
              </figure>
              <p name="bdec" id="bdec" class="graf graf--p graf-after--figure">
                <strong class="markup--strong markup--p-strong"
                  >Example:</strong
                >
              </p>
              <p name="cee0" id="cee0" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >Sample table: company</strong
                >
              </p>
              <p name="16ab" id="16ab" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >Sample table: foods</strong
                >
              </p>
              <p name="a48d" id="a48d" class="graf graf--p graf-after--p">
                To join two tables ‘company’ and ‘foods’, the following SQL
                statement can be used :
              </p>
              <p name="47db" id="47db" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >SQL Code:</strong
                >
              </p>
              <pre
                name="f361"
                id="f361"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">SELECT  company.company_id,company.company_name,<br>foods.item_id,foods.item_name<br>FROM company,foods;</code></pre>
              <p name="6935" id="6935" class="graf graf--p graf-after--pre">
                Copy
              </p>
              <p name="b054" id="b054" class="graf graf--p graf-after--p">
                Output:
              </p>
              <pre
                name="a2fd"
                id="a2fd"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">COMPAN COMPANY_NAME              ITEM_ID  ITEM_NAME<br>------ ------------------------- -------- ---------------<br>18     Order All                 1        Chex Mix<br>18     Order All                 6        Cheez-It<br>18     Order All                 2        BN Biscuit<br>18     Order All                 3        Mighty Munch<br>18     Order All                 4        Pot Rice<br>18     Order All                 5        Jaffa Cakes<br>18     Order All                 7        Salt n Shake<br>15     Jack Hill Ltd             1        Chex Mix<br>15     Jack Hill Ltd             6        Cheez-It<br>15     Jack Hill Ltd             2        BN Biscuit<br>15     Jack Hill Ltd             3        Mighty Munch<br>15     Jack Hill Ltd             4        Pot Rice<br>15     Jack Hill Ltd             5        Jaffa Cakes<br>15     Jack Hill Ltd             7        Salt n Shake<br>16     Akas Foods                1        Chex Mix<br>16     Akas Foods                6        Cheez-It<br>16     Akas Foods                2        BN Biscuit<br>16     Akas Foods                3        Mighty Munch<br>16     Akas Foods                4        Pot Rice<br>16     Akas Foods                5        Jaffa Cakes<br>16     Akas Foods                7        Salt n Shake<br>.........<br>.........<br>.........</code></pre>
              <h3 name="65ee" id="65ee" class="graf graf--h3 graf-after--pre">
                Overview
              </h3>
              <p name="37d0" id="37d0" class="graf graf--p graf-after--h3">
                While we can write database code directly into our endpoints,
                best practices dictate that all database logic exists in
                separate, modular methods. These files containing database
                access helpers are often called
                <strong class="markup--strong markup--p-strong">models</strong>
              </p>
              <h3 name="d2b3" id="d2b3" class="graf graf--h3 graf-after--p">
                Follow Along
              </h3>
              <p name="6abc" id="6abc" class="graf graf--p graf-after--h3">
                To handle CRUD operations for a single resource, we would want
                to create a
                <strong class="markup--strong markup--p-strong">model</strong>
                (or database access file) containing the following methods:
              </p>
              <pre
                name="0cb2"
                id="0cb2"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function find() {<br>}</code></pre>
              <pre
                name="9ab9"
                id="9ab9"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function findById(id) {<br>}</code></pre>
              <pre
                name="e17d"
                id="e17d"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function add(user) {<br>}</code></pre>
              <pre
                name="b60c"
                id="b60c"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function update(changes, id) {<br>}</code></pre>
              <pre
                name="02ef"
                id="02ef"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">function remove(id) {<br>}</code></pre>
              <p name="e604" id="e604" class="graf graf--p graf-after--pre">
                Each of these functions would use Knex logic to perform the
                necessary database operation.
              </p>
              <pre
                name="2424"
                id="2424"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function find() {<br>  return db(&#39;users&#39;);<br>}</code></pre>
              <p name="a54f" id="a54f" class="graf graf--p graf-after--pre">
                For each method, we can choose what value to return. For
                example, we may prefer
                <code class="markup--code markup--p-code">findById()</code> to
                return a single
                <code class="markup--code markup--p-code">user</code> object
                rather than an array.
              </p>
              <pre
                name="b7b6"
                id="b7b6"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function findById(id) {<br>// first() returns the first entry in the db matching the query<br>  return db(&#39;users&#39;).where({ id }).first();<br>}</code></pre>
              <p name="3cf0" id="3cf0" class="graf graf--p graf-after--pre">
                We can also use existing methods like
                <code class="markup--code markup--p-code">findById()</code> to
                help
                <code class="markup--code markup--p-code">add()</code> return
                the new user (instead of just the id).
              </p>
              <pre
                name="fa22"
                id="fa22"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">function add(user) {<br>  db(&#39;users&#39;).insert(user)<br>    .then(ids =&gt; {<br>      return findById(ids[0]);<br>    });<br>}</code></pre>
              <p name="2dcf" id="2dcf" class="graf graf--p graf-after--pre">
                Once all methods are written as desired, we can export them like
                so:
              </p>
              <pre
                name="59c0"
                id="59c0"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">module.exports = {<br>  find,<br>  findById,<br>  add,<br>  update,<br>  delete,<br>}</code></pre>
              <p name="94ba" id="94ba" class="graf graf--p graf-after--pre">
                …and use the helpers in our endpoints
              </p>
              <pre
                name="cc7b"
                id="cc7b"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const User = require(&#39;./user-model.js&#39;);</code></pre>
              <pre
                name="22a7"
                id="22a7"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">router.get(&#39;/&#39;, (req, res) =&gt; {<br>  User.find()<br>    .then(users =&gt; {<br>      res.json(users);<br>    })<br>    .catch(&amp;nbsp;err =&gt; {});<br>});</code></pre>
              <p
                name="1163"
                id="1163"
                class="graf graf--p graf-after--pre graf--trailing"
              >
                There should no be
                <code class="markup--code markup--p-code">knex</code> code in
                the endpoints themselves.
              </p>
            </div>
          </div>
        </section>
        <section name="4f66" class="section section--body section--last">
          <div class="section-divider"><hr class="section-divider" /></div>
          <div class="section-content">
            <div class="section-inner sectionLayout--insetColumn">
              <h3
                name="b197"
                id="b197"
                class="graf graf--h3 graf--empty graf--leading"
              >
                <br />
              </h3>
              <figure
                name="3fe9"
                id="3fe9"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <h3
                name="1c3b"
                id="1c3b"
                class="graf graf--h3 graf--empty graf-after--figure"
              >
                <br />
              </h3>
              <p name="4441" id="4441" class="graf graf--p graf-after--h3">
                <code class="markup--code markup--p-code">Normalization</code>
                is the process of designing or refactoring database tables for
                maximum consistency and minimum redundancy.
              </p>
              <p name="7869" id="7869" class="graf graf--p graf-after--p">
                With objects, we’re used to
                <em class="markup--em markup--p-em">denormalized</em> data,
                stored with ease of use and speed in mind. Non-normalized tables
                are considered ineffective in relational databases.
              </p>
              <h3
                name="0b6f"
                id="0b6f"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <p name="77da" id="77da" class="graf graf--p graf-after--h3">
                <strong class="markup--strong markup--p-strong"
                  >Data normalization</strong
                >
                is a deep topic in database design. To begin thinking about it,
                we’ll explore a few basic guidelines and some data examples that
                violate these rules.
              </p>
              <h3 name="8a3c" id="8a3c" class="graf graf--h3 graf-after--p">
                Normalization Guidelines
              </h3>
              <blockquote
                name="2a83"
                id="2a83"
                class="graf graf--pullquote graf-after--h3"
              >
                Each record has a primary key.
              </blockquote>
              <blockquote
                name="0f7d"
                id="0f7d"
                class="graf graf--pullquote graf-after--pullquote"
              >
                No fields are repeated.
              </blockquote>
              <blockquote
                name="270e"
                id="270e"
                class="graf graf--pullquote graf-after--pullquote"
              >
                All fields relate directly to the key data.
              </blockquote>
              <blockquote
                name="321c"
                id="321c"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Each field entry contains a single data point.
              </blockquote>
              <blockquote
                name="0eb7"
                id="0eb7"
                class="graf graf--pullquote graf-after--pullquote"
              >
                There are no redundant entries.
              </blockquote>
              <h3
                name="3959"
                id="3959"
                class="graf graf--h3 graf-after--pullquote"
              >
                Denormalized Data
              </h3>
              <p name="13c0" id="13c0" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.notion.so/19a01f68a659470fb85bbe6906fb4bad"
                  data-href="https://www.notion.so/19a01f68a659470fb85bbe6906fb4bad"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="4432" id="4432" class="graf graf--p graf-after--p">
                This table has two issues. There is no proper id field (as
                multiple farms may have the same name), and multiple fields are
                representing the same type of data: animals.
              </p>
              <p name="740e" id="740e" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/075ad6dd99ac48698625d7b56ca67bef"
                  data-href="https://www.notion.so/075ad6dd99ac48698625d7b56ca67bef"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="219f" id="219f" class="graf graf--p graf-after--p">
                While we have now eliminated the first two issues, we now have
                multiple entries in one field, separated by commas. This isn’t
                good either, as its another example of denormalization. There is
                no “array” data type in a relational database, so each field
                must contain only one data point.
              </p>
              <p name="e19c" id="e19c" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/375a15b0cb3f444a8698cd6cb3a08fe0"
                  data-href="https://www.notion.so/375a15b0cb3f444a8698cd6cb3a08fe0"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="fc2c" id="fc2c" class="graf graf--p graf-after--p">
                Now we’ve solved the multiple fields issue, but we created
                repeating data (the farm field), which is also an example of
                denormalization. As well, we can see that if we were tracking
                additional ranch information (such as annual revenue), that
                field is only vaguely related to the animal information.
              </p>
              <p name="17d8" id="17d8" class="graf graf--p graf-after--p">
                <strong class="markup--strong markup--p-strong"
                  >When these issues begin arising in your schema design, it
                  means that you should separate information into two or more
                  tables.</strong
                >
              </p>
              <h3 name="75dd" id="75dd" class="graf graf--h3 graf-after--p">
                Anomalies
              </h3>
              <p name="cd22" id="cd22" class="graf graf--p graf-after--h3">
                Obeying the above guidelines prevent
                <strong class="markup--strong markup--p-strong"
                  >anomalies</strong
                >
                in your database when inserting, updating, or deleting. For
                example, imagine if the revenue of Beech Ranch changed. With our
                denormalized schema, it may get updated in some records but not
                others:
              </p>
              <p name="81db" id="81db" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/e05f5b2e8ff141798adc6f188f56f31e"
                  data-href="https://www.notion.so/e05f5b2e8ff141798adc6f188f56f31e"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="7a10" id="7a10" class="graf graf--p graf-after--p">
                Similarly, if Beech Ranch shut down, there would be three (if
                not more) records that needed to be deleted to remove a single
                farm.
              </p>
              <p name="55e2" id="55e2" class="graf graf--p graf-after--p">
                Thus a denormalized table opens the door for contradictory,
                confusing, and unusable data.
              </p>
              <h3
                name="8ab8"
                id="8ab8"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <p name="80f7" id="80f7" class="graf graf--p graf-after--h3">
                What issues does the following table have?
              </p>
              <p name="6d1a" id="6d1a" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/2793e8f6b70a47f48f9208779366e69e"
                  data-href="https://www.notion.so/2793e8f6b70a47f48f9208779366e69e"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <h3
                name="066c"
                id="066c"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <p name="bdae" id="bdae" class="graf graf--p graf-after--h3">
                There are three types of relationships:
              </p>
              <blockquote
                name="6cb7"
                id="6cb7"
                class="graf graf--pullquote graf-after--p"
              >
                One to one.
              </blockquote>
              <blockquote
                name="78fd"
                id="78fd"
                class="graf graf--pullquote graf-after--pullquote"
              >
                One to many.
              </blockquote>
              <blockquote
                name="f7b5"
                id="f7b5"
                class="graf graf--pullquote graf-after--pullquote"
              >
                Many to many.
              </blockquote>
              <p
                name="43a4"
                id="43a4"
                class="graf graf--p graf-after--pullquote"
              >
                Determining how data is related can provide a set of guidelines
                for table representation and guides the use of foreign keys to
                connect said tables.
              </p>
              <h3
                name="746c"
                id="746c"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <h3 name="76dc" id="76dc" class="graf graf--h3 graf-after--h3">
                One to One Relationships
              </h3>
              <p name="fcb4" id="fcb4" class="graf graf--p graf-after--h3">
                Imagine we are storing the financial projections for a series of
                farms.
              </p>
              <p name="eb12" id="eb12" class="graf graf--p graf-after--p">
                We may wish to attach fields like farm name, address,
                description, projected revenue, and projected expenses. We could
                divide these fields into two categories: information related to
                the farm directly (name, address, description) and information
                related to the financial projections (revenue, expenses).
              </p>
              <p name="b13e" id="b13e" class="graf graf--p graf-after--p">
                We would say that
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">projections</code>
                have a
                <strong class="markup--strong markup--p-strong"
                  >one-to-one</strong
                >
                relationship. This is to say that every farm has exactly one
                projection, and every project corresponds to exactly one farm.
              </p>
              <p name="41dc" id="41dc" class="graf graf--p graf-after--p">
                This data can be represented in two tables:
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">projections</code>
              </p>
              <p name="0397" id="0397" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/944e594f3464473ea06383bfdea13265"
                  data-href="https://www.notion.so/944e594f3464473ea06383bfdea13265"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="3deb" id="3deb" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/de32fcf6760e45f284707274433fee92"
                  data-href="https://www.notion.so/de32fcf6760e45f284707274433fee92"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="ab19" id="ab19" class="graf graf--p graf-after--p">
                The <code class="markup--code markup--p-code">farm_id</code> is
                the foreign key that links
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">projections</code>
                together.
              </p>
              <p name="3790" id="3790" class="graf graf--p graf-after--p">
                Notes about one-to-one relationships:
              </p>
              <ul class="postList">
                <li name="198d" id="198d" class="graf graf--li graf-after--p">
                  The foreign key should always have a
                  <code class="markup--code markup--li-code">unique</code>
                  constraint to prevent duplicate entries. In the example above,
                  we wouldn&#39;t want to allow multiple projections records for
                  one farm.
                </li>
                <li name="25c6" id="25c6" class="graf graf--li graf-after--li">
                  The foreign key can be in either table. For example, we may
                  have had a
                  <code class="markup--code markup--li-code"
                    >projection_id</code
                  >
                  in the
                  <code class="markup--code markup--li-code">farms</code> table
                  instead. A good rule of thumb is to put the foreign key in
                  whichever table is more auxiliary to the other.
                </li>
                <li name="960d" id="960d" class="graf graf--li graf-after--li">
                  You can represent one-to-one data in a single table
                  <em class="markup--em markup--li-em">without</em> creating
                  anomalies. However, it is sometimes prudent to use two tables
                  as shown above to keep separate concerns in separate tables.
                </li>
              </ul>
              <h3 name="53e1" id="53e1" class="graf graf--h3 graf-after--li">
                One to Many Relationships
              </h3>
              <p name="2556" id="2556" class="graf graf--p graf-after--h3">
                Now imagine, we are storing the full-time ranchers employed at
                each farm. In this case, each rancher would only work at one
                farm however, each farm may have multiple ranchers.
              </p>
              <p name="796d" id="796d" class="graf graf--p graf-after--p">
                This is called a
                <strong class="markup--strong markup--p-strong"
                  >one-to-many</strong
                >
                relationship.
              </p>
              <p name="831e" id="831e" class="graf graf--p graf-after--p">
                This is the most common type of relationship between entities.
                Some other examples:
              </p>
              <ul class="postList">
                <li name="5627" id="5627" class="graf graf--li graf-after--p">
                  One
                  <code class="markup--code markup--li-code">customer</code> can
                  have many
                  <code class="markup--code markup--li-code">orders</code>.
                </li>
                <li name="cc42" id="cc42" class="graf graf--li graf-after--li">
                  One <code class="markup--code markup--li-code">user</code> can
                  have many
                  <code class="markup--code markup--li-code">posts</code>.
                </li>
                <li name="dae3" id="dae3" class="graf graf--li graf-after--li">
                  One <code class="markup--code markup--li-code">post</code> can
                  have many
                  <code class="markup--code markup--li-code">comments</code>.
                </li>
              </ul>
              <p name="10c7" id="10c7" class="graf graf--p graf-after--li">
                Manage this type of relationship by adding a foreign key on the
                “many” table of the relationship that points to the primary key
                on the “one” table. Consider the
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">ranchers</code>
                tables.
              </p>
              <p name="cca1" id="cca1" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/7dfd2e69c9804a01845f2e9b716a5ac2"
                  data-href="https://www.notion.so/7dfd2e69c9804a01845f2e9b716a5ac2"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="ead4" id="ead4" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/c95f3d418db94ab4b4532eeba0e4f918"
                  data-href="https://www.notion.so/c95f3d418db94ab4b4532eeba0e4f918"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="a50d" id="a50d" class="graf graf--p graf-after--p">
                In a many-to-many relationship, the foreign key (in this case
                <code class="markup--code markup--p-code">farm_id</code>) should
                <em class="markup--em markup--p-em">not</em> be unique.
              </p>
              <h3 name="9aa4" id="9aa4" class="graf graf--h3 graf-after--p">
                Many to Many Relationships
              </h3>
              <p name="9ca7" id="9ca7" class="graf graf--p graf-after--h3">
                If we want to track animals on a farm as well, we must explore
                the
                <strong class="markup--strong markup--p-strong"
                  >many-to-many</strong
                >
                relationship. A farm has multiple animals, and multiple of each
                type of animal is present at multiple different farms.
              </p>
              <p name="3fac" id="3fac" class="graf graf--p graf-after--p">
                Some other examples:
              </p>
              <ul class="postList">
                <li name="d757" id="d757" class="graf graf--li graf-after--p">
                  an <code class="markup--code markup--li-code">order</code> can
                  have many
                  <code class="markup--code markup--li-code">products</code> and
                  the same
                  <code class="markup--code markup--li-code">product</code> will
                  appear in many
                  <code class="markup--code markup--li-code">orders</code>.
                </li>
                <li name="0256" id="0256" class="graf graf--li graf-after--li">
                  a <code class="markup--code markup--li-code">book</code> can
                  have more than one
                  <code class="markup--code markup--li-code">author</code>, and
                  an
                  <code class="markup--code markup--li-code">author</code> can
                  write more than one
                  <code class="markup--code markup--li-code">book</code>.
                </li>
              </ul>
              <p name="6c79" id="6c79" class="graf graf--p graf-after--li">
                To model this relationship, we need to introduce an
                <strong class="markup--strong markup--p-strong"
                  >intermediary table</strong
                >
                that holds foreign keys that reference the primary key on the
                related tables. We now have a
                <code class="markup--code markup--p-code">farms</code>,
                <code class="markup--code markup--p-code">animals</code>, and
                <code class="markup--code markup--p-code">farm_animals</code>
                table.
              </p>
              <p name="557f" id="557f" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/3269812d7c2a4578b1a9f6bc27e485b1"
                  data-href="https://www.notion.so/3269812d7c2a4578b1a9f6bc27e485b1"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="076e" id="076e" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/c2642c7f632f489cb1b9639c80b8400d"
                  data-href="https://www.notion.so/c2642c7f632f489cb1b9639c80b8400d"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="d04b" id="d04b" class="graf graf--p graf-after--p">
                <a
                  href="https://www.notion.so/d0b0042c5e104edd9ed55e122af89084"
                  data-href="https://www.notion.so/d0b0042c5e104edd9ed55e122af89084"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Untitled</a
                >
              </p>
              <p name="f088" id="f088" class="graf graf--p graf-after--p">
                While each foreign key on the intermediary table is not unique,
                the combinations of keys should be unique.
              </p>
              <h3
                name="d019"
                id="d019"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <figure
                name="af05"
                id="af05"
                class="graf graf--figure graf-after--h3"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p name="4fe6" id="4fe6" class="graf graf--p graf-after--figure">
                The Knex query builder library also allows us to create
                multi-table schemas include foreign keys. However, there are a
                few extra things to keep in mind when designing a multi-table
                schema, such as using the correct order when creating tables,
                dropping tables, seeding data, and removing data.
              </p>
              <p name="24fd" id="24fd" class="graf graf--p graf-after--p">
                We have to consider the way that
                <code class="markup--code markup--p-code">delete</code> and
                <code class="markup--code markup--p-code">updates</code> through
                our API will impact related data.
              </p>
              <h3
                name="3bf4"
                id="3bf4"
                class="graf graf--h3 graf--empty graf-after--p"
              >
                <br />
              </h3>
              <h3 name="7ff9" id="7ff9" class="graf graf--h3 graf-after--h3">
                Foreign Key Setup
              </h3>
              <p name="bf55" id="bf55" class="graf graf--p graf-after--h3">
                In Knex, foreign key restrictions don’t automatically work.
                Whenever using foreign keys in your schema, add the following
                code to your
                <code class="markup--code markup--p-code">knexfile</code>. This
                will prevent users from entering bad data into a foreign key
                column.
              </p>
              <pre
                name="dcd3"
                id="dcd3"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">development: {<br>  client: &#39;sqlite3&#39;,<br>  useNullAsDefault: true,<br>  connection: {<br>    filename: &#39;./data/database.db3&#39;,<br>  },<br>  // needed when using foreign keys<br>  pool: {<br>    afterCreate: (conn, done) =&gt; {<br>      // runs after a connection is made to the sqlite engine<br>      conn.run(&#39;PRAGMA foreign_keys = ON&#39;, done); // turn on FK enforcement<br>    },<br>  },<br>},</code></pre>
              <h3 name="ccb5" id="ccb5" class="graf graf--h3 graf-after--pre">
                Migrations
              </h3>
              <p name="5729" id="5729" class="graf graf--p graf-after--h3">
                Let’s look at how we might track our
                <code class="markup--code markup--p-code">farms</code> and
                <code class="markup--code markup--p-code">ranchers</code> using
                Knex. In our migration file&#39;s
                <code class="markup--code markup--p-code">up</code> function, we
                would want to create two tables:
              </p>
              <pre
                name="20cc"
                id="20cc"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">exports.up = function(knex, Promise) {<br>  return knex.schema<br>    .createTable(&#39;farms&#39;, tbl =&gt; {<br>      tbl.increments();<br>      tbl.string(&#39;farm_name&#39;, 128)<br>        .notNullable();<br>    })<br>    // we can chain together createTable<br>    .createTable(&#39;ranchers&#39;, tbl =&gt; {<br>      tbl.increments();<br>      tbl.string(&#39;rancher_name&#39;, 128);<br>      tbl.integer(&#39;farm_id&#39;)<br>        // forces integer to be positive<br>        .unsigned()<br>        .notNullable()<br>        .references(&#39;id&#39;)<br>        // this table must exist already<br>        .inTable(&#39;farms&#39;)<br>    })<br>};</code></pre>
              <p name="47c0" id="47c0" class="graf graf--p graf-after--pre">
                Note that the foreign key can only be created
                <em class="markup--em markup--p-em">after</em> the reference
                table.
              </p>
              <p name="b94e" id="b94e" class="graf graf--p graf-after--p">
                In the down function, the opposite is true. We always want to
                drop a table with a foreign key
                <em class="markup--em markup--p-em">before</em> dropping the
                table it references.
              </p>
              <pre
                name="bf2c"
                id="bf2c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">exports.down = function(knex, Promise) {<br>  // drop in the opposite order<br>  return knex.schema<br>    .dropTableIfExists(&#39;ranchers&#39;)<br>    .dropTableIfExists(&#39;farms&#39;)<br>};</code></pre>
              <p name="8f12" id="8f12" class="graf graf--p graf-after--pre">
                In the case of a many-to-many relationship, the syntax for
                creating an intermediary table is identical, except for one
                additional piece. We need a way to make sure our combination of
                foreign keys is unique.
              </p>
              <pre
                name="3a71"
                id="3a71"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">.createTable(&#39;farm_animals&#39;, tbl =&gt; {<br>  tbl.integer(&#39;farm_id&#39;)<br>    .unsigned()<br>    .notNullable()<br>    .references(&#39;id&#39;)<br>    // this table must exist already<br>    .inTable(&#39;farms&#39;)<br>  tbl.integer(&#39;animal_id&#39;)<br>    .unsigned()<br>    .notNullable()<br>    .references(&#39;id&#39;)<br>    // this table must exist already<br>    .inTable(&#39;animals&#39;)</code></pre>
              <pre
                name="15d5"
                id="15d5"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">  // the combination of the two keys becomes our primary key<br>  // will enforce unique combinations of ids<br>  tbl.primary([&#39;farm_id&#39;, &#39;animal_id&#39;]);<br>});</code></pre>
              <h3 name="0690" id="0690" class="graf graf--h3 graf-after--pre">
                Seeds
              </h3>
              <p name="97bb" id="97bb" class="graf graf--p graf-after--h3">
                Order is also a concern when seeding. We want to create seeds in
                the
                <strong class="markup--strong markup--p-strong">same</strong>
                order we created our tables. In other words, don’t create a seed
                with a foreign key, until that reference record exists.
              </p>
              <p name="2cad" id="2cad" class="graf graf--p graf-after--p">
                In our example, make sure to write the
                <code class="markup--code markup--p-code">01-farms</code> seed
                file and then the
                <code class="markup--code markup--p-code">02-ranchers</code>
                seed file.
              </p>
              <p name="5568" id="5568" class="graf graf--p graf-after--p">
                However, we run into a problem with truncating our seeds,
                because we want to truncate
                <code class="markup--code markup--p-code">02-ranchers</code>
                <em class="markup--em markup--p-em">before</em>
                <code class="markup--code markup--p-code">01-farms</code>. A
                library called
                <code class="markup--code markup--p-code">knex-cleaner</code>
                provides an easy solution for us.
              </p>
              <p name="b2ca" id="b2ca" class="graf graf--p graf-after--p">
                Run
                <code class="markup--code markup--p-code"
                  >knex seed:make 00-cleanup</code
                >
                and
                <code class="markup--code markup--p-code"
                  >npm install knex-cleaner</code
                >. Inside the cleanup seed, use the following code.
              </p>
              <pre
                name="4596"
                id="4596"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">const cleaner = require(&#39;knex-cleaner&#39;);</code></pre>
              <pre
                name="ca4a"
                id="ca4a"
                class="graf graf--pre graf-after--pre"
              ><code class="markup--code markup--pre-code">exports.seed = function(knex) {<br>  return cleaner.clean(knex, {<br>    mode: &#39;truncate&#39;, // resets ids<br>    ignoreTables: [&#39;knex_migrations&#39;, &#39;knex_migrations_lock&#39;], // don&#39;t empty migration tables<br>  });<br>};</code></pre>
              <p name="dfff" id="dfff" class="graf graf--p graf-after--pre">
                This removes all tables (excluding the two tables that track
                migrations) in the correct order before any seed files run.
              </p>
              <h3 name="0b0d" id="0b0d" class="graf graf--h3 graf-after--p">
                Cascading
              </h3>
              <p name="5f20" id="5f20" class="graf graf--p graf-after--h3">
                If a user attempt to delete a record that is referenced by
                another record (such as attempting to delete
                <code class="markup--code markup--p-code">Morton Ranch</code>
                when entries in our
                <code class="markup--code markup--p-code">ranchers</code> table
                reference that record), by default, the database will block the
                action. The same thing can happen when updating a record when a
                foreign key reference.
              </p>
              <p name="ee5a" id="ee5a" class="graf graf--p graf-after--p">
                If we want that to override this default, we can delete or
                update with
                <strong class="markup--strong markup--p-strong">cascade</strong
                >. With cascade, deleting a record also deletes all referencing
                records, we can set that up in our schema.
              </p>
              <pre
                name="3105"
                id="3105"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">.createTable(&#39;ranchers&#39;, tbl =&gt; {<br>    tbl.increments();<br>    tbl.string(&#39;rancher_name&#39;, 128);<br>    tbl.integer(&#39;farm_id&#39;)<br>    .unsigned()<br>    .notNullable()<br>    .references(&#39;id&#39;)<br>    .inTable(&#39;farms&#39;)<br>    .onUpdate(&#39;CASCADE&#39;);<br>    .onDelete(&#39;CASCADE&#39;)<br>})</code></pre>
              <p
                name="48bc"
                id="48bc"
                class="graf graf--p graf--empty graf-after--pre"
              >
                <br />
              </p>
              <p
                name="262b"
                id="262b"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <figure
                name="1771"
                id="1771"
                class="graf graf--figure graf-after--p"
              >
                <img
                  class="graf-image"
                  data-image-id="1*9xpwm_56lgvHkFTKsmoMqg.gif"
                  data-width="1200"
                  data-height="464"
                  src="https://cdn-images-1.medium.com/max/800/1*9xpwm_56lgvHkFTKsmoMqg.gif"
                />
              </figure>
              <p
                name="10c1"
                id="10c1"
                class="graf graf--p graf--empty graf-after--figure"
              >
                <br />
              </p>
              <p
                name="0b0a"
                id="0b0a"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <div
                name="7be3"
                id="7be3"
                class="graf graf--mixtapeEmbed graf-after--p"
              >
                <a
                  href="https://expressjs.com/en/starter/basic-routing.html"
                  data-href="https://expressjs.com/en/starter/basic-routing.html"
                  class="markup--anchor markup--mixtapeEmbed-anchor"
                  title="https://expressjs.com/en/starter/basic-routing.html"
                  ><strong class="markup--strong markup--mixtapeEmbed-strong"
                    >Express basic routing</strong
                  ><br /><em class="markup--em markup--mixtapeEmbed-em"
                    >Routing refers to determining how an application responds
                    to a client request to a particular endpoint, which is a
                    URI…</em
                  >expressjs.com</a
                ><a
                  href="https://expressjs.com/en/starter/basic-routing.html"
                  class="js-mixtapeImage mixtapeImage u-ignoreBlock"
                  data-media-id="5d4c830c126ec458101668c9a8792af9"
                  data-thumbnail-img-id="0*-_M5nM4tOVmX4yEQ"
                  style="
                    background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*-_M5nM4tOVmX4yEQ);
                  "
                ></a>
              </div>
              <div
                name="acb1"
                id="acb1"
                class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"
              >
                <a
                  href="https://expressjs.com/en/guide/writing-middleware.html"
                  data-href="https://expressjs.com/en/guide/writing-middleware.html"
                  class="markup--anchor markup--mixtapeEmbed-anchor"
                  title="https://expressjs.com/en/guide/writing-middleware.html"
                  ><strong class="markup--strong markup--mixtapeEmbed-strong"
                    >Writing middleware for use in Express apps</strong
                  ><br /><em class="markup--em markup--mixtapeEmbed-em"
                    >Middleware functions are functions that have access to the
                    request object ( req), the response object ( res), and
                    the…</em
                  >expressjs.com</a
                ><a
                  href="https://expressjs.com/en/guide/writing-middleware.html"
                  class="js-mixtapeImage mixtapeImage u-ignoreBlock"
                  data-media-id="9273508283e319a7f84046f8a6647696"
                  data-thumbnail-img-id="0*hnXqAKdkVqTquj5v"
                  style="
                    background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*hnXqAKdkVqTquj5v);
                  "
                ></a>
              </div>
              <p
                name="c188"
                id="c188"
                class="
                  graf graf--p graf--empty
                  graf-after--mixtapeEmbed
                  graf--trailing
                "
              >
                <br />
              </p>
            </div>
          </div>
        </section>
      </section>
      <footer>
        <p><a href="https://medium.com/p/75e3267b284a">View original.</a></p>
        <p>
          Exported from <a href="https://medium.com">Medium</a> on August 2,
          2021.
        </p>
      </footer>
    </article>
  </body>
</html>
