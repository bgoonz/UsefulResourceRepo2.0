<html>

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type">
  <style type="text/css">
    ol {
      margin: 0;
      padding: 0
    }

    table td,
    table th {
      padding: 0
    }

    .c16 {
      -webkit-text-decoration-skip: none;
      color: #000000;
      font-weight: 400;
      text-decoration: underline;
      vertical-align: baseline;
      text-decoration-skip-ink: none;
      font-size: 12pt;
      font-family: "Times New Roman";
      font-style: normal
    }

    .c7 {
      -webkit-text-decoration-skip: none;
      color: #000000;
      font-weight: 400;
      text-decoration: underline;
      vertical-align: baseline;
      text-decoration-skip-ink: none;
      font-size: 14pt;
      font-family: "Times New Roman";
      font-style: normal
    }

    .c24 {
      padding-top: 0pt;
      padding-bottom: 3pt;
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: center
    }

    .c4 {
      color: #000000;
      font-weight: 400;
      text-decoration: none;
      vertical-align: baseline;
      font-size: 12pt;
      font-family: "Times New Roman";
      font-style: normal
    }

    .c14 {
      color: #000000;
      font-weight: 400;
      text-decoration: none;
      vertical-align: baseline;
      font-size: 11pt;
      font-family: "Arial";
      font-style: normal
    }

    .c3 {
      padding-top: 0pt;
      text-indent: 36pt;
      padding-bottom: 0pt;
      line-height: 1.0;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    .c5 {
      color: #000000;
      font-weight: 700;
      text-decoration: none;
      vertical-align: baseline;
      font-size: 12pt;
      font-family: "Times New Roman";
      font-style: normal
    }

    .c8 {
      -webkit-text-decoration-skip: none;
      font-weight: 400;
      text-decoration: underline;
      text-decoration-skip-ink: none;
      font-size: 14pt;
      font-family: "Times New Roman"
    }

    .c20 {
      -webkit-text-decoration-skip: none;
      font-weight: 400;
      text-decoration: underline;
      text-decoration-skip-ink: none;
      font-size: 12pt;
      font-family: "Times New Roman"
    }

    .c1 {
      padding-top: 0pt;
      padding-bottom: 0pt;
      line-height: 1.15;
      orphans: 2;
      widows: 2;
      text-align: center
    }

    .c0 {
      padding-top: 0pt;
      padding-bottom: 0pt;
      line-height: 1.15;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    .c6 {
      padding-top: 0pt;
      padding-bottom: 0pt;
      line-height: 1.0;
      orphans: 2;
      widows: 2;
      text-align: center
    }

    .c11 {
      padding-top: 0pt;
      padding-bottom: 0pt;
      line-height: 2.0;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    .c18 {
      -webkit-text-decoration-skip: none;
      color: #000000;
      text-decoration: underline;
      vertical-align: baseline;
      text-decoration-skip-ink: none;
      font-style: normal
    }

    .c10 {
      padding-top: 0pt;
      padding-bottom: 0pt;
      line-height: 1.15;
      orphans: 2;
      widows: 2;
      text-align: right
    }

    .c25 {
      padding-top: 0pt;
      padding-bottom: 0pt;
      line-height: 2.0;
      orphans: 2;
      widows: 2;
      text-align: center
    }

    .c19 {
      vertical-align: super;
      font-size: 12pt;
      font-family: "Times New Roman";
      font-weight: 400
    }

    .c15 {
      font-size: 12pt;
      font-family: "Times New Roman";
      font-style: italic;
      font-weight: 700
    }

    .c17 {
      color: #000000;
      text-decoration: none;
      vertical-align: baseline;
      font-style: normal
    }

    .c9 {
      font-size: 18pt;
      font-family: "Times New Roman";
      font-weight: 400
    }

    .c12 {
      background-color: #ffffff;
      max-width: 468pt;
      padding: 72pt 72pt 72pt 72pt
    }

    .c21 {
      font-weight: 400;
      font-size: 14pt;
      font-family: "Times New Roman"
    }

    .c22 {
      font-size: 29pt;
      font-family: "Times New Roman";
      font-weight: 400
    }

    .c23 {
      font-size: 12pt;
      font-family: "Times New Roman";
      font-weight: 400
    }

    .c13 {
      text-indent: 36pt
    }

    .c2 {
      height: 11pt
    }

    .title {
      padding-top: 0pt;
      color: #000000;
      font-size: 26pt;
      padding-bottom: 3pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    .subtitle {
      padding-top: 0pt;
      color: #666666;
      font-size: 15pt;
      padding-bottom: 16pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    li {
      color: #000000;
      font-size: 11pt;
      font-family: "Arial"
    }

    p {
      margin: 0;
      color: #000000;
      font-size: 11pt;
      font-family: "Arial"
    }

    h1 {
      padding-top: 20pt;
      color: #000000;
      font-size: 20pt;
      padding-bottom: 6pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    h2 {
      padding-top: 18pt;
      color: #000000;
      font-size: 16pt;
      padding-bottom: 6pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    h3 {
      padding-top: 16pt;
      color: #434343;
      font-size: 14pt;
      padding-bottom: 4pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    h4 {
      padding-top: 14pt;
      color: #666666;
      font-size: 12pt;
      padding-bottom: 4pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    h5 {
      padding-top: 12pt;
      color: #666666;
      font-size: 11pt;
      padding-bottom: 4pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      orphans: 2;
      widows: 2;
      text-align: left
    }

    h6 {
      padding-top: 12pt;
      color: #666666;
      font-size: 11pt;
      padding-bottom: 4pt;
      font-family: "Arial";
      line-height: 1.15;
      page-break-after: avoid;
      font-style: italic;
      orphans: 2;
      widows: 2;
      text-align: left
    }
  </style>
</head>

<body class="c12">
  <p class="c0 c2"><span class="c14"></span></p>
  <p class="c1 c2"><span class="c14"></span></p>
  <p class="c24 title" id="h.2x2elrvlrgw3"><span>Guitar Delay Pedal</span></p>
  <p class="c1"><span class="c9">Bryan Guner</span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c25"><span class="c9 c18">Table of Contents </span></p>
  <p class="c0"><span class="c5">Introduction _____________________________________________________________Page 2</span>
  </p>
  <p class="c0"><span class="c5">Procedure_______________________________________________________________Page 2</span>
  </p>
  <p class="c0"><span class="c5">Design__________________________________________________________________Page 4</span>
  </p>
  <p class="c0"><span class="c15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Figure
      1&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;..&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;.&hellip;</span><span
      class="c5">Page 4</span></p>
  <p class="c0 c13"><span class="c15">Figure
      2&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;..&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;.&hellip;</span><span
      class="c5">Page 5</span></p>
  <p class="c0 c13"><span class="c15">Figure
      3&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;..&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;.&hellip;</span><span
      class="c5">Page 5</span></p>
  <p class="c0"><span class="c5">Results__________________________________________________________________Page 6</span>
  </p>
  <p class="c0"><span class="c23">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c15">Figure
      4&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;..&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip;.&hellip;</span><span
      class="c5">Page 6</span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0"><span class="c7">Introduction: </span></p>
  <p class="c0"><span class="c16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
  <p class="c11 c13"><span class="c4">The objective of this term project is to design and create a guitar pedal to
      output a delayed and echoed input. Throughout this project, students will utilize experience in both software and
      hardware, such as MATLAB, PSoC Creator, and breadboard design. To create the delay effect of the pedal, the
      program will need to convert an analog guitar signal into a digital signal. Next, the program will continuously
      poll for updated digital input, and output the echoed sound. </span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0"><span class="c7">Procedure:</span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c3"><span class="c22">T</span><span class="c23">he aim of &nbsp;the project was to develop a guitar delay
      pedal that samples an analog signal via digital polling. In order to achieve the desired effect I decided to
      implement a FIR (Finite Impulse Response). &nbsp;If you introduce an impulse, for example, a &quot;1&quot; sample
      followed by many &quot;0&quot; samples, the zeroes will arrive only after the &quot;1&quot; sample has made its
      way through the delay of the filter. The term finite impulse response arises because the filter output is computed
      as a weighted, finite term sum, of past, present, and future values of the guitar sample. A lack of feedback
      guarantees that the impulse response will be finite, however, in my case I &nbsp;would like to feed the past
      values of the sample array back into the output for &ldquo;n&rdquo; number of echoes. AlthoughI have feedback in
      my filter, because the impulse response is finite, it is still considered a FIR. The delay pedal is a system in
      which the n</span><span class="c19">th</span><span class="c4">&nbsp;prior sample is subtracted (fed back) each
      time a new sample comes in. After an arbitrarily set number of samples of an impulse, the output will always be
      zero. To create the delay between impulses as described above,I stored my signal samples in an array of 20,000
      elements and fed my echoes back using a circular buffer indexed by a variable dubbed &ldquo;Windex&rdquo;. In
      order to port an analog guitar signal into the PSoC board where I &nbsp;wish to manipulate it digitally, I
      &nbsp;had to create a preamp stage circuit that both offset it so that it contained minimal negative voltage and
      amplified it from the mV range into the 1V range. This circuit consisted of an Op Amp to amplify, a 5V reference
      voltage in ratio with parallel resistors to offset and a capacitor to block unwanted DC phenomenon at the output.
      In addition, &nbsp;I &nbsp;also created a MATLAB program to simulate the FIR as a debugging resource, however this
      proved to be unnecessary as the device performed as expected albeit nearly momentarily. Once the guitar signal is
      digitally sampled and passed through the filtering delay, it is converted back to analog via the PSoC&rsquo;s on
      board resources and subsequently amplified. </span></p>
  <p class="c0 c2"><span class="c7"></span></p>
  <p class="c0 c2"><span class="c7"></span></p>
  <p class="c0"><span class="c7">Design:</span></p>
  <p class="c0"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
  <p class="c11"><span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c4">To create my
      guitar delay pedal, I &nbsp;included numerous challenge elements, such as an analog to digital converter, a
      digital to analog converter, a FIR and two push buttons. I &nbsp;initially implemented my design in LTSpice in
      order to and visualize my design. </span></p>
  <p class="c11 c2"><span class="c4"></span></p>
  <p class="c6"><span
      style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 491.27px; height: 314.50px;"><img
        alt="" src="images/image3.png"
        style="width: 491.27px; height: 314.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
        title=""></span></p>
  <p class="c6"><span class="c16">Figure 1: LTSpice Circuit Schematic</span></p>
  <p class="c6 c2"><span class="c16"></span></p>
  <p class="c6 c2"><span class="c16"></span></p>
  <p class="c11"><span class="c4">Next, I &nbsp;began the PSoC implementation of my design. The diagram below shows the
      communication between the ADC and DAC with the 20 kHz clock.</span></p>
  <p class="c11 c2"><span class="c4"></span></p>
  <p class="c6"><span
      style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 528.79px; height: 236.50px;"><img
        alt="" src="images/image2.png"
        style="width: 528.79px; height: 236.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
        title=""></span></p>
  <p class="c6"><span class="c16">Figure 2:PSoC Schematic</span></p>
  <p class="c1 c2"><span class="c4"></span></p>
  <p class="c1 c2"><span class="c4"></span></p>
  <p class="c11"><span class="c4">To demonstrate the functionality of my program, I &nbsp;created a timing diagram. The
      diagram shows the timing relationships between the clock, the ADC, the &ldquo;end of convert&rdquo;, the
      foreground program, and the VDAC. At the positive edge of the clock, the analog to digital conversion begins, and
      triggers my program to &ldquo;begin&rdquo;. my guitar delay program will run, and finish with the conversion from
      digital to analog. The system will continue to run, always starting on the next positive edge of the clock. This
      diagram is shown below, in Figure 3.</span></p>
  <p class="c11"><span class="c4">&nbsp;</span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c6"><span
      style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 440.30px; height: 172.50px;"><img
        alt="" src="images/image4.png"
        style="width: 440.30px; height: 172.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
        title=""></span></p>
  <p class="c6"><span class="c16">Figure 3: Timing Diagram</span></p>
  <p class="c6 c2"><span class="c16"></span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c0"><span class="c7">Results:</span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c11"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This project served as an introduction
      to the capabilities of a PSoC board, and an opportunity to &nbsp;utilize my knowledge in PSoC Creator to design a
      guitar delay pedal. The project enforced a strong conceptual understanding of a FIR, circular buffering, as well
      as polling via analog to digital conversion. Although my project produced no quantitative results, my delay pedal
      proved to be functional, further I &nbsp;was able to demonstrate on an oscilloscope the relationship between the
      frequency of the input and the amplitude of its echo, however, this result was not captured before the untimely
      demise of my board. my design allowed the user to control the number of echoes produced by the pedal using two
      push buttons,either increment or decrement. The pedal was designed to be user friendly, and includes a LCD display
      which outputs the current number of echoes being produced. An image of my final project is shown below, in Figure
      4. </span></p>
  <p class="c0 c2"><span class="c4"></span></p>
  <p class="c6"><span
      style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 291.86px; height: 384.50px;"><img
        alt="" src="images/image1.png"
        style="width: 291.86px; height: 384.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
        title=""></span></p>
  <p class="c6"><span class="c20">Figure 4: Final Delay Rectifier/Anti Aliasing Circuit</span></p>
  <div>
    <p class="c2 c10"><span class="c14"></span></p>
  </div>
</body>

</html>
