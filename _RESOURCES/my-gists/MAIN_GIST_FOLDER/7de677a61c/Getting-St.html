<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Getting Started With PostgreSQL</title>
    <style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html,
      body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 940px;
        margin: auto;
      }
      section {
        width: 940px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 1200px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field="subtitle"],
      section[data-field="description"] {
        display: none;
      }
    </style>
  </head>
  <body>
    <article class="h-entry">
      <header>
        <h1 class="p-name">Getting Started With PostgreSQL</h1>
      </header>
      <section data-field="subtitle" class="p-summary">
        In database jargon, PostgreSQL uses a client/server model. A PostgreSQL
        session consists of the following cooperating processes (programs):
      </section>
      <section data-field="body" class="e-content">
        <section
          name="4447"
          class="section section--body section--first section--last"
        >
          <div class="section-divider"><hr class="section-divider" /></div>
          <div class="section-content">
            <div class="section-inner sectionLayout--insetColumn">
              <h3
                name="242d"
                id="242d"
                class="graf graf--h3 graf--leading graf--title"
              >
                Getting Started With PostgreSQL
              </h3>
              <h4
                name="d15b"
                id="d15b"
                class="graf graf--h4 graf-after--h3 graf--subtitle"
              >
                In database jargon, PostgreSQL uses a client/server model. A
                PostgreSQL session consists of the following cooperating
                processes (programs):
              </h4>
              <p
                name="1214"
                id="1214"
                class="graf graf--p graf--empty graf-after--h4"
              >
                <br />
              </p>
              <ul class="postList">
                <li name="d5d8" id="d5d8" class="graf graf--li graf-after--p">
                  A server process, which manages the database files, accepts
                  connections to the database from client applications, and
                  performs database actions on behalf of the clients. The
                  database server program is called
                  <code class="markup--code markup--li-code">postgres</code>.
                </li>
                <li name="91d1" id="91d1" class="graf graf--li graf-after--li">
                  The user’s client (frontend) application that wants to perform
                  database operations. Client applications can be very diverse
                  in nature: a client could be a text-oriented tool, a graphical
                  application, a web server that accesses the database to
                  display web pages, or a specialized database maintenance tool.
                  Some client applications are supplied with the PostgreSQL
                  distribution; most are developed by users.
                </li>
              </ul>
              <p name="487f" id="487f" class="graf graf--p graf-after--li">
                As is typical of client/server applications, the client and the
                server can be on different hosts. In that case they communicate
                over a TCP/IP network connection. You should keep this in mind,
                because the files that can be accessed on a client machine might
                not be accessible (or might only be accessible using a different
                file name) on the database server machine.
              </p>
              <p name="5008" id="5008" class="graf graf--p graf-after--p">
                The PostgreSQL server can handle multiple concurrent connections
                from clients. To achieve this it starts (“forks”) a new process
                for each connection. From that point on, the client and the new
                server process communicate without intervention by the original
                <code class="markup--code markup--p-code">postgres</code>
                process. Thus, the master server process is always running,
                waiting for client connections, whereas client and associated
                server processes come and go. (All of this is of course
                invisible to the user. We only mention it here for
                completeness.)
              </p>
              <p
                name="996d"
                id="996d"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <p
                name="1cdc"
                id="1cdc"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <p
                name="aa3d"
                id="aa3d"
                class="graf graf--p graf--empty graf-after--p"
              >
                <br />
              </p>
              <h3 name="dd43" id="dd43" class="graf graf--h3 graf-after--p">
                What is SQL?
              </h3>
              <h3
                name="3173"
                id="3173"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="b538" id="b538" class="graf graf--p graf-after--h3">
                SQL is short for Structured Query Language. Originally, it used
                to be called SEQUEL (Structured English Query Language) and was
                used for storing and manipulating data in databases. Today SQL
                is used to perform all types of data operations in relational
                database management systems (RDBMS).
              </p>
              <p name="09f2" id="09f2" class="graf graf--p graf-after--p">
                SQL is a powerful language where we can perform a wide range of
                operations:
              </p>
              <ul class="postList">
                <li name="7f0b" id="7f0b" class="graf graf--li graf-after--p">
                  execute queries
                </li>
                <li name="d14a" id="d14a" class="graf graf--li graf-after--li">
                  fetch data
                </li>
                <li name="5389" id="5389" class="graf graf--li graf-after--li">
                  insert, update, and delete records in a database (DML
                  operations)
                </li>
                <li name="f62e" id="f62e" class="graf graf--li graf-after--li">
                  create new objects in a database (DDL operations)
                </li>
                <li name="d790" id="d790" class="graf graf--li graf-after--li">
                  set permissions on tables, procedures, functions, and views
                </li>
                <li name="ebab" id="ebab" class="graf graf--li graf-after--li">
                  and much, much more...
                </li>
              </ul>
              <h3 name="3b28" id="3b28" class="graf graf--h3 graf-after--li">
                What is the ANSI SQL standard?
              </h3>
              <h3
                name="4940"
                id="4940"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="0ca7" id="0ca7" class="graf graf--p graf-after--h3">
                The American National Standards Institute (ANSI) created a
                standard for SQL in 1986, and it was adopted by the
                International Organization for Standardization (ISO) in 1987.
                For each RDBMS to be compliant with the ANSI standard, they all
                have to support the major commands, like DML, in a similar
                manner as closely as possible. More information about the ANSI
                standard can be found on the
                <a
                  href="https://en.wikipedia.org/wiki/SQL"
                  data-href="https://en.wikipedia.org/wiki/SQL"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >SQL Wikipedia page</a
                >.
              </p>
              <p name="4164" id="4164" class="graf graf--p graf-after--p">
                SQL follows ANSI/ISO standards, but there are different versions
                of the SQL language used by different database systems. For
                example, in PostgreSQL we can perform an INSERT operation using
                RETURNING clauses, which not all other databases can do.
              </p>
              <pre
                name="2550"
                id="2550"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">[centos@tushar-ldap-docker bin]$ ./psql postgres<br>    psql.bin (11.9.17)<br>    Type &quot;help&quot; for help.<br>    postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> tyu(n <strong class="markup--strong markup--pre-strong">int</strong>);<br>    <strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>    postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tyu <strong class="markup--strong markup--pre-strong">values</strong>(1),(2) returning *;<br>    n <br>    <em class="markup--em markup--pre-em">---</em><br>    1<br>    2<br>   (2 rows)<br>   <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 2</code></pre>
              <pre
                name="5aaf"
                id="5aaf"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="aac1" id="aac1" class="graf graf--p graf-after--pre">
                But to be compliant with the ANSI standard, all databases
                support commands (like DELETE, UPDATE, SELECT, INSERT) in the
                same way—that is, the syntax should work anywhere.
              </p>
              <p name="debe" id="debe" class="graf graf--p graf-after--p">
                If we check the
                <a
                  href="https://www.postgresql.org/docs/12/sql-insert.html"
                  data-href="https://www.postgresql.org/docs/12/sql-insert.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >PostgreSQL documentation of the INSERT statement</a
                >, its conformity to the SQL standard is discussed in the page’s
                Compatibility section:
              </p>
              <blockquote
                name="66f8"
                id="66f8"
                class="graf graf--blockquote graf-after--p"
              >
                <em class="markup--em markup--blockquote-em">Compatibility</em>
              </blockquote>
              <blockquote
                name="6b67"
                id="6b67"
                class="graf graf--blockquote graf-after--blockquote"
              >
                <em class="markup--em markup--blockquote-em"
                  >INSERT conforms to the SQL standard, except that the
                  RETURNING clause is a PostgreSQL extension, as is the ability
                  to use WITH with INSERT, and the ability to specify an
                  alternative action with ON CONFLICT. Also, the case in which a
                  column name list is omitted, but not all the columns are
                  filled from the VALUES clause or query, is disallowed by the
                  standard.</em
                >
              </blockquote>
              <blockquote
                name="5b9d"
                id="5b9d"
                class="graf graf--blockquote graf-after--blockquote"
              >
                <em class="markup--em markup--blockquote-em"
                  >The SQL standard specifies that OVERRIDING SYSTEM VALUE can
                  only be specified if an identity column that is generated
                  always exists. PostgreSQL allows the clause in any case and
                  ignores it if it is not applicable.</em
                >
              </blockquote>
              <blockquote
                name="7e33"
                id="7e33"
                class="graf graf--blockquote graf--empty graf-after--blockquote"
              >
                <br />
              </blockquote>
              <blockquote
                name="f4ce"
                id="f4ce"
                class="graf graf--blockquote graf--empty graf-after--blockquote"
              >
                <br />
              </blockquote>
              <p
                name="73fd"
                id="73fd"
                class="graf graf--p graf-after--blockquote"
              >
                The PostgreSQL documentation includes clear descriptions of any
                differences from the SQL standard for any command, including:
              </p>
              <ul class="postList">
                <li name="a637" id="a637" class="graf graf--li graf-after--p">
                  DML (INSERT, SELECT, DELETE)
                </li>
                <li name="f912" id="f912" class="graf graf--li graf-after--li">
                  DDL (CREATE, ALTER, TRUNCATE, DROP, RENAME)
                </li>
                <li name="292c" id="292c" class="graf graf--li graf-after--li">
                  TCL (COMMIT, ROLLBACK, SAVEPOINT)
                </li>
                <li name="20cf" id="20cf" class="graf graf--li graf-after--li">
                  DCL (GRANT, REVOKE)
                </li>
              </ul>
              <p name="f6c8" id="f6c8" class="graf graf--p graf-after--li">
                under each command’s Compatibility section.
              </p>
              <h3 name="e2e6" id="e2e6" class="graf graf--h3 graf-after--p">
                SQL query examples
              </h3>
              <h3
                name="3a16"
                id="3a16"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="0f20" id="0f20" class="graf graf--p graf-after--h3">
                Now let’s explore some examples of common and useful PostgreSQL
                queries that can be used in various situations.
              </p>
              <h3 name="6fdf" id="6fdf" class="graf graf--h3 graf-after--p">
                1. CREATE TABLE query in PostgreSQL
              </h3>
              <h3
                name="0c0c"
                id="0c0c"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="ed53" id="ed53" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.postgresql.org/docs/12/sql-createtable.html"
                  data-href="https://www.postgresql.org/docs/12/sql-createtable.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >CREATE TABLE</a
                >
                is a keyword that will create a new, initially empty table in
                the database. The table will be owned by the user who has issued
                this command.
              </p>
              <pre
                name="8a7b"
                id="8a7b"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> dummy_table(name <strong class="markup--strong markup--pre-strong">varchar</strong>(20),address text,age <strong class="markup--strong markup--pre-strong">int</strong>);<br>      <strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong></code></pre>
              <pre
                name="e16f"
                id="e16f"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="76b6" id="76b6" class="graf graf--h3 graf-after--pre">
                2. INSERT query in PostgreSQL
              </h3>
              <h3
                name="1890"
                id="1890"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="53dd" id="53dd" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-insert.html"
                  data-href="https://www.postgresql.org/docs/12/sql-insert.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >INSERT command</a
                >
                is used to insert data into a table:
              </p>
              <pre
                name="6cf5"
                id="6cf5"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;XYZ&#39;,&#39;location-A&#39;,25);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;ABC&#39;,&#39;location-B&#39;,35);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;DEF&#39;,&#39;location-C&#39;,40);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;PQR&#39;,&#39;location-D&#39;,54);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1</code></pre>
              <pre
                name="7dda"
                id="7dda"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="ff19" id="ff19" class="graf graf--h3 graf-after--pre">
                3. SELECT query without WHERE condition in PostgreSQL
              </h3>
              <h3
                name="96b5"
                id="96b5"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d1cf" id="d1cf" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-select.html"
                  data-href="https://www.postgresql.org/docs/12/sql-select.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >SELECT command</a
                >
                (when used without the optional WHERE condition) is used to
                fetch all data from a database table:
              </p>
              <pre
                name="36e0"
                id="36e0"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br>        name |  address   | age <br>        <em class="markup--em markup--pre-em">---------+--------------+ -----</em><br>        XYZ   | location-A |  25<br>        ABC   | location-B |  35<br>        DEF   | location-C |  40<br>        PQR   | location-D |  54<br>        (4 rows)</code></pre>
              <pre
                name="5dd0"
                id="5dd0"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="a773" id="a773" class="graf graf--h3 graf-after--pre">
                4. UPDATE query in PostgreSQL
              </h3>
              <h3
                name="c1cf"
                id="c1cf"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="52fb" id="52fb" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.postgresql.org/docs/12/sql-update.html"
                  data-href="https://www.postgresql.org/docs/12/sql-update.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >UPDATE</a
                >
                is used to make updates to the data or row(s) of a database
                table. In the example below we use UPDATE to change the age of a
                person whose name is ‘PQR’:
              </p>
              <pre
                name="cce1"
                id="cce1"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> age=50 <strong class="markup--strong markup--pre-strong">where</strong> name=&#39;PQR&#39;;<br>        <strong class="markup--strong markup--pre-strong">UPDATE</strong> 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br>        name |  address   | age <br>        <em class="markup--em markup--pre-em">--------+--------------+-------</em><br>        XYZ  | location-A |  25<br>        ABC  | location-B |  35<br>        DEF  | location-C |  40<br>        PQR  | location-D |  50<br>        (4 rows)</code></pre>
              <pre
                name="2dc3"
                id="2dc3"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="7ae7" id="7ae7" class="graf graf--p graf-after--pre">
                Next, we’ll use the UPDATE command to change the name and age of
                a person whose address is ‘location-D’:
              </p>
              <pre
                name="d0fe"
                id="d0fe"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> name=&#39;GHI&#39;,age=54 <strong class="markup--strong markup--pre-strong">where</strong> address=&#39;location-D&#39;;<br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br> GHI  | location-D |  54<br>(4 rows)<br><br>postgres=#</code></pre>
              <pre
                name="e8f9"
                id="e8f9"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="c074" id="c074" class="graf graf--p graf-after--pre">
                If we want to modify all the values in the address and age
                columns in dummy_table, then we do not need to use the WHERE
                clause. The UPDATE query would look like this:
              </p>
              <pre
                name="1ac7"
                id="1ac7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> age=54,address=&#39;location-X&#39;;<br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 4<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table ;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+--------</em><br> XYZ  | location-X |  54<br> ABC  | location-X |  54<br> DEF  | location-X |  54<br> GHI  | location-X |  54<br>(4 rows)<br><br>postgres=#</code></pre>
              <pre
                name="99d9"
                id="99d9"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="a8dd" id="a8dd" class="graf graf--p graf-after--pre">
                A RETURNING clause returns the updated rows. This is optional in
                UPDATE:
              </p>
              <pre
                name="c357"
                id="c357"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> age=30 <strong class="markup--strong markup--pre-strong">where</strong> name=&#39;XYZ&#39; returning age <strong class="markup--strong markup--pre-strong">as</strong> age_no;<br> age_no <br><em class="markup--em markup--pre-em">---------</em><br>      30<br>(1 row)<br><br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 1</code></pre>
              <pre
                name="2456"
                id="2456"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="0d3a" id="0d3a" class="graf graf--p graf-after--pre">
                It is always recommended to perform such operations under
                transaction blocks (i.e., BEGIN...COMMIT/ROLLBACK;), so we have
                the option to roll back the operation.
              </p>
              <h3 name="3dd8" id="3dd8" class="graf graf--h3 graf-after--p">
                5. DELETE query in PostgreSQL
              </h3>
              <h3
                name="9bd9"
                id="9bd9"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="aba5" id="aba5" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-delete.html"
                  data-href="https://www.postgresql.org/docs/12/sql-delete.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >DELETE command</a
                >
                is used to delete row(s). It can be used with or without the
                optional WHERE condition, but take note: if the WHERE condition
                is missing, the command will delete all rows, leaving you with
                an empty table.
              </p>
              <p name="eaf8" id="eaf8" class="graf graf--p graf-after--p">
                In this example, we are deleting one row whose age column has
                the value 65:
              </p>
              <pre
                name="cf60"
                id="cf60"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">delete</strong> <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=65;<br><strong class="markup--strong markup--pre-strong">DELETE</strong> 1<br>postgres=#</code></pre>
              <pre
                name="6113"
                id="6113"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="4851" id="4851" class="graf graf--h3 graf-after--pre">
                6. Comparison Operators in PostgreSQL queries
              </h3>
              <h3
                name="fc3e"
                id="fc3e"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="78f6" id="78f6" class="graf graf--p graf-after--h3">
                In PostgreSQL, with the help of
                <a
                  href="https://www.postgresql.org/docs/12/functions-comparison.html"
                  data-href="https://www.postgresql.org/docs/12/functions-comparison.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >comparison operators</a
                >
                we can find results where the value in a column is not equal to
                the specified condition or value.
              </p>
              <h3 name="128a" id="128a" class="graf graf--h3 graf-after--p">
                Less than or equal to query:
              </h3>
              <h3
                name="27c1"
                id="27c1"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="c397"
                id="c397"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age &lt;=50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br> PQR  | location-D |  50<br>(4 rows)</code></pre>
              <pre
                name="c857"
                id="c857"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="91c5" id="91c5" class="graf graf--h3 graf-after--pre">
                Greater than or equal to query:
              </h3>
              <h3
                name="bdba"
                id="bdba"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="721a"
                id="721a"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age&gt;=50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> PQR  | location-D |  50<br>(1 row)</code></pre>
              <pre
                name="32a2"
                id="32a2"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="56ba" id="56ba" class="graf graf--h3 graf-after--pre">
                Not equal to query:
              </h3>
              <h3
                name="a7f0"
                id="a7f0"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="0ae7"
                id="0ae7"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age&lt;&gt;50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br>(3 rows)</code></pre>
              <pre
                name="0534"
                id="0534"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="19b2" id="19b2" class="graf graf--h3 graf-after--pre">
                Equal to query:
              </h3>
              <h3
                name="414e"
                id="414e"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="81bf"
                id="81bf"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> PQR  | location-D |  50<br>(1 row)</code></pre>
              <pre
                name="1e29"
                id="1e29"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="d0d7" id="d0d7" class="graf graf--h3 graf-after--pre">
                7. SELECT DISTINCT query in PostgreSQL
              </h3>
              <h3
                name="3b26"
                id="3b26"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="6210" id="6210" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-select.html#SQL-DISTINCT"
                  data-href="https://www.postgresql.org/docs/12/sql-select.html#SQL-DISTINCT"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >SELECT DISTINCT</a
                >
                statement is used to return only distinct values from the table.
                It removes any duplicate values.
              </p>
              <h3 name="9c75" id="9c75" class="graf graf--h3 graf-after--p">
                SELECT query without DISTINCT clause
              </h3>
              <h3
                name="2305"
                id="2305"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="1573"
                id="1573"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">order</strong> <strong class="markup--strong markup--pre-strong">by</strong> 1;<br> age <br><em class="markup--em markup--pre-em">-----</em><br>   1<br>   1<br>   2<br>   2<br>   3<br>(5 rows)</code></pre>
              <pre
                name="759b"
                id="759b"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="a026" id="a026" class="graf graf--h3 graf-after--pre">
                SELECT query with DISTINCT clause
              </h3>
              <h3
                name="f142"
                id="f142"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="ac0e"
                id="ac0e"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">distinct</strong> age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">order</strong> <strong class="markup--strong markup--pre-strong">by</strong> 1;<br> age <br><em class="markup--em markup--pre-em">-----</em><br>   1<br>   2<br>   3<br>(3 rows)</code></pre>
              <pre
                name="6273"
                id="6273"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="d198" id="d198" class="graf graf--h3 graf-after--pre">
                8. TRUNCATE query in PostgreSQL
              </h3>
              <h3
                name="2c72"
                id="2c72"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d804" id="d804" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-truncate.html"
                  data-href="https://www.postgresql.org/docs/12/sql-truncate.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >TRUNCATE command</a
                >
                is used to empty a table:
              </p>
              <pre
                name="6dff"
                id="6dff"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">truncate</strong> <strong class="markup--strong markup--pre-strong">table</strong> dummy_table;<br><strong class="markup--strong markup--pre-strong">TRUNCATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong></code></pre>
              <pre
                name="4cfb"
                id="4cfb"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="6300" id="6300" class="graf graf--h3 graf-after--pre">
                9. DROP TABLE query in PostgreSQL
              </h3>
              <h3
                name="28ff"
                id="28ff"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="f379" id="f379" class="graf graf--p graf-after--h3">
                This
                <a
                  href="https://www.postgresql.org/docs/12/sql-droptable.html"
                  data-href="https://www.postgresql.org/docs/12/sql-droptable.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >DROP TABLE command</a
                >
                is used to drop a table from the database:
              </p>
              <pre
                name="49dc"
                id="49dc"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgresql=# <strong class="markup--strong markup--pre-strong">drop</strong> <strong class="markup--strong markup--pre-strong">table</strong> <strong class="markup--strong markup--pre-strong">if</strong> <strong class="markup--strong markup--pre-strong">exists</strong> dummy;<br>NOTICE:  table &quot;dummy&quot; does not exist, skipping<br><strong class="markup--strong markup--pre-strong">DROP</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong></code></pre>
              <pre
                name="d905"
                id="d905"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="ba42" id="ba42" class="graf graf--p graf-after--pre">
                This command has removed the full table, including any
                associated data, indexes, rules, triggers, and constraints for
                that table.
              </p>
              <h3 name="57d0" id="57d0" class="graf graf--h3 graf-after--p">
                10. CREATE VIEW query in PostgreSQL
              </h3>
              <h3
                name="d6e1"
                id="d6e1"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="f8be" id="f8be" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-createview.html"
                  data-href="https://www.postgresql.org/docs/12/sql-createview.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >CREATE VIEW</a
                >
                command is used to generate views. Views are pseudo-tables,
                which are used to present a full table, subset, or select
                columns from the underlying table:
              </p>
              <pre
                name="adbd"
                id="adbd"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> <strong class="markup--strong markup--pre-strong">view</strong> vi <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">NULL</strong>;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">VIEW</strong></code></pre>
              <pre
                name="5954"
                id="5954"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="20f7" id="20f7" class="graf graf--h3 graf-after--pre">
                11. Create a table in Postgresql using the SELECT statement
              </h3>
              <h3
                name="00ab"
                id="00ab"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d3da" id="d3da" class="graf graf--p graf-after--h3">
                Using the syntax in the example below, we can create a table
                using a SELECT statement:
              </p>
              <pre
                name="54d6"
                id="54d6"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> &#39;My name  is X&#39; <strong class="markup--strong markup--pre-strong">as</strong> col1 , 10 <strong class="markup--strong markup--pre-strong">as</strong> col2, &#39;Address is -XYZ location&#39; <strong class="markup--strong markup--pre-strong">as</strong> col3  <strong class="markup--strong markup--pre-strong">into</strong> new_table;<br><strong class="markup--strong markup--pre-strong">SELECT</strong> 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> new_table ;<br>     col1      | col2 |           col3           <br><em class="markup--em markup--pre-em">---------------+------+--------------------------</em><br> My name  is X |   10 | Address is -XYZ location<br>(1 row)</code></pre>
              <pre
                name="06d2"
                id="06d2"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="a11b" id="a11b" class="graf graf--h3 graf-after--pre">
                12. Query timeout in PostgreSQL
              </h3>
              <h3
                name="166c"
                id="166c"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="a90a" id="a90a" class="graf graf--p graf-after--h3">
                We can command a query to timeout after a certain period with
                the help of
                <a
                  href="https://www.enterprisedb.com/postgres-tutorials/how-tune-postgresql-guc-parameters"
                  data-href="https://www.enterprisedb.com/postgres-tutorials/how-tune-postgresql-guc-parameters"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >GUC parameters</a
                >
                (short for grand unified configuration) like statement_timeout,
                which aborts any statement that takes more than the specified
                number of milliseconds:
              </p>
              <pre
                name="677c"
                id="677c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgresql=# <strong class="markup--strong markup--pre-strong">set</strong> statement_timeout=10;<br><strong class="markup--strong markup--pre-strong">SET</strong><br>postgresql=# <strong class="markup--strong markup--pre-strong">select</strong> pg_sleep(20);<br>ERROR:  canceling statement due to statement timeout</code></pre>
              <pre
                name="464c"
                id="464c"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="773b" id="773b" class="graf graf--h3 graf-after--pre">
                13. Using CREATE SEQUENCE with the INSERT query in PostgreSQL
              </h3>
              <h3
                name="f211"
                id="f211"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="b662" id="b662" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/sql-createsequence.html"
                  data-href="https://www.postgresql.org/docs/12/sql-createsequence.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >CREATE SEQUENCE</a
                >
                command is a sequential number generator. Once the sequence is
                created, we can use the sequence’s nextval and currval functions
                to insert values into a table:
              </p>
              <pre
                name="648d"
                id="648d"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> sequence seq;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> SEQUENCE<br>postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> tab(n <strong class="markup--strong markup--pre-strong">int</strong>);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tab <strong class="markup--strong markup--pre-strong">values</strong> (nextval(&#39;seq&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tab <strong class="markup--strong markup--pre-strong">values</strong> (currval(&#39;seq&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tab <strong class="markup--strong markup--pre-strong">values</strong> (nextval(&#39;seq&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> tab;<br> n <br><em class="markup--em markup--pre-em">---</em><br> 1<br> 1<br> 2<br>(3 rows)</code></pre>
              <pre
                name="5d74"
                id="5d74"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="5a1b" id="5a1b" class="graf graf--h3 graf-after--pre">
                14. Importing BLOB data types into PostgreSQL
              </h3>
              <h3
                name="6ade"
                id="6ade"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="a8f5" id="a8f5" class="graf graf--p graf-after--h3">
                PostgreSQL doesn’t directly support BLOBs (binary large
                objects), but we can work with them using the following methods:
              </p>
              <p name="758d" id="758d" class="graf graf--p graf-after--p">
                Let&#39;s assume you have an image (in png format) downloaded in
                the /home/edb/ folder:
              </p>
              <pre
                name="716b"
                id="716b"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code">[edb@localhost]$ ls /home/edb/mypic.png <br>/home/edb/mypic.png</code></pre>
              <pre
                name="750e"
                id="750e"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="60cb" id="60cb" class="graf graf--p graf-after--pre">
                We want to store this image in the PostgreSQL database.
              </p>
              <p name="005a" id="005a" class="graf graf--p graf-after--p">
                Go to the bin folder of your PostgreSQL installation and connect
                to the psql terminal:
              </p>
              <pre
                name="34fa"
                id="34fa"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">Create</strong> <strong class="markup--strong markup--pre-strong">table</strong> testing(n <strong class="markup--strong markup--pre-strong">int</strong>,n1 oid);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testing <strong class="markup--strong markup--pre-strong">values</strong> (1,lo_import(&#39;/home/edb/mypic.png&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1</code></pre>
              <pre
                name="3ee8"
                id="3ee8"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="ad49" id="ad49" class="graf graf--p graf-after--pre">
                The lo_import() function loads the named file into
                pg_largeobject and returns an OID (object identifier) value that
                will refer to the large object. Selecting the testing table will
                show just the OID and not the bits that have made up this photo.
              </p>
              <h3 name="6a49" id="6a49" class="graf graf--h3 graf-after--p">
                15. ILIKE query in PostgreSQL
              </h3>
              <h3
                name="2e56"
                id="2e56"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="db47" id="db47" class="graf graf--p graf-after--h3">
                The ILIKE operator is a
                <a
                  href="https://www.postgresql.org/docs/12/functions-matching.html"
                  data-href="https://www.postgresql.org/docs/12/functions-matching.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >matching function</a
                >
                similar to the LIKE operator, but with the advantage that it
                matches valus case-insensitively.
              </p>
              <pre
                name="b0aa"
                id="b0aa"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> ted;<br>  n  <br><em class="markup--em markup--pre-em">-----</em><br> TAR<br> TaR<br> Tar<br> tar<br>(4 rows)</code></pre>
              <pre
                name="4934"
                id="4934"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="afc4" id="afc4" class="graf graf--h3 graf-after--pre">
                Using ILIKE in a WHERE condition
              </h3>
              <h3
                name="f431"
                id="f431"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="2453"
                id="2453"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> ted <strong class="markup--strong markup--pre-strong">where</strong> n <strong class="markup--strong markup--pre-strong">ilike</strong> &#39;TAR%&#39;;<br>  n  <br><em class="markup--em markup--pre-em">-----</em><br> TAR<br> TaR<br> Tar<br> tar<br>(4 rows)</code></pre>
              <pre
                name="1319"
                id="1319"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="5d1e" id="5d1e" class="graf graf--h3 graf-after--pre">
                16. Hierarchical queries in PostgreSQL
              </h3>
              <h3
                name="9ed6"
                id="9ed6"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="1786" id="1786" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.enterprisedb.com/postgres-tutorials/how-run-hierarchical-queries-oracle-and-postgresql"
                  data-href="https://www.enterprisedb.com/postgres-tutorials/how-run-hierarchical-queries-oracle-and-postgresql"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Hierarchical queries</a
                >
                are ones where the results have a structured or parent-child
                relationship and are displayed in a tree structure. To see how
                hierarchical queries work, create a dummy table:
              </p>
              <pre
                name="cc2f"
                id="cc2f"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> test_table(  <br>  emp_no                <strong class="markup--strong markup--pre-strong">int</strong>,  <br>  ename                 <strong class="markup--strong markup--pre-strong">char</strong>(5),  <br>  job                       <strong class="markup--strong markup--pre-strong">char</strong>(9),  <br>  manager_no        <strong class="markup--strong markup--pre-strong">int</strong><br>);</code></pre>
              <pre
                name="945c"
                id="945c"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="2139" id="2139" class="graf graf--p graf-after--pre">
                Insert data into ‘test_table’:
              </p>
              <pre
                name="998e"
                id="998e"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(10,&#39;A1&#39;,&#39;CEO&#39;,<strong class="markup--strong markup--pre-strong">null</strong>);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(11, &#39;B1&#39;, &#39;VP&#39;, 10);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(12, &#39;B2&#39;, &#39;VP&#39;, 10);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(13, &#39;B3&#39;, &#39;VP&#39;, 10);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(14, &#39;C1&#39;, &#39;DIRECTOR&#39;, 13);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(15, ‘C2’, ‘DIRECTOR’, 13);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(16, &#39;D1&#39;, &#39;MANAGER&#39;, 15);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(17 ,&#39;E1&#39;, &#39;ENGINEER&#39;, 11);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(18, &#39;E2&#39;, &#39;ENGINEER&#39;, 11);</code></pre>
              <pre
                name="f30b"
                id="f30b"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="1ec9" id="1ec9" class="graf graf--p graf-after--pre">
                We can perform hierarchical queries on this table using the
                methods below.
              </p>
              <h3 name="bc21" id="bc21" class="graf graf--h3 graf-after--p">
                17. Length function in PostgreSQL
              </h3>
              <h3
                name="1029"
                id="1029"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d8fa" id="d8fa" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/9.1/functions-string.html"
                  data-href="https://www.postgresql.org/docs/9.1/functions-string.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >length function</a
                >
                returns the number of characters or number of bytes in a
                specified string variable.
              </p>
              <h3 name="7578" id="7578" class="graf graf--h3 graf-after--p">
                Basic SELECT query
              </h3>
              <h3
                name="2d2e"
                id="2d2e"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="9500"
                id="9500"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> name,age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name | age <br><em class="markup--em markup--pre-em">------+-----</em><br> XYZ  |  25<br> ABC  |  35<br> DEF  |  40<br> PQR  |  54<br> PQR  |    <br>(5 rows)</code></pre>
              <pre
                name="4523"
                id="4523"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="1ab9" id="1ab9" class="graf graf--h3 graf-after--pre">
                Query with length function for column name and age
              </h3>
              <h3
                name="09eb"
                id="09eb"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="d73e"
                id="d73e"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> length(name),length(age) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> length | length <br><em class="markup--em markup--pre-em">--------+--------</em><br>      3 |      2<br>      3 |      2<br>      3 |      2<br>      3 |      2<br>      3 |       <br>(5 rows)</code></pre>
              <pre
                name="6492"
                id="6492"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="fb16" id="fb16" class="graf graf--h3 graf-after--pre">
                18. When a query has no destination for result data in
                PostgreSQL
              </h3>
              <h3
                name="19be"
                id="19be"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="2378" id="2378" class="graf graf--p graf-after--h3">
                Say that while selecting a given function, we receive the error
                message below:
              </p>
              <pre
                name="c893"
                id="c893"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgresql=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> function f(n <strong class="markup--strong markup--pre-strong">int</strong>) <br>returns <strong class="markup--strong markup--pre-strong">int</strong> <br><strong class="markup--strong markup--pre-strong">as</strong> <br>$$ <br><strong class="markup--strong markup--pre-strong">begin</strong> <br><strong class="markup--strong markup--pre-strong">select</strong> now();<br>return 1;<br> <strong class="markup--strong markup--pre-strong">end</strong>; <br>$$ language &#39;plpgsql&#39;;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> f(9);<br>ERROR:  query has no destination for result data<br>HINT:  If you want to discard the results of a <strong class="markup--strong markup--pre-strong">SELECT</strong>, use PERFORM instead.</code></pre>
              <pre
                name="f08c"
                id="f08c"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="791b" id="791b" class="graf graf--p graf-after--pre">
                To avoid such errors, we can either use PERFORM or declare a
                variable and use it in a
                <a
                  href="https://www.postgresql.org/docs/9.1/sql-selectinto.html"
                  data-href="https://www.postgresql.org/docs/9.1/sql-selectinto.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >SELECT INTO</a
                >
                statement:
              </p>
              <h3 name="4e89" id="4e89" class="graf graf--h3 graf-after--p">
                Using PERFORM
              </h3>
              <h3
                name="9ece"
                id="9ece"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="e1f0"
                id="e1f0"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> function f(n <strong class="markup--strong markup--pre-strong">int</strong>) <br>returns <strong class="markup--strong markup--pre-strong">int</strong> <br><strong class="markup--strong markup--pre-strong">as</strong> <br>$$ <br><strong class="markup--strong markup--pre-strong">begin</strong> <br>perform<br>now(); <br> return 1; <br> <strong class="markup--strong markup--pre-strong">end</strong>; <br>$$ language &#39;plpgsql&#39;;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION<br>postgresql=# <strong class="markup--strong markup--pre-strong">select</strong> f(9);<br> f <br><em class="markup--em markup--pre-em">---</em><br> 1<br>(1 row)</code></pre>
              <pre
                name="4748"
                id="4748"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="da73" id="da73" class="graf graf--h3 graf-after--pre">
                Declaring a variable and using it in a SELECT INTO statement
              </h3>
              <h3
                name="e1df"
                id="e1df"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="dd15"
                id="dd15"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> function f(n <strong class="markup--strong markup--pre-strong">int</strong>) <br>returns <strong class="markup--strong markup--pre-strong">int</strong> <br><strong class="markup--strong markup--pre-strong">as</strong> <br>$$ <br><strong class="markup--strong markup--pre-strong">declare</strong> <br>a <strong class="markup--strong markup--pre-strong">date</strong>;<br><strong class="markup--strong markup--pre-strong">begin</strong> <br><strong class="markup--strong markup--pre-strong">select</strong> now() <strong class="markup--strong markup--pre-strong">into</strong> a;<br>raise notice ‘%s’,a; <br>return 1; <br><strong class="markup--strong markup--pre-strong">end</strong>; <br>$$ language &#39;plpgsql&#39;;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION<br> <br> <br>postgresql=# <strong class="markup--strong markup--pre-strong">select</strong> f(9);<br>          NOTICE: 24-SEP-20 13:15:46.23388s<br>             f<br>            <em class="markup--em markup--pre-em">---</em><br>            1<br>        (1 row)</code></pre>
              <pre
                name="3265"
                id="3265"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="8007" id="8007" class="graf graf--h3 graf-after--pre">
                19. Exporting query result to a text file in PostgreSQL
              </h3>
              <h3
                name="564e"
                id="564e"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="4e04" id="4e04" class="graf graf--p graf-after--h3">
                With the help of the
                <a
                  href="https://www.postgresql.org/docs/12/sql-copy.html"
                  data-href="https://www.postgresql.org/docs/12/sql-copy.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >COPY command</a
                >, we can export data from a table to an outside text file as
                well as import data from a text file into a table.
              </p>
              <h3 name="d728" id="d728" class="graf graf--h3 graf-after--p">
                Exporting data from a table to a text file
              </h3>
              <h3
                name="ec26"
                id="ec26"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="c3a8"
                id="c3a8"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em">#  copy dummy_table to &#39;/tmp/abc.txt&#39;;</em><br>COPY 5<br>  <br>postgres=<em class="markup--em markup--pre-em"># \! cat /tmp/abc.txt</em><br>XYZ	location-A	25<br>ABC	location-B	35<br>DEF	location-C	40<br>PQR	location-D	50<br>CXC	1	50</code></pre>
              <pre
                name="2c09"
                id="2c09"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="39d3" id="39d3" class="graf graf--h3 graf-after--pre">
                Importing data from a text file into a table
              </h3>
              <h3
                name="8f78"
                id="8f78"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="b375"
                id="b375"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># copy dummy_table from &#39;/tmp/abc.txt&#39;;</em><br>COPY 5</code></pre>
              <pre
                name="0374"
                id="0374"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3
                name="fca6"
                id="fca6"
                class="graf graf--h3 graf--empty graf-after--pre"
              >
                <br />
              </h3>
              <ul class="postList">
                <li name="8e52" id="8e52" class="graf graf--li graf-after--h3">
                  With the help of common table expressions (CTE):
                </li>
              </ul>
              <h3
                name="8b61"
                id="8b61"
                class="graf graf--h3 graf--empty graf-after--li"
              >
                <br />
              </h3>
              <h3
                name="247d"
                id="247d"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="1154"
                id="1154"
                class="graf graf--pre graf--empty graf-after--h3"
              ><br></pre>
              <ul class="postList">
                <li name="ddbe" id="ddbe" class="graf graf--li graf-after--pre">
                  <code
                    class="
                      markup--code markup--li-code
                      u-paddingRight0 u-marginRight0
                    "
                    >postgres=#WITH RECURSIVE cte AS (
                    <strong class="markup--strong markup--li-strong"
                      >SELECT</strong
                    >
                    emp_no, ename, manager_no, 1
                    <strong class="markup--strong markup--li-strong">AS</strong>
                    <strong class="markup--strong markup--li-strong"
                      >level</strong
                    >
                    <strong class="markup--strong markup--li-strong"
                      >FROM</strong
                    >
                    test_table
                    <strong class="markup--strong markup--li-strong"
                      >where</strong
                    >
                    manager_no
                    <strong class="markup--strong markup--li-strong">is</strong>
                    <strong class="markup--strong markup--li-strong"
                      >null</strong
                    >
                    <strong class="markup--strong markup--li-strong"
                      >UNION</strong
                    >
                    <strong class="markup--strong markup--li-strong"
                      >ALL</strong
                    >
                    <strong class="markup--strong markup--li-strong"
                      >SELECT</strong
                    >
                    e.emp_no, e.ename, e.manager_no, c.<strong
                      class="markup--strong markup--li-strong"
                      >level</strong
                    >
                    + 1
                    <strong class="markup--strong markup--li-strong"
                      >FROM</strong
                    >
                    cte c
                    <strong class="markup--strong markup--li-strong"
                      >JOIN</strong
                    >
                    test_table e
                    <strong class="markup--strong markup--li-strong">ON</strong>
                    e.manager_no = c.emp_no )
                    <strong class="markup--strong markup--li-strong"
                      >SELECT</strong
                    >
                    *
                    <strong class="markup--strong markup--li-strong"
                      >FROM</strong
                    >
                    cte; emp_no | ename | manager_no | level
                    <em class="markup--em markup--li-em"
                      >-----------+----------+------------------+-------</em
                    >
                    10 | A1 | | 1 11 | B1 | 10 | 2 12 | B2 | 10 | 2 13 | B3 | 10
                    | 2 14 | C1 | 13 | 3 17 | E1 | 11 | 3 18 | E2 | 11 | 3 15 |
                    C2 | 13 | 3 16 | D1 | 15 | 4 (9 rows) postgres=#</code
                  >
                </li>
              </ul>
              <pre
                name="4293"
                id="4293"
                class="graf graf--pre graf--empty graf-after--li"
              ><br></pre>
              <pre
                name="da4d"
                id="da4d"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <ol class="postList">
                <li
                  name="a513"
                  id="a513"
                  class="graf graf--li graf--empty graf-after--pre"
                >
                  <br />
                </li>
              </ol>
              <h3
                name="aa48"
                id="aa48"
                class="graf graf--h3 graf--empty graf-after--li"
              >
                <br />
              </h3>
              <ul class="postList">
                <li name="b6ad" id="b6ad" class="graf graf--li graf-after--h3">
                  Using the tablefunc extension:
                </li>
              </ul>
              <h3
                name="cd57"
                id="cd57"
                class="graf graf--h3 graf--empty graf-after--li"
              >
                <br />
              </h3>
              <h3
                name="5c66"
                id="5c66"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <ol class="postList">
                <li name="c6e2" id="c6e2" class="graf graf--li graf-after--h3">
                  The
                  <a
                    href="https://www.postgresql.org/docs/8.3/tablefunc.html"
                    data-href="https://www.postgresql.org/docs/8.3/tablefunc.html"
                    class="markup--anchor markup--li-anchor"
                    rel="noopener"
                    target="_blank"
                    >tablefunc extension</a
                  >
                  is a contrib module that resides in the contrib/ folder in
                  PostgreSQL sources.
                </li>
                <li name="2847" id="2847" class="graf graf--li graf-after--li">
                  First, create the tablefunc extension:
                </li>
              </ol>
              <pre
                name="6911"
                id="6911"
                class="graf graf--pre graf--empty graf-after--li"
              ><br></pre>
              <ul class="postList">
                <li name="3505" id="3505" class="graf graf--li graf-after--pre">
                  <code
                    class="
                      markup--code markup--li-code
                      u-paddingRight0 u-marginRight0
                    "
                    >postgres=#
                    <strong class="markup--strong markup--li-strong"
                      >CREATE</strong
                    >
                    EXTENSION tablefunc;
                    <strong class="markup--strong markup--li-strong"
                      >CREATE</strong
                    >
                    EXTENSION postgres=#</code
                  >
                </li>
              </ul>
              <pre
                name="d8b0"
                id="d8b0"
                class="graf graf--pre graf--empty graf-after--li"
              ><br></pre>
              <pre
                name="9286"
                id="9286"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <ol class="postList">
                <li name="b334" id="b334" class="graf graf--li graf-after--pre">
                  Then, use tablefunc’s connectby function to display results
                  hierarchically:
                </li>
              </ol>
              <pre
                name="11fb"
                id="11fb"
                class="graf graf--pre graf--empty graf-after--li"
              ><br></pre>
              <ul class="postList">
                <li name="e7f5" id="e7f5" class="graf graf--li graf-after--pre">
                  <code
                    class="
                      markup--code markup--li-code
                      u-paddingRight0 u-marginRight0
                    "
                    >postgres=# SELECT * FROM connectby(&#39;dummy_table&#39;,
                    &#39;emp_no&#39;, &#39;manager_no&#39;, &#39;10&#39;, 0,
                    &#39;-&gt;&#39;) AS t(emp_no
                    <strong class="markup--strong markup--li-strong">int</strong
                    >, manager_no
                    <strong class="markup--strong markup--li-strong">int</strong
                    >, level
                    <strong class="markup--strong markup--li-strong">int</strong
                    >, ord text) order by emp_no; emp_no | manager_no | level |
                    ord --------+------------+-------+---------------- 10 | | 0
                    | 10 11 | 10 | 1 | 10-&gt;11 12 | 10 | 1 | 10-&gt;12 13 | 10
                    | 1 | 10-&gt;13 14 | 13 | 2 | 10-&gt;13-&gt;14 15 | 13 | 2 |
                    10-&gt;13-&gt;15 16 | 15 | 3 | 10-&gt;13-&gt;15-&gt;16 17 |
                    11 | 2 | 10-&gt;11-&gt;17 18 | 11 | 2 | 10-&gt;11-&gt;18 (9
                    rows) postgres=#</code
                  >
                </li>
              </ul>
              <pre
                name="b66e"
                id="b66e"
                class="graf graf--pre graf--empty graf-after--li"
              ><br></pre>
              <pre
                name="e3b8"
                id="e3b8"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <ol class="postList">
                <li
                  name="8781"
                  id="8781"
                  class="graf graf--li graf--empty graf-after--pre"
                >
                  <br />
                </li>
              </ol>
              <h3 name="10ac" id="10ac" class="graf graf--h3 graf-after--li">
                20. Listing databases query in PostgreSQL
              </h3>
              <h3
                name="7254"
                id="7254"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="f67d" id="f67d" class="graf graf--p graf-after--h3">
                The following query can be used to show all the databases
                created:
              </p>
              <pre
                name="8635"
                id="8635"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> oid,datname <strong class="markup--strong markup--pre-strong">from</strong> pg_database;<br>  oid     |  datname  <br><em class="markup--em markup--pre-em">-----------+-----------</em><br> 13743 | postgres<br>     1     | template1<br> 13742 | template0<br>(3 rows)</code></pre>
              <pre
                name="cf69"
                id="cf69"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="332e" id="332e" class="graf graf--p graf-after--pre">
                We can also list out all the database names using the \l command
                at the psql prompt.
              </p>
              <h3 name="0e83" id="0e83" class="graf graf--h3 graf-after--p">
                21. Checking query execution time in PostgreSQL
              </h3>
              <h3
                name="4945"
                id="4945"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="0e1a" id="0e1a" class="graf graf--p graf-after--h3">
                We can check the time needed for a query to execute by enabling
                \timing at the psql prompt:
              </p>
              <pre
                name="90ec"
                id="90ec"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># \timing</em><br>Timing <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">on</strong>.</code></pre>
              <pre
                name="0ab2"
                id="0ab2"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="9114" id="9114" class="graf graf--p graf-after--pre">
                The SELECT query will now show the execution time:
              </p>
              <pre
                name="1867"
                id="1867"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+--------</em><br> XYZ  | location-A | 25<br> ABC  | location-B | 35<br> DEF  | location-C | 40<br> PQR  | location-D | 50<br> CXC  | 1               | 50<br>(5 rows)<br> <br>Time: 0.440 ms<br>postgres=#</code></pre>
              <pre
                name="f336"
                id="f336"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="92da" id="92da" class="graf graf--h3 graf-after--pre">
                22. Dynamic SQL query in PostgreSQL
              </h3>
              <h3
                name="212e"
                id="212e"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d00d" id="d00d" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.postgresql.org/docs/9.1/ecpg-dynamic.html"
                  data-href="https://www.postgresql.org/docs/9.1/ecpg-dynamic.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Dynamic SQL</a
                >
                is used to reduce repetitive tasks when it comes to querying.<br />Dynamic
                SQL queries are not cached in memory.
              </p>
              <pre
                name="b850"
                id="b850"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># do</em><br>postgres-<em class="markup--em markup--pre-em"># $$</em><br>postgres$# <strong class="markup--strong markup--pre-strong">begin</strong><br>postgres$# execute &#39;select * from dummy_table&#39;;<br>postgres$# <strong class="markup--strong markup--pre-strong">end</strong>;<br>postgres$# $$;<br>DO</code></pre>
              <pre
                name="4110"
                id="4110"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="48cc" id="48cc" class="graf graf--h3 graf-after--pre">
                23. COUNT query in PostgreSQL
              </h3>
              <h3
                name="589b"
                id="589b"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="8e13" id="8e13" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/8.2/functions-aggregate.html"
                  data-href="https://www.postgresql.org/docs/8.2/functions-aggregate.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >COUNT query</a
                >
                returns the number of rows in a table. If we use (*) this will
                include null values; otherwise null values will be excluded.
              </p>
              <pre
                name="18d3"
                id="18d3"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">count</strong>(*) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> count <br><em class="markup--em markup--pre-em">-------</em><br>     5<br>(1 row)<br> <br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">count</strong>(<strong class="markup--strong markup--pre-strong">avg</strong>) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> count <br><em class="markup--em markup--pre-em">-------</em><br>     4<br>(1 row)</code></pre>
              <pre
                name="b3b9"
                id="b3b9"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="7e54" id="7e54" class="graf graf--h3 graf-after--pre">
                24. LIMIT and OFFSET query in PostgreSQL
              </h3>
              <h3
                name="0c72"
                id="0c72"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="e575" id="e575" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/queries-limit.html"
                  data-href="https://www.postgresql.org/docs/12/queries-limit.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >LIMIT clause</a
                >
                is used to limit the data amount returned by the SELECT
                statement. The query below will display only 1 row:
              </p>
              <pre
                name="febd"
                id="febd"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table  limit 1;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br>(1 row)</code></pre>
              <pre
                name="58c8"
                id="58c8"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="0c98" id="0c98" class="graf graf--p graf-after--pre">
                <a
                  href="https://www.postgresql.org/docs/12/queries-limit.html"
                  data-href="https://www.postgresql.org/docs/12/queries-limit.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >OFFSET</a
                >
                is used when we want to skip a particular number of rows:
              </p>
              <pre
                name="8637"
                id="8637"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table  offset 4;<br> name | address | age <br><em class="markup--em markup--pre-em">------+---------+-----</em><br> cxc  | 1       |  50<br>(1 row)</code></pre>
              <pre
                name="980e"
                id="980e"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="1b8b" id="1b8b" class="graf graf--h3 graf-after--pre">
                25. IF … ELSE expression in PostgreSQL
              </h3>
              <h3
                name="1862"
                id="1862"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="9e72" id="9e72" class="graf graf--p graf-after--h3">
                We can use
                <a
                  href="https://www.postgresql.org/docs/9.1/plpgsql-control-structures.html"
                  data-href="https://www.postgresql.org/docs/9.1/plpgsql-control-structures.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >conditional statements</a
                >
                like IF ... ELSE in an anonymous block. The example below checks
                if the values of variables abc and xyz are matching and prints
                the result— i.e., 150:
              </p>
              <pre
                name="2330"
                id="2330"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">Do</strong> <br>             $$<br>             <strong class="markup--strong markup--pre-strong">Declare</strong><br>              abc <strong class="markup--strong markup--pre-strong">int</strong>;<br>              xyz int;<br>              <strong class="markup--strong markup--pre-strong">begin</strong><br>              abc:=100;<br>              xyz:=abc;<br>              if abc=xyz then <br>               xyz=150;  <br>              raise notice &#39;%&#39;,xyz;<br>             else<br>             <strong class="markup--strong markup--pre-strong">end</strong> <strong class="markup--strong markup--pre-strong">if</strong>;               <br>             <strong class="markup--strong markup--pre-strong">end</strong>;<br>               $$<br>;<br>NOTICE:  150<br><strong class="markup--strong markup--pre-strong">DO</strong></code></pre>
              <pre
                name="9304"
                id="9304"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="ba88" id="ba88" class="graf graf--h3 graf-after--pre">
                26. UPDATE with JOIN query in PostgreSQL
              </h3>
              <h3
                name="4595"
                id="4595"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="c981" id="c981" class="graf graf--p graf-after--h3">
                We can use UPDATE with a JOIN and WHERE clause when we want to
                update the values from one table (table X) based on values from
                another table (table Y):
              </p>
              <pre
                name="6dde"
                id="6dde"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> X(n <strong class="markup--strong markup--pre-strong">int</strong>, n1 <strong class="markup--strong markup--pre-strong">char</strong>(10));<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> X <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;abc&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> X <strong class="markup--strong markup--pre-strong">values</strong> (2,&#39;xyz&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> X <strong class="markup--strong markup--pre-strong">values</strong> (3,&#39;pqr&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br>postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> Y(n <strong class="markup--strong markup--pre-strong">int</strong>, n1 <strong class="markup--strong markup--pre-strong">char</strong>(10));<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> Y <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> Y <strong class="markup--strong markup--pre-strong">values</strong> (2,&#39;&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> Y <strong class="markup--strong markup--pre-strong">values</strong> (5,&#39;axyz&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br>postgres=# <strong class="markup--strong markup--pre-strong">update</strong> Y <strong class="markup--strong markup--pre-strong">set</strong> n1=X.n1 <strong class="markup--strong markup--pre-strong">from</strong> X  <strong class="markup--strong markup--pre-strong">where</strong> X.n=Y.n;<br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 2<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> Y;<br> n |     n1     <br><em class="markup--em markup--pre-em">---+------------</em><br> 5 | axyz      <br> 1 | abc       <br> 2 | xyz       <br>(3 rows)<br><br>postgres=#</code></pre>
              <pre
                name="07b0"
                id="07b0"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="d75b" id="d75b" class="graf graf--h3 graf-after--pre">
                27. INNER JOIN query in PostgreSQL
              </h3>
              <h3
                name="408e"
                id="408e"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d2ca" id="d2ca" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/current/tutorial-join.html"
                  data-href="https://www.postgresql.org/docs/current/tutorial-join.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >INNER JOIN</a
                >
                command will find rows from two (or more) tables where the
                specified columns data in the tables match:
              </p>
              <pre
                name="b1f7"
                id="b1f7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> *  <strong class="markup--strong markup--pre-strong">from</strong> x <strong class="markup--strong markup--pre-strong">inner</strong> <strong class="markup--strong markup--pre-strong">join</strong>  y <strong class="markup--strong markup--pre-strong">on</strong>  x.n1 = y.n1;<br> n |     n1     | n |     n1     <br><em class="markup--em markup--pre-em">---+------------+---+------------</em><br> 1 | abc        | 1 | abc       <br> 2 | xyz        | 2 | xyz       <br>(2 rows)<br><br>postgres=#</code></pre>
              <pre
                name="4806"
                id="4806"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="41f2" id="41f2" class="graf graf--h3 graf-after--pre">
                28. CASE expression in PostgreSQL
              </h3>
              <h3
                name="4751"
                id="4751"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="2698" id="2698" class="graf graf--p graf-after--h3">
                The
                <a
                  href="https://www.postgresql.org/docs/12/functions-conditional.html"
                  data-href="https://www.postgresql.org/docs/12/functions-conditional.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >CASE expression</a
                >
                is a generic conditional expression, similar to the IF … ELSE
                statement.
              </p>
              <pre
                name="2c5c"
                id="2c5c"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">SELECT</strong> age,<br>       <strong class="markup--strong markup--pre-strong">CASE</strong> age <strong class="markup--strong markup--pre-strong">WHEN</strong> 25 <strong class="markup--strong markup--pre-strong">THEN</strong> &#39;one&#39;<br>              <strong class="markup--strong markup--pre-strong">WHEN</strong> 50 <strong class="markup--strong markup--pre-strong">THEN</strong> &#39;two&#39;<br>              <strong class="markup--strong markup--pre-strong">ELSE</strong> &#39;other&#39;<br>       <strong class="markup--strong markup--pre-strong">END</strong><br>    <strong class="markup--strong markup--pre-strong">FROM</strong>  dummy_table;<br> age | case  <br><em class="markup--em markup--pre-em">-----+-------</em><br>  25 | one<br>  35 | other<br>  40 | other<br>  50 | two<br>  50 | two<br>(5 rows)</code></pre>
              <pre
                name="7d51"
                id="7d51"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="70c1" id="70c1" class="graf graf--h3 graf-after--pre">
                29. PostgreSQL recursive query
              </h3>
              <h3
                name="b926"
                id="b926"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="d300" id="d300" class="graf graf--p graf-after--h3">
                Recursive queries are used to deal with hierarchical queries or
                tree-structured data. The structure of a WITH RECURSIVE query is
                always: a) Non-recursive term<br />  b) UNION (or UNION ALL),
                then a recursive term
              </p>
              <p name="a81d" id="a81d" class="graf graf--p graf-after--p">
                where the recursive term includes a reference to the query&#39;s
                output.
              </p>
              <pre
                name="c651"
                id="c651"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> emp_test (<br>  id <strong class="markup--strong markup--pre-strong">int</strong>,<br>  ename <strong class="markup--strong markup--pre-strong">varchar</strong>(255),<br>  emanager <strong class="markup--strong markup--pre-strong">int</strong><br>);<br><br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (1, &#39;abc&#39;, <strong class="markup--strong markup--pre-strong">null</strong>);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (2, &#39;xyz&#39;, 1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (3, &#39;def&#39;, 2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (4, &#39;cde&#39;, 1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (5, &#39;qrs&#39;, 2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (9, &#39;iop&#39;, 3);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (10, &#39;klm&#39;, 4);</code></pre>
              <pre
                name="6de8"
                id="6de8"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="6dad" id="6dad" class="graf graf--p graf-after--pre">
                The recursive query below will give all the reports in a certain
                order:
              </p>
              <pre
                name="da1b"
                id="da1b"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=#WITH RECURSIVE emp_testnew  AS (<br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> id, ename, emanager<br>  <strong class="markup--strong markup--pre-strong">FROM</strong> emp_test<br>  <strong class="markup--strong markup--pre-strong">WHERE</strong> id = 2<br>  <strong class="markup--strong markup--pre-strong">UNION</strong> <strong class="markup--strong markup--pre-strong">ALL</strong><br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> e.id, e.ename, e.emanager<br>  <strong class="markup--strong markup--pre-strong">FROM</strong> emp_test e<br>  <strong class="markup--strong markup--pre-strong">INNER</strong> <strong class="markup--strong markup--pre-strong">JOIN</strong> emp_testnew e1 <strong class="markup--strong markup--pre-strong">ON</strong> e1.id = e.emanager<br>)<br><strong class="markup--strong markup--pre-strong">SELECT</strong> *<br><strong class="markup--strong markup--pre-strong">FROM</strong> emp_testnew;<br><br> id | ename | emanager <br><em class="markup--em markup--pre-em">----+-------+----------</em><br>  2 | xyz   |        1<br>  3 | def   |        2<br>  5 | qrs   |        2<br>  9 | iop   |        3<br>(4 rows)<br><br>postgres=#</code></pre>
              <pre
                name="3337"
                id="3337"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="7ab4" id="7ab4" class="graf graf--h3 graf-after--pre">
                30. PostgreSQL log queries
              </h3>
              <h3
                name="4f18"
                id="4f18"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="43dd" id="43dd" class="graf graf--p graf-after--h3">
                Using the
                <a
                  href="https://www.postgresql.org/docs/12/pgstatstatements.html"
                  data-href="https://www.postgresql.org/docs/12/pgstatstatements.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >pg_stat_statements module</a
                >, we can track execution statistics for all SQL statements. To
                do this, we need to create an extension and add in
                shared_preload_libraries inside the postgresql.conf file:
              </p>
              <pre
                name="d134"
                id="d134"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> extension pg_stat_statements;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> EXTENSION<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">show</strong> shared_preload_libraries ;<br>                           shared_preload_libraries                           <br><em class="markup--em markup--pre-em">-------------------------------------------------</em><br> $libdir/pg_stat_statements<br>(1 row)<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> query <strong class="markup--strong markup--pre-strong">from</strong> pg_stat_statements <strong class="markup--strong markup--pre-strong">where</strong> query <strong class="markup--strong markup--pre-strong">like</strong> &#39;create table%&#39;;<br>-[ RECORD 1 ]<em class="markup--em markup--pre-em">-------------------</em><br>query | <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> test(n <strong class="markup--strong markup--pre-strong">int</strong>)</code></pre>
              <pre
                name="10ff"
                id="10ff"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="f4a3" id="f4a3" class="graf graf--p graf-after--pre">
                We can also configure PostgreSQL to generate log output by
                enabling these parameters in the postgresql.conf file:
              </p>
              <pre
                name="2856"
                id="2856"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">logging_collector = on<br>log_directory = &#39;log&#39;<br>log_filename = ‘postgresql-%Y-%m-%d_%H%M%S.<strong class="markup--strong markup--pre-strong">log</strong>&#39;<br>log_destination = ‘stderr’<br>Log file will be created under the pg_log directory which resides under the data folder. <br><br>[centos@tushar-ldap-docker bin]$ ls  data/log<br>postgresql-2020-09-17_150932.log  postgresql-2020-09-19_000000.log  <br>[centos@tushar-ldap-docker bin]$</code></pre>
              <pre
                name="5220"
                id="5220"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="d999" id="d999" class="graf graf--p graf-after--pre">
                Queries will be recorded in these files.
              </p>
              <h3 name="d8b8" id="d8b8" class="graf graf--h3 graf-after--p">
                31. Using a variable in a PostgreSQL query
              </h3>
              <h3
                name="1f6f"
                id="1f6f"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="17a1" id="17a1" class="graf graf--p graf-after--h3">
                We can declare a variable in PostgreSQL at the psql prompt:
              </p>
              <pre
                name="2cc7"
                id="2cc7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># \set cond 50</em></code></pre>
              <pre
                name="c02e"
                id="c02e"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="7ac8" id="7ac8" class="graf graf--h3 graf-after--pre">
                Using a variable in a WHERE condition
              </h3>
              <h3
                name="97d7"
                id="97d7"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="7f28"
                id="7f28"
                class="graf graf--pre graf-after--h3"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=:cond;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> PQR  | location-D |  50<br>(1 row)</code></pre>
              <pre
                name="39e8"
                id="39e8"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="88a1" id="88a1" class="graf graf--p graf-after--pre">
                OR
              </p>
              <pre
                name="bddb"
                id="bddb"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# \<strong class="markup--strong markup--pre-strong">set</strong> cond 50<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> :cond+100 ;<br> ?column? <br><em class="markup--em markup--pre-em">----------</em><br>      150<br>(1 row)</code></pre>
              <pre
                name="6120"
                id="6120"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="8142" id="8142" class="graf graf--h3 graf-after--pre">
                32. Date query in PostgreSQL
              </h3>
              <h3
                name="8cb8"
                id="8cb8"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="ebd8" id="ebd8" class="graf graf--p graf-after--h3">
                PostgreSQL offers
                <a
                  href="https://www.postgresql.org/docs/12/functions-datetime.html"
                  data-href="https://www.postgresql.org/docs/12/functions-datetime.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >functions for date and time</a
                >
                that can be used in queries.
              </p>
              <pre
                name="47ad"
                id="47ad"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> now();<br>               now                <br><em class="markup--em markup--pre-em">----------------------------------</em><br> 22-SEP-20 03:08:42.636385 +05:30<br>(1 row)<br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">current_date</strong>;<br> current_date <br><em class="markup--em markup--pre-em">--------------</em><br> 22-SEP-20<br>(1 row)<br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">current_time</strong>;<br>     current_time      <br><em class="markup--em markup--pre-em">-----------------------</em><br> 03:08:53.648466+05:30<br>(1 row)</code></pre>
              <pre
                name="f4da"
                id="f4da"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="8492" id="8492" class="graf graf--p graf-after--pre">
                We can also perform a date range query to find rows with values
                between two time stamps:
              </p>
              <pre
                name="92f2"
                id="92f2"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> datetable(n <strong class="markup--strong markup--pre-strong">int</strong>,n1 <strong class="markup--strong markup--pre-strong">date</strong>);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> datetable <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;12-01-1980&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> datetable <strong class="markup--strong markup--pre-strong">values</strong> (2,&#39;12-01-2020&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> datetable <strong class="markup--strong markup--pre-strong">values</strong> (3,&#39;12-01-2000&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> datetable <strong class="markup--strong markup--pre-strong">where</strong> n1 between &#39;12-01-1980&#39; <strong class="markup--strong markup--pre-strong">and</strong> &#39;12-01-2000&#39;;<br> n |         n1         <br><em class="markup--em markup--pre-em">---+--------------------</em><br> 1 | 12-JAN-80 00:00:00<br> 3 | 12-JAN-00 00:00:00<br>(2 rows)</code></pre>
              <pre
                name="d9d3"
                id="d9d3"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="218f" id="218f" class="graf graf--h3 graf-after--pre">
                33. PostgreSQL function RETURN QUERY result
              </h3>
              <h3
                name="1c49"
                id="1c49"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="af8d" id="af8d" class="graf graf--p graf-after--h3">
                When a PL/pgSQL function is declared to return a SETOF some data
                type, the return is specified by a
                <a
                  href="https://www.postgresql.org/docs/12/plpgsql-control-structures.html"
                  data-href="https://www.postgresql.org/docs/12/plpgsql-control-structures.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >RETURN QUERY</a
                >
                command:
              </p>
              <pre
                name="f09e"
                id="f09e"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION <strong class="markup--strong markup--pre-strong">get</strong>(<strong class="markup--strong markup--pre-strong">int</strong>) RETURNS SETOF <strong class="markup--strong markup--pre-strong">integer</strong> <strong class="markup--strong markup--pre-strong">AS</strong><br>$BODY$<br><strong class="markup--strong markup--pre-strong">BEGIN</strong><br>    RETURN QUERY <strong class="markup--strong markup--pre-strong">SELECT</strong> age<br>                   <strong class="markup--strong markup--pre-strong">FROM</strong> dummy_table<br>                  <strong class="markup--strong markup--pre-strong">WHERE</strong> age &gt;= $1  ;<br>    RETURN;<br> <strong class="markup--strong markup--pre-strong">END</strong><br>$BODY$<br><strong class="markup--strong markup--pre-strong">LANGUAGE</strong> plpgsql;<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">get</strong>(9);<br> get <br><em class="markup--em markup--pre-em">-----</em><br>  25<br>  35<br>  40<br>  50<br>(4 rows)</code></pre>
              <pre
                name="dcc8"
                id="dcc8"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="4e37" id="4e37" class="graf graf--h3 graf-after--pre">
                34. PostgreSQL parallel query performance
              </h3>
              <h3
                name="4286"
                id="4286"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="1f00" id="1f00" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.postgresql.org/docs/12/parallel-query.html"
                  data-href="https://www.postgresql.org/docs/12/parallel-query.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Parallel queries</a
                >
                in PostgreSQL allow you to finish queries faster by utilizing
                many CPUs. These GUCs parameters are set in postgresql.conf
                file:
              </p>
              <pre
                name="76eb"
                id="76eb"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--pre-em">#max_parallel_maintenance_workers = 2   # taken from max_parallel_workers</em><br><em class="markup--em markup--pre-em">#max_parallel_workers_per_gather = 2    # taken from max_parallel_workers</em><br><em class="markup--em markup--pre-em">#parallel_leader_participation = on</em><br><em class="markup--em markup--pre-em">#max_parallel_workers = 8               # maximum number of max_worker_processes that</em><br>                                                           <em class="markup--em markup--pre-em"># can be used in parallel operations</em><br><br><br>postgres=<em class="markup--em markup--pre-em"># create table ty(n int);</em><br>CREATE TABLE<br>postgres=<em class="markup--em markup--pre-em"># insert into ty values (generate_series(1,300000));</em><br>INSERT 0 300000<br><br>postgres=<em class="markup--em markup--pre-em"># analyze ty;</em><br>ANALYZE<br>postgres=<em class="markup--em markup--pre-em"># explain  select * from ty where n&lt;=1;</em><br>                             QUERY PLAN                              <br>---------------------------------------------------------------------<br> Gather  (cost=1000.00..4536.88 rows=30 width=4)<br>   Workers Planned: 1<br>   -&gt;  Parallel Seq Scan <strong class="markup--strong markup--pre-strong">on</strong> ty  (cost=0.00..3533.88 rows=18 width=4)<br>         Filter: (n &lt;= 1)<br>(4 rows)<br><br>postgres=<em class="markup--em markup--pre-em">#</em></code></pre>
              <pre
                name="d59b"
                id="d59b"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="cc40" id="cc40" class="graf graf--h3 graf-after--pre">
                35. Logical operators in PostgreSQL
              </h3>
              <h3
                name="6d9b"
                id="6d9b"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="535f" id="535f" class="graf graf--p graf-after--h3">
                There are three basic
                <a
                  href="https://www.postgresql.org/docs/12/functions-logical.html"
                  data-href="https://www.postgresql.org/docs/12/functions-logical.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >logical operators</a
                >
                available in PostgreSQL: AND, OR, and NOT.
              </p>
              <p name="c1a4" id="c1a4" class="graf graf--p graf-after--p">
                These operators are used to match conditions in SQL
                statements—e.g., in WHERE and HAVING clauses.
              </p>
              <pre
                name="1646"
                id="1646"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">AND = <strong class="markup--strong markup--pre-strong">when</strong> both boolean expressions are <strong class="markup--strong markup--pre-strong">true</strong> <strong class="markup--strong markup--pre-strong">then</strong> it will <strong class="markup--strong markup--pre-strong">return</strong> TRUE<br>OR   = <strong class="markup--strong markup--pre-strong">when</strong> any boolean expression <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">true</strong> <strong class="markup--strong markup--pre-strong">then</strong> it will <strong class="markup--strong markup--pre-strong">return</strong> TRUE<br>NOT = reverses the value <strong class="markup--strong markup--pre-strong">of</strong> Boolean operator</code></pre>
              <pre
                name="d538"
                id="d538"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="b77e" id="b77e" class="graf graf--h3 graf-after--pre">
                Some logical operator examples
              </h3>
              <h3
                name="9bba"
                id="9bba"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <pre
                name="6c39"
                id="6c39"
                class="graf graf--pre graf--empty graf-after--h3"
              ><br></pre>
              <pre
                name="50fe"
                id="50fe"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <ul class="postList">
                <li name="d614" id="d614" class="graf graf--li graf-after--pre">
                  <code class="markup--code markup--li-code"
                    >If both expressions are true, then the result is TRUE.
                    postgresql=# select 1=1/1 and 200=2+198 as
                    result_and_operator; result_and_operator
                    --------------------- t (1 row) postgresql=#</code
                  >
                </li>
                <li name="c7c1" id="c7c1" class="graf graf--li graf-after--li">
                  <code class="markup--code markup--li-code"
                    >If one expression is true and another expression is NULL,
                    then the result is NULL. postgresql=# select 4=4 and
                    null; ?column? ---------- (1 row)</code
                  >
                </li>
                <li name="8c12" id="8c12" class="graf graf--li graf-after--li">
                  <code class="markup--code markup--li-code"
                    >If one expression is true and another expression is false,
                    then the result is TRUE. postgres=# select 1=100 OR
                    2=2; ?column? ---------- t (1 row)</code
                  >
                </li>
              </ul>
              <h3 name="0be4" id="0be4" class="graf graf--h3 graf-after--li">
                36. Catching duplicate rows in a PostgreSQL table
              </h3>
              <h3
                name="9f5d"
                id="9f5d"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="36f7" id="36f7" class="graf graf--p graf-after--h3">
                In the following SQL query, there are two records with the value
                50:
              </p>
              <pre
                name="8851"
                id="8851"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> age <br><em class="markup--em markup--pre-em">-----</em><br>  25<br>  35<br>  40<br>  50<br>  50<br>(5 rows)</code></pre>
              <pre
                name="4f3c"
                id="4f3c"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="ca41" id="ca41" class="graf graf--p graf-after--pre">
                We can use the following SELECT … HAVING query to find the
                duplicate rows:
              </p>
              <pre
                name="5210"
                id="5210"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=#  <strong class="markup--strong markup--pre-strong">select</strong> age, <strong class="markup--strong markup--pre-strong">count</strong>(age) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">group</strong> <strong class="markup--strong markup--pre-strong">by</strong> age <strong class="markup--strong markup--pre-strong">having</strong> <strong class="markup--strong markup--pre-strong">count</strong>(age)&gt;1;<br> age | count <br><em class="markup--em markup--pre-em">-----+-------</em><br>  50 |     2<br>(1 row)</code></pre>
              <pre
                name="9fce"
                id="9fce"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="4e86" id="4e86" class="graf graf--h3 graf-after--pre">
                37. Enum query in PostgreSQL
              </h3>
              <h3
                name="310a"
                id="310a"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="151f" id="151f" class="graf graf--p graf-after--h3">
                <a
                  href="https://www.postgresql.org/docs/12/datatype-enum.html"
                  data-href="https://www.postgresql.org/docs/12/datatype-enum.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >Enumerated (enum) types</a
                >
                are data types that comprise a static, ordered set of values.
              </p>
              <pre
                name="0f3d"
                id="0f3d"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">CREATE</strong> TYPE mood <strong class="markup--strong markup--pre-strong">AS</strong> ENUM (&#39;sad&#39;, &#39;ok&#39;, &#39;happy&#39;);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> TYPE<br>postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> testi(n <strong class="markup--strong markup--pre-strong">int</strong>, n1 mood);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testi <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;happy&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testi <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;sad&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testi <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;ok&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1</code></pre>
              <pre
                name="043b"
                id="043b"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="5adb" id="5adb" class="graf graf--p graf-after--pre">
                If the enum has not been specified, it will give an error:
              </p>
              <pre
                name="1cc9"
                id="1cc9"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<strong class="markup--strong markup--pre-strong"># insert into testi values (1,&#39;happyo&#39;);</strong><br>ERROR:  invalid input <strong class="markup--strong markup--pre-strong">value</strong> <strong class="markup--strong markup--pre-strong">for</strong> <strong class="markup--strong markup--pre-strong">enum</strong> mood: &quot;happyo&quot;</code></pre>
              <pre
                name="cd4f"
                id="cd4f"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="270a" id="270a" class="graf graf--h3 graf-after--pre">
                38. Pivot query in PostgreSQL
              </h3>
              <h3
                name="50e9"
                id="50e9"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="ddb4" id="ddb4" class="graf graf--p graf-after--h3">
                A pivot table is a useful way to analyze large quantities of
                data by organizing it into a more manageable format.
              </p>
              <pre
                name="c122"
                id="c122"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> newtb(id SERIAL, rowid <strong class="markup--strong markup--pre-strong">varchar</strong>(10), attri <strong class="markup--strong markup--pre-strong">varchar</strong>(10), val <strong class="markup--strong markup--pre-strong">varchar</strong>(10));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a1&#39;,&#39;v1&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a2&#39;,&#39;v2&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a3&#39;,&#39;v3&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a4&#39;,&#39;v4&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a1&#39;,&#39;v5&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a2&#39;,&#39;v6&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a3&#39;,&#39;v7&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a4&#39;,&#39;v8&#39;);</code></pre>
              <pre
                name="f895"
                id="f895"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="219e" id="219e" class="graf graf--p graf-after--pre">
                To create a pivot table you need to install the
                <a
                  href="https://www.postgresql.org/docs/12/tablefunc.html"
                  data-href="https://www.postgresql.org/docs/12/tablefunc.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >tablefunc extension</a
                >:
              </p>
              <pre
                name="6ec7"
                id="6ec7"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> extension tablefunc;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> EXTENSION<br><br><strong class="markup--strong markup--pre-strong">Select</strong> *<br><strong class="markup--strong markup--pre-strong">FROM</strong> crosstab(<br>  &#39;select rowid, attri, val<br>   from newtb<br>   where attri = &#39;&#39;a2&#39;&#39; or attri = &#39;&#39;a3&#39;&#39;<br>   order by 1,2&#39;)<br><strong class="markup--strong markup--pre-strong">AS</strong> newtb(row_name <strong class="markup--strong markup--pre-strong">varchar</strong>(10), category_1 <strong class="markup--strong markup--pre-strong">varchar</strong>(10), category_2 <strong class="markup--strong markup--pre-strong">varchar</strong>(10), category_3 <strong class="markup--strong markup--pre-strong">varchar</strong>(10));<br> row_name | category_1 | category_2 | category_3 <br><em class="markup--em markup--pre-em">----------+------------+------------+--------------------------</em><br>   t1       |              v2        |            v3    | <br>   t2       |             v6         |             v7   | <br>(2 rows)</code></pre>
              <pre
                name="ff14"
                id="ff14"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="d1aa" id="d1aa" class="graf graf--h3 graf-after--pre">
                39. SELF JOIN query in PostgreSQL
              </h3>
              <h3
                name="d787"
                id="d787"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="209d" id="209d" class="graf graf--p graf-after--h3">
                When we join a table against itself, this is called a SELF JOIN.
                This can be done using INNER JOIN or LEFT JOIN. SELF JOINs are
                useful when comparing the columns of rows within the same table:
              </p>
              <pre
                name="4acb"
                id="4acb"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> emp1(emp_id <strong class="markup--strong markup--pre-strong">int</strong>, firstname <strong class="markup--strong markup--pre-strong">char</strong>(10), lastname <strong class="markup--strong markup--pre-strong">char</strong>(10) , manager_id <strong class="markup--strong markup--pre-strong">int</strong>);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <br>postgres=# <br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(1,&#39;ABC&#39;,&#39;XYZ&#39;,<strong class="markup--strong markup--pre-strong">NULL</strong>);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(2,&#39;TYU&#39;,&#39;BGV&#39;,1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(3,&#39;TEU&#39;,&#39;ZZV&#39;,1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(4,&#39;REU&#39;,&#39;AZV&#39;,2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(5,&#39;QREU&#39;,&#39;WZV&#39;,2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(6,&#39;DREU&#39;,&#39;QZV&#39;,3);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> a.firstname,b.lastname <strong class="markup--strong markup--pre-strong">from</strong> emp1 a <strong class="markup--strong markup--pre-strong">inner</strong> <strong class="markup--strong markup--pre-strong">join</strong> emp1 b <strong class="markup--strong markup--pre-strong">on</strong> a.emp_id=b.manager_id <strong class="markup--strong markup--pre-strong">order</strong> <strong class="markup--strong markup--pre-strong">by</strong> 1 ;<br> firstname  |  lastname  <br><em class="markup--em markup--pre-em">------------+------------</em><br> ABC        | ZZV       <br> ABC        | BGV       <br> TEU        | QZV       <br> TYU        | WZV       <br> TYU        | AZV       <br>(5 rows)<br><br>postgres=#</code></pre>
              <pre
                name="cc63"
                id="cc63"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="8799" id="8799" class="graf graf--h3 graf-after--pre">
                40. Parent-child recursive query in PostgreSQL
              </h3>
              <h3
                name="5dc1"
                id="5dc1"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="7062" id="7062" class="graf graf--p graf-after--h3">
                With the help of
                <a
                  href="https://www.postgresql.org/docs/12/queries-with.html"
                  data-href="https://www.postgresql.org/docs/12/queries-with.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >common table expressions</a
                >
                (CTE) we can perform parent-child recursive queries:
              </p>
              <pre
                name="e248"
                id="e248"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> recu_pc (<br> id SERIAL <strong class="markup--strong markup--pre-strong">PRIMARY</strong> <strong class="markup--strong markup--pre-strong">KEY</strong>,<br> name <strong class="markup--strong markup--pre-strong">varchar</strong>(10) <strong class="markup--strong markup--pre-strong">NOT</strong> <strong class="markup--strong markup--pre-strong">NULL</strong>,<br> parent_id <strong class="markup--strong markup--pre-strong">integer</strong> );<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br> <br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> recu_pc <strong class="markup--strong markup--pre-strong">values</strong> (1, &#39;Grandmother&#39;, <strong class="markup--strong markup--pre-strong">NULL</strong>);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> recu_pc <strong class="markup--strong markup--pre-strong">values</strong> (2, &#39;mother&#39;, 1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> recu_pc <strong class="markup--strong markup--pre-strong">values</strong> (3, &#39;daughter&#39;, 2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br> <br>postgres=# <strong class="markup--strong markup--pre-strong">WITH</strong> RECURSIVE rec_q (id) <strong class="markup--strong markup--pre-strong">as</strong><br>(          <br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> recu_pc.id, recu_pc.name <strong class="markup--strong markup--pre-strong">from</strong> recu_pc <strong class="markup--strong markup--pre-strong">where</strong> name=&#39;mother&#39;<br>  <strong class="markup--strong markup--pre-strong">UNION</strong> <strong class="markup--strong markup--pre-strong">ALL</strong><br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> recu_pc.id, recu_pc.name <strong class="markup--strong markup--pre-strong">from</strong> rec_q, recu_pc <strong class="markup--strong markup--pre-strong">where</strong> recu_pc.parent_id = rec_q.id<br>  )<br><strong class="markup--strong markup--pre-strong">SELECT</strong> *<br><strong class="markup--strong markup--pre-strong">FROM</strong> rec_q;<br> id |   name   <br><em class="markup--em markup--pre-em">----+----------</em><br>  2 | mother<br>  3 | daughter<br>(2 rows)</code></pre>
              <pre
                name="01e5"
                id="01e5"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="f973" id="f973" class="graf graf--h3 graf-after--pre">
                41. Defining a variable in a query in PostgreSQL
              </h3>
              <h3
                name="cbb1"
                id="cbb1"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="55d5" id="55d5" class="graf graf--p graf-after--h3">
                Using an
                <a
                  href="https://www.postgresql.org/docs/12/sql-do.html"
                  data-href="https://www.postgresql.org/docs/12/sql-do.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >anonymous block</a
                >, we can define a variable that can be passed to in a query:
              </p>
              <pre
                name="b4af"
                id="b4af"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">do</strong> <br>$$<br><strong class="markup--strong markup--pre-strong">declare</strong> <br>a <strong class="markup--strong markup--pre-strong">int</strong>;<br><strong class="markup--strong markup--pre-strong">begin</strong> <br><strong class="markup--strong markup--pre-strong">select</strong> age <strong class="markup--strong markup--pre-strong">into</strong> a <strong class="markup--strong markup--pre-strong">from</strong> dummy_table  <br><strong class="markup--strong markup--pre-strong">where</strong> name =&#39;XYZ&#39;;<br>raise notice &#39;%&#39;,a; <br><strong class="markup--strong markup--pre-strong">end</strong>;<br>$$;<br>NOTICE:  25<br><strong class="markup--strong markup--pre-strong">DO</strong></code></pre>
              <pre
                name="bfec"
                id="bfec"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="9045" id="9045" class="graf graf--h3 graf-after--pre">
                42. PREPARE statement in PostgreSQL
              </h3>
              <h3
                name="29da"
                id="29da"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="6a4d" id="6a4d" class="graf graf--p graf-after--h3">
                A prepared statement is used to optimize performance. When the
                <a
                  href="https://www.postgresql.org/docs/12/sql-prepare.html"
                  data-href="https://www.postgresql.org/docs/12/sql-prepare.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >PREPARE statement</a
                >
                is executed, it is not only parsed but analyzed too, and when we
                fire the EXECUTE command the prepared statement is planned and
                executed.
              </p>
              <p name="b062" id="b062" class="graf graf--p graf-after--p">
                Prepared statements can accept parameters.
              </p>
              <pre
                name="922a"
                id="922a"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<strong class="markup--strong markup--pre-strong"># prepare test(int) as </strong><br><strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=$1;<br>PREPARE<br> <br>postgres=<strong class="markup--strong markup--pre-strong"># execute test(50);</strong><br> name |  address   | age <br>------+------------+---------<br> PQR  | location-D |  50<br> CXC | 1                |  50<br>(2 rows)</code></pre>
              <pre
                name="7c98"
                id="7c98"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <h3 name="5583" id="5583" class="graf graf--h3 graf-after--pre">
                43. Checking NULL values in PostgreSQL
              </h3>
              <h3
                name="d8a3"
                id="d8a3"
                class="graf graf--h3 graf--empty graf-after--h3"
              >
                <br />
              </h3>
              <p name="79ae" id="79ae" class="graf graf--p graf-after--h3">
                To Identify or select rows that have NULL values, the
                <a
                  href="https://www.postgresql.org/docs/12/functions-comparison.html"
                  data-href="https://www.postgresql.org/docs/12/functions-comparison.html"
                  class="markup--anchor markup--p-anchor"
                  rel="noopener"
                  target="_blank"
                  >IS NULL</a
                >
                condition can be used in the WHERE clause.
              </p>
              <pre
                name="03eb"
                id="03eb"
                class="graf graf--pre graf-after--p"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br> PQR  | location-D |  54<br> PQR  | location-D |    <br>(5 rows)</code></pre>
              <pre
                name="095a"
                id="095a"
                class="graf graf--pre graf--empty graf-after--pre"
              ><br></pre>
              <p name="3187" id="3187" class="graf graf--p graf-after--pre">
                Identifying null values in ‘age’ column:
              </p>
              <pre
                name="8219"
                id="8219"
                class="graf graf--pre graf-after--p graf--trailing"
              ><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> name <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">null</strong>;<br> name <br><em class="markup--em markup--pre-em">------</em><br> PQR<br>(1 row)</code></pre>
            </div>
          </div>
        </section>
      </section>
      <footer>
        <p><a href="https://medium.com/p/19fba3e37110">View original.</a></p>
        <p>
          Exported from <a href="https://medium.com">Medium</a> on July 13,
          2021.
        </p>
      </footer>
    </article>
  </body>
</html>
