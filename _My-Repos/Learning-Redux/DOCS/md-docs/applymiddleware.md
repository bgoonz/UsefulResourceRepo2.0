<a href="https://redux.js.org/" class="navbar__brand"><img src="https://d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo" /><strong>Redux</strong></a>

<a href="https://redux.js.org/introduction/getting-started" class="navbar__item navbar__link">Getting Started</a><a href="https://redux.js.org/tutorials/essentials/part-1-overview-concepts" class="navbar__item navbar__link">Tutorial</a><a href="https://redux.js.org/api/api-reference" class="navbar__item navbar__link">API</a><a href="https://redux.js.org/faq" class="navbar__item navbar__link">FAQ</a><a href="https://redux.js.org/style-guide/style-guide" class="navbar__item navbar__link">Best Practices</a><a href="https://www.github.com/reduxjs/redux" class="navbar__item navbar__link">GitHub</a><a href="https://redux.js.org/introduction/getting-started#help-and-discussion" class="navbar__item navbar__link">Need help?</a>

<span class="toggle_71bT">üåú</span>

<span class="toggle_71bT">üåû</span>

<span class="DocSearch-Button-Placeholder">Search</span>

<a href="https://redux.js.org/" class="navbar__brand"><img src="https://d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo" /><strong>Redux</strong></a>

- <a href="https://redux.js.org/introduction/getting-started" class="menu__link">Getting Started</a>
- <a href="https://redux.js.org/tutorials/essentials/part-1-overview-concepts" class="menu__link">Tutorial</a>
- <a href="https://redux.js.org/api/api-reference" class="menu__link">API</a>
- <a href="https://redux.js.org/faq" class="menu__link">FAQ</a>
- <a href="https://redux.js.org/style-guide/style-guide" class="menu__link">Best Practices</a>
- <a href="https://www.github.com/reduxjs/redux" class="menu__link">GitHub</a>
- <a href="https://redux.js.org/introduction/getting-started#help-and-discussion" class="menu__link">Need help?</a>

- <a href="#!" class="menu__link menu__link--sublist">Introduction</a>
  - <a href="https://redux.js.org/introduction/getting-started" class="menu__link">Getting Started with Redux</a>
  - <a href="https://redux.js.org/introduction/installation" class="menu__link">Installation</a>
  - <a href="https://redux.js.org/introduction/core-concepts" class="menu__link">Core Concepts</a>
  - <a href="https://redux.js.org/introduction/learning-resources" class="menu__link">Learning Resources</a>
  - <a href="https://redux.js.org/introduction/ecosystem" class="menu__link">Ecosystem</a>
  - <a href="https://redux.js.org/introduction/examples" class="menu__link">Examples</a>
- <a href="#!" class="menu__link menu__link--sublist">Tutorials</a>
  - <a href="https://redux.js.org/tutorials/index" class="menu__link">Tutorials Index</a>
  - <a href="https://redux.js.org/tutorials/quick-start" class="menu__link">Quick Start</a>
  - <a href="https://redux.js.org/tutorials/typescript-quick-start" class="menu__link">TypeScript Quick Start</a>
  - <a href="#!" class="menu__link menu__link--sublist">Redux Essentials</a>
    - <a href="https://redux.js.org/tutorials/essentials/part-1-overview-concepts" class="menu__link">Redux Overview and Concepts</a>
    - <a href="https://redux.js.org/tutorials/essentials/part-2-app-structure" class="menu__link">Redux App Structure</a>
    - <a href="https://redux.js.org/tutorials/essentials/part-3-data-flow" class="menu__link">Basic Redux Data Flow</a>
    - <a href="https://redux.js.org/tutorials/essentials/part-4-using-data" class="menu__link">Using Redux Data</a>
    - <a href="https://redux.js.org/tutorials/essentials/part-5-async-logic" class="menu__link">Async Logic and Data Fetching</a>
    - <a href="https://redux.js.org/tutorials/essentials/part-6-performance-normalization" class="menu__link">Performance and Normalizing Data</a>
  - <a href="#!" class="menu__link menu__link--sublist">Redux Fundamentals</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-1-overview" class="menu__link">Redux Overview</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-2-concepts-data-flow" class="menu__link">Redux Concepts and Data Flow</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers" class="menu__link">State, Actions, and Reducers</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-4-store" class="menu__link">Store</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-5-ui-react" class="menu__link">UI and React</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-6-async-logic" class="menu__link">Async Logic and Data Fetching</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-7-standard-patterns" class="menu__link">Standard Redux Patterns</a>
    - <a href="https://redux.js.org/tutorials/fundamentals/part-8-modern-redux" class="menu__link">Modern Redux with Redux Toolkit</a>
- <a href="#!" class="menu__link menu__link--sublist">Recipes</a>
  - <a href="https://redux.js.org/recipes/recipe-index" class="menu__link">Recipes: Index</a>
  - <a href="https://redux.js.org/recipes/configuring-your-store" class="menu__link">Configuring Your Store</a>
  - <a href="https://redux.js.org/recipes/usage-with-typescript" class="menu__link">Usage With TypeScript</a>
  - <a href="https://redux.js.org/recipes/migrating-to-redux" class="menu__link">Migrating to Redux</a>
  - <a href="https://redux.js.org/recipes/using-object-spread-operator" class="menu__link">Using Object Spread Operator</a>
  - <a href="https://redux.js.org/recipes/reducing-boilerplate" class="menu__link">Reducing Boilerplate</a>
  - <a href="https://redux.js.org/recipes/server-rendering" class="menu__link">Server Rendering</a>
  - <a href="https://redux.js.org/recipes/writing-tests" class="menu__link">Writing Tests</a>
  - <a href="https://redux.js.org/recipes/computing-derived-data" class="menu__link">Computing Derived Data</a>
  - <a href="https://redux.js.org/recipes/implementing-undo-history" class="menu__link">Implementing Undo History</a>
  - <a href="https://redux.js.org/recipes/isolating-redux-sub-apps" class="menu__link">Isolating Redux Sub-Apps</a>
  - <a href="https://redux.js.org/recipes/code-splitting" class="menu__link">Code Splitting</a>
  - <a href="https://redux.js.org/recipes/troubleshooting" class="menu__link">Troubleshooting</a>
  - <a href="#!" class="menu__link menu__link--sublist">Structuring Reducers</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/structuring-reducers" class="menu__link">Structuring Reducers</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/prerequisite-concepts" class="menu__link">Prerequisite Concepts</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/basic-reducer-structure" class="menu__link">Basic Reducer Structure</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/splitting-reducer-logic" class="menu__link">Splitting Reducer Logic</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/refactoring-reducer-example" class="menu__link">Refactoring Reducers Example</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/using-combinereducers" class="menu__link">Using combineReducers</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/beyond-combinereducers" class="menu__link">Beyond combineReducers</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/normalizing-state-shape" class="menu__link">Normalizing State Shape</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/updating-normalized-data" class="menu__link">Updating Normalized Data</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/reusing-reducer-logic" class="menu__link">Reusing Reducer Logic</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/immutable-update-patterns" class="menu__link">Immutable Update Patterns</a>
    - <a href="https://redux.js.org/recipes/structuring-reducers/initializing-state" class="menu__link">Initializing State</a>
- <a href="#!" class="menu__link menu__link--sublist">Understanding Redux</a>
  - <a href="#!" class="menu__link menu__link--sublist">Thinking in Redux</a>
    - <a href="https://redux.js.org/understanding/thinking-in-redux/motivation" class="menu__link">Motivation</a>
    - <a href="https://redux.js.org/understanding/thinking-in-redux/three-principles" class="menu__link">Three Principles</a>
    - <a href="https://redux.js.org/understanding/thinking-in-redux/glossary" class="menu__link">Glossary</a>
  - <a href="#!" class="menu__link menu__link--sublist">History and Design</a>
    - <a href="https://redux.js.org/understanding/history-and-design/prior-art" class="menu__link">Prior Art</a>
    - <a href="https://redux.js.org/understanding/history-and-design/middleware" class="menu__link">Middleware</a>
- <a href="#!" class="menu__link menu__link--sublist">FAQ</a>
  - <a href="https://redux.js.org/faq" class="menu__link">FAQ Index</a>
  - <a href="https://redux.js.org/faq/general" class="menu__link">General</a>
  - <a href="https://redux.js.org/faq/reducers" class="menu__link">Reducers</a>
  - <a href="https://redux.js.org/faq/organizing-state" class="menu__link">Organizing State</a>
  - <a href="https://redux.js.org/faq/store-setup" class="menu__link">Store Setup</a>
  - <a href="https://redux.js.org/faq/actions" class="menu__link">Actions</a>
  - <a href="https://redux.js.org/faq/immutable-data" class="menu__link">Immutable Data</a>
  - <a href="https://redux.js.org/faq/code-structure" class="menu__link">Code Structure</a>
  - <a href="https://redux.js.org/faq/performance" class="menu__link">Performance</a>
  - <a href="https://redux.js.org/faq/design-decisions" class="menu__link">Design Decisions</a>
  - <a href="https://redux.js.org/faq/react-redux" class="menu__link">React Redux</a>
  - <a href="https://redux.js.org/faq/miscellaneous" class="menu__link">Miscellaneous</a>
- <a href="#!" class="menu__link menu__link--sublist">Style Guide</a>
  - <a href="https://redux.js.org/style-guide/style-guide" class="menu__link">Style Guide: Best Practices</a>
- <a href="#!" class="menu__link menu__link--sublist menu__link--active">API Reference</a>
  - <a href="https://redux.js.org/api/api-reference" class="menu__link">API Reference</a>
  - <a href="https://redux.js.org/api/createstore" class="menu__link">createStore</a>
  - <a href="https://redux.js.org/api/store" class="menu__link">Store</a>
  - <a href="https://redux.js.org/api/combinereducers" class="menu__link">combineReducers</a>
  - <a href="https://redux.js.org/api/applymiddleware" class="menu__link menu__link--active active">applyMiddleware</a>
  - <a href="https://redux.js.org/api/bindactioncreators" class="menu__link">bindActionCreators</a>
  - <a href="https://redux.js.org/api/compose" class="menu__link">compose</a>
- <a href="#!" class="menu__link menu__link--sublist">Redux Toolkit</a>
  - <a href="https://redux.js.org/redux-toolkit/overview" class="menu__link">Redux Toolkit: Overview</a>

# <span id="applymiddlewaremiddleware" class="anchor enhancedAnchor_2LWZ"></span>`applyMiddleware(...middleware)`<a href="#applymiddlewaremiddleware" class="hash-link" title="Direct link to heading">#</a>

Middleware is the suggested way to extend Redux with custom functionality. Middleware lets you wrap the store's [`dispatch`](https://redux.js.org/api/store#dispatchaction) method for fun and profit. The key feature of middleware is that it is composable. Multiple middleware can be combined together, where each middleware requires no knowledge of what comes before or after it in the chain.

The most common use case for middleware is to support asynchronous actions without much boilerplate code or a dependency on a library like [Rx](https://github.com/Reactive-Extensions/RxJS). It does so by letting you dispatch [async actions](https://redux.js.org/understanding/thinking-in-redux/glossary#async-action) in addition to normal actions.

For example, [redux-thunk](https://github.com/gaearon/redux-thunk) lets the action creators invert control by dispatching functions. They would receive [`dispatch`](https://redux.js.org/api/store#dispatchaction) as an argument and may call it asynchronously. Such functions are called _thunks_. Another example of middleware is [redux-promise](https://github.com/acdlite/redux-promise). It lets you dispatch a [Promise](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise) async action, and dispatches a normal action when the Promise resolves.

Middleware is not baked into [`createStore`](https://redux.js.org/api/createstore) and is not a fundamental part of the Redux architecture, but we consider it useful enough to be supported right in the core. This way, there is a single standard way to extend [`dispatch`](https://redux.js.org/api/store#dispatchaction) in the ecosystem, and different middleware may compete in expressiveness and utility.

#### <span id="arguments" class="anchor enhancedAnchor_2LWZ"></span>Arguments<a href="#arguments" class="hash-link" title="Direct link to heading">#</a>

- `...middleware` (_arguments_): Functions that conform to the Redux _middleware API_. Each middleware receives [`Store`](https://redux.js.org/api/store)'s [`dispatch`](https://redux.js.org/api/store#dispatchaction) and [`getState`](https://redux.js.org/api/store#getState) functions as named arguments, and returns a function. That function will be given the `next` middleware's dispatch method, and is expected to return a function of `action` calling `next(action)` with a potentially different argument, or at a different time, or maybe not calling it at all. The last middleware in the chain will receive the real store's [`dispatch`](https://redux.js.org/api/store#dispatchaction) method as the `next` parameter, thus ending the chain. So, the middleware signature is `({ getState, dispatch }) => next => action`.

#### <span id="returns" class="anchor enhancedAnchor_2LWZ"></span>Returns<a href="#returns" class="hash-link" title="Direct link to heading">#</a>

(_Function_) A store enhancer that applies the given middleware. The store enhancer signature is `createStore => createStore` but the easiest way to apply it is to pass it to [`createStore()`](https://redux.js.org/api/createstore) as the last `enhancer` argument.

#### <span id="example-custom-logger-middleware" class="anchor enhancedAnchor_2LWZ"></span>Example: Custom Logger Middleware<a href="#example-custom-logger-middleware" class="hash-link" title="Direct link to heading">#</a>

<span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> createStore</span><span class="token imports punctuation" style="color: #f8f8f2">,</span><span class="token imports"> applyMiddleware </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'redux'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports">todos</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./reducers'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">logger</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter punctuation" style="color: #f8f8f2">{</span><span class="token parameter"> getState </span><span class="token parameter punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">log</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'will dispatch'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// Call the next dispatch method in the middleware chain.</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> returnValue </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">next</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">action</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">log</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'state after dispatch'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">getState</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// This will likely be the action itself, unless</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// a middleware further in chain changed it.</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> returnValue</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> store </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">createStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">todos</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token string" style="color: #a6e22e">'Use Redux'</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">applyMiddleware</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">logger</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> type</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'ADD_TODO'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> text</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'Understand the middleware'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// (These lines will be logged by the middleware:)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// will dispatch: { type: 'ADD_TODO', text: 'Understand the middleware' }</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// state after dispatch: \[ 'Use Redux', 'Understand the middleware' \]</span>

Copy

#### <span id="example-using-thunk-middleware-for-async-actions" class="anchor enhancedAnchor_2LWZ"></span>Example: Using Thunk Middleware for Async Actions<a href="#example-using-thunk-middleware-for-async-actions" class="hash-link" title="Direct link to heading">#</a>

<span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> createStore</span><span class="token imports punctuation" style="color: #f8f8f2">,</span><span class="token imports"> combineReducers</span><span class="token imports punctuation" style="color: #f8f8f2">,</span><span class="token imports"> applyMiddleware </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'redux'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports">thunk</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'redux-thunk'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports operator" style="color: #f8f8f2">\*</span><span class="token imports"> </span><span class="token imports keyword module" style="color: #f92672">as</span><span class="token imports"> reducers</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'./reducers'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> reducer </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">combineReducers</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">reducers</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// applyMiddleware supercharges createStore with middleware:</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> store </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">createStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">reducer</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">applyMiddleware</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">thunk</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">fetchSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">fetch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'https://www.google.com/search?q=secret+sauce'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// These are the normal action creators you have seen so far.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// The actions they return can be dispatched without any middleware.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// However, they only express ‚Äúfacts‚Äù and not the ‚Äúasync flow‚Äù.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">makeASandwich</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">forPerson</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> secretSauce</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> type</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'MAKE_SANDWICH'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> forPerson</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> secretSauce</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">apologize</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">fromPerson</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> toPerson</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> error</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> type</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'APOLOGIZE'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> fromPerson</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> toPerson</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> error</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">withdrawMoney</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">amount</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> type</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'WITHDRAW'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> amount</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// Even without middleware, you can dispatch an action:</span><span class="token plain"></span>

<span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">withdrawMoney</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token number" style="color: #ae81ff">100</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// But what do you do when you need to start an asynchronous action,</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// such as an API call, or a router transition?</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// Meet thunks.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// A thunk is a function that returns a function.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// This is a thunk.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">forPerson</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// Invert control!</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// Return a function that accepts \`dispatch\` so we can dispatch later.</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// Thunk middleware knows how to turn thunk async actions into actions.</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">dispatch</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">fetchSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">then</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token parameter">sauce</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwich</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">forPerson</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> sauce</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token parameter">error</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">apologize</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'The Sandwich Shop'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> forPerson</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> error</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// Thunk middleware lets me dispatch thunk async actions</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// as if they were actions!</span><span class="token plain"></span>

<span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'Me'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// It even takes care to return the thunk's return value</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// from the dispatch, so I can chain Promises as long as I return them.</span><span class="token plain"></span>

<span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'My wife'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">then</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">log</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'Done!'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// In fact I can write action creators that dispatch</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// actions and async actions from other action creators,</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// and I can build my control flow with Promises.</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">makeSandwichesForEverybody</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">function</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">dispatch</span><span class="token parameter punctuation" style="color: #f8f8f2">,</span><span class="token parameter"> getState</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token operator" style="color: #f8f8f2">!</span><span class="token function" style="color: #e6d874">getState</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">sandwiches</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">isShopOpen</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// You don't have to return Promises, but it's a handy convention</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// so the caller can always call .then() on async dispatch result.</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">resolve</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// We can dispatch both plain object actions and other thunks,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token comment" style="color: #c6cad2">// which lets us compose the asynchronous actions in a single flow.</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'My Grandma'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">then</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">all</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'Me'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'My wife'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">then</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'Our kids'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">then</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">getState</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">myMoney</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">&gt;</span><span class="token plain"> </span><span class="token number" style="color: #ae81ff">42</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">?</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">withdrawMoney</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token number" style="color: #ae81ff">42</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">apologize</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'Me'</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'The Sandwich Shop'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// This is very useful for server side rendering, because I can wait</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// until data is available, then synchronously render the app.</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> renderToString </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react-dom/server'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain">store</span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeSandwichesForEverybody</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">then</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">send</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">renderToString</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token operator" style="color: #f8f8f2">&lt;</span><span class="token maybe-class-name">MyApp</span><span class="token plain"> store</span><span class="token operator" style="color: #f8f8f2">=</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain">store</span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">/</span><span class="token operator" style="color: #f8f8f2">&gt;</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// I can also dispatch a thunk async action from a component</span><span class="token plain"></span>

<span class="token plain"></span><span class="token comment" style="color: #c6cad2">// any time its props change to load the missing data.</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> connect </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react-redux'</span><span class="token plain"></span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color: #f8f8f2">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Component</span><span class="token imports"> </span><span class="token imports punctuation" style="color: #f8f8f2">}</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">from</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'react'</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword" style="color: #f92672">class</span><span class="token plain"> </span><span class="token class-name">SandwichShop</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">extends</span><span class="token plain"> </span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">componentDidMount</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">this</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">props</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token keyword" style="color: #f92672">this</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">props</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">forPerson</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">componentDidUpdate</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">prevProps</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">prevProps</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">forPerson</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">!==</span><span class="token plain"> </span><span class="token keyword" style="color: #f92672">this</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">props</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">forPerson</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword" style="color: #f92672">this</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">props</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">dispatch</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token function" style="color: #e6d874">makeASandwichWithSecretSauce</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token keyword" style="color: #f92672">this</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">props</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">forPerson</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"> </span><span class="token function" style="color: #e6d874">render</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token keyword control-flow" style="color: #f92672">return</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">&lt;</span><span class="token plain">p</span><span class="token operator" style="color: #f8f8f2">&gt;</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token keyword" style="color: #f92672">this</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">props</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">sandwiches</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token method function property-access" style="color: #e6d874">join</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'mustard'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token operator" style="color: #f8f8f2">&lt;</span><span class="token operator" style="color: #f8f8f2">/</span><span class="token plain">p</span><span class="token operator" style="color: #f8f8f2">&gt;</span><span class="token plain"></span>

<span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

<span class="token plain" style="display: inline-block"> </span>

<span class="token plain"></span><span class="token keyword module" style="color: #f92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color: #f92672">default</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">connect</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

<span class="token plain"> sandwiches</span><span class="token operator" style="color: #f8f8f2">:</span><span class="token plain"> state</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">sandwiches</span><span class="token plain"></span>

<span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token maybe-class-name">SandwichShop</span><span class="token punctuation" style="color: #f8f8f2">)</span>

Copy

#### <span id="tips" class="anchor enhancedAnchor_2LWZ"></span>Tips<a href="#tips" class="hash-link" title="Direct link to heading">#</a>

- Middleware only wraps the store's [`dispatch`](https://redux.js.org/api/store#dispatchaction) function. Technically, anything a middleware can do, you can do manually by wrapping every `dispatch` call, but it's easier to manage this in a single place and define action transformations on the scale of the whole project.

- If you use other store enhancers in addition to `applyMiddleware`, make sure to put `applyMiddleware` before them in the composition chain because the middleware is potentially asynchronous. For example, it should go before [redux-devtools](https://github.com/reduxjs/redux-devtools) because otherwise the DevTools won't see the raw actions emitted by the Promise middleware and such.

- If you want to conditionally apply a middleware, make sure to only import it when it's needed:

  <span class="token keyword" style="color: #f92672">let</span><span class="token plain"> middleware </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token plain">a</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> b</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token plain"></span>

  <span class="token plain"></span><span class="token keyword control-flow" style="color: #f92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain">process</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token property-access">env</span><span class="token punctuation" style="color: #f8f8f2">.</span><span class="token constant" style="color: #f92672">NODE_ENV</span><span class="token plain"> </span><span class="token operator" style="color: #f8f8f2">!==</span><span class="token plain"> </span><span class="token string" style="color: #a6e22e">'production'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">{</span><span class="token plain"></span>

  <span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> c </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">require</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'some-debug-middleware'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

  <span class="token plain"> </span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> d </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">require</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token string" style="color: #a6e22e">'another-debug-middleware'</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

  <span class="token plain"> middleware </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token punctuation" style="color: #f8f8f2">\[</span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">middleware</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> c</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"> d</span><span class="token punctuation" style="color: #f8f8f2">\]</span><span class="token plain"></span>

  <span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">}</span><span class="token plain"></span>

  <span class="token plain" style="display: inline-block"> </span>

  <span class="token plain"></span><span class="token keyword" style="color: #f92672">const</span><span class="token plain"> store </span><span class="token operator" style="color: #f8f8f2">=</span><span class="token plain"> </span><span class="token function" style="color: #e6d874">createStore</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token plain"></span>

  <span class="token plain"> reducer</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

  <span class="token plain"> preloadedState</span><span class="token punctuation" style="color: #f8f8f2">,</span><span class="token plain"></span>

  <span class="token plain"> </span><span class="token function" style="color: #e6d874">applyMiddleware</span><span class="token punctuation" style="color: #f8f8f2">(</span><span class="token spread operator" style="color: #f8f8f2">...</span><span class="token plain">middleware</span><span class="token punctuation" style="color: #f8f8f2">)</span><span class="token plain"></span>

  <span class="token plain"></span><span class="token punctuation" style="color: #f8f8f2">)</span>

  Copy

  This makes it easier for bundling tools to cut out unneeded modules and reduces the size of your builds.

- Ever wondered what `applyMiddleware` itself is? It ought to be an extension mechanism more powerful than the middleware itself. Indeed, `applyMiddleware` is an example of the most powerful Redux extension mechanism called [store enhancers](https://redux.js.org/understanding/thinking-in-redux/glossary#store-enhancer). It is highly unlikely you'll ever want to write a store enhancer yourself. Another example of a store enhancer is [redux-devtools](https://github.com/reduxjs/redux-devtools). Middleware is less powerful than a store enhancer, but it is easier to write.

- Middleware sounds much more complicated than it really is. The only way to really understand middleware is to see how the existing middleware works, and try to write your own. The function nesting can be intimidating, but most of the middleware you'll find are, in fact, 10-liners, and the nesting and composability is what makes the middleware system powerful.

- To apply multiple store enhancers, you may use [`compose()`](https://redux.js.org/api/compose).

<a href="https://redux.js.org/api/combinereducers" class="pagination-nav__link"></a>

Previous

¬´ combineReducers

<a href="https://redux.js.org/api/bindactioncreators" class="pagination-nav__link"></a>

Next

bindActionCreators ¬ª

#### Docs

- <a href="https://redux.js.org/introduction/getting-started" class="footer__link-item">Getting Started</a>
- <a href="https://redux.js.org/tutorials/essentials/part-1-overview-concepts" class="footer__link-item">Tutorial</a>
- <a href="https://redux.js.org/faq" class="footer__link-item">FAQ</a>
- <a href="https://redux.js.org/api/api-reference" class="footer__link-item">API Reference</a>

#### Community

- <a href="https://discord.gg/0ZcbPKXt5bZ6au5t" class="footer__link-item">Reactiflux Discord</a>
- <a href="http://stackoverflow.com/questions/tagged/redux" class="footer__link-item">Stack Overflow</a>
- <a href="https://redux.js.org/introduction/getting-started#help-and-discussion" class="footer__link-item">Feedback</a>

#### More

- <a href="https://github.com/reduxjs/redux" class="footer__link-item">GitHub</a>
- [![Deploys by Netlify](https://www.netlify.com/img/global/badges/netlify-color-accent.svg)](https://www.netlify.com/)

<a href="https://redux.js.org/" class="footerLogoLink_MyFc"><img src="https://d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo" /><img src="https://d33wubrfki0l68.cloudfront.net/0834d0215db51e91525a25acf97433051f280f2f/c30f5/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo" /></a>

Copyright ¬© 2015‚Äì2021 Dan Abramov and the Redux documentation authors.
