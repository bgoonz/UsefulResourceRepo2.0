


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code Snippets &#8212; pgAdmin 4 4.29 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <script src="_static/sidebar.js"></script>
    
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Code Review Notes" href="code_review.html" />
    <link rel="prev" title="Coding Standards" href="coding_standards.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="code_review.html" title="Code Review Notes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="coding_standards.html" title="Coding Standards"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pgAdmin 4 4.29 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="contributions.html" accesskey="U">pgAdmin Project Contributions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Code Snippets</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="code-snippets">
<h1>Code Snippets<a class="headerlink" href="#code-snippets" title="Permalink to this headline">¶</a></h1>
<p>This document contains code for some of the important classes, listed as
below:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pgadminmodule">PgAdminModule</a></p></li>
<li><p><a class="reference internal" href="#nodeview">NodeView</a></p></li>
<li><p><a class="reference internal" href="#basedriver">BaseDriver</a></p></li>
<li><p><a class="reference internal" href="#baseconnection">BaseConnection</a></p></li>
</ul>
<div class="section" id="pgadminmodule">
<span id="id1"></span><h2>PgAdminModule<a class="headerlink" href="#pgadminmodule" title="Permalink to this headline">¶</a></h2>
<p>PgAdminModule is inherited from Flask.Blueprint module.
This module defines a set of methods, properties and attributes,
that every module should implement.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PgAdminModule</span><span class="p">(</span><span class="n">Blueprint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for every PgAdmin Module.</span>

<span class="sd">    This class defines a set of method and attributes that</span>
<span class="sd">    every module should implement.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">import_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;url_prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;template_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;static_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parentmodules</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PgAdminModule</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">import_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">create_module_preference</span><span class="p">():</span>
            <span class="c1"># Create preference for each module by default</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;LABEL&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">preference</span> <span class="o">=</span> <span class="n">Preferences</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">LABEL</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">preference</span> <span class="o">=</span> <span class="n">Preferences</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">register_preferences</span><span class="p">()</span>

        <span class="c1"># Create and register the module preference object and preferences for</span>
        <span class="c1"># it just before the first request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">before_app_first_request</span><span class="p">(</span><span class="n">create_module_preference</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># To be implemented by child classes</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">first_registration</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override the default register function to automagically register</span>
<span class="sd">        sub-modules at once.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">first_registration</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">find_submodules</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">import_name</span><span class="p">))</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PgAdminModule</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">first_registration</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">first_registration</span><span class="p">:</span>
                <span class="n">module</span><span class="o">.</span><span class="n">parentmodules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
            <span class="n">app</span><span class="o">.</span><span class="n">register_logout_hook</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_own_stylesheets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: the stylesheets used by this module, not including any</span>
<span class="sd">                stylesheet needed by the submodules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">get_own_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            dict: the i18n messages used by this module, not including any</span>
<span class="sd">                messages needed by the submodules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_own_javascripts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: the javascripts used by this module, not including</span>
<span class="sd">                any script needed by the submodules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">get_own_menuitems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            dict: the menuitems for this module, not including</span>
<span class="sd">                any needed from the submodules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_panels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: a list of panel objects to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">get_exposed_url_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            list: a list of url endpoints exposed to the client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stylesheets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">stylesheets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_own_stylesheets</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="n">stylesheets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">stylesheets</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stylesheets</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_own_messages</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">messages</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">javascripts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">javascripts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_own_javascripts</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="n">javascripts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">javascripts</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">javascripts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">menu_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">menu_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_own_menuitems</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">menu_items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">menu_items</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">menu_items</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">)))</span>
                          <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">menu_items</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">menu_items</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exposed_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_exposed_url_endpoints</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">module</span><span class="o">.</span><span class="n">exposed_endpoints</span>

        <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
<div class="section" id="nodeview">
<span id="id2"></span><h2>NodeView<a class="headerlink" href="#nodeview" title="Permalink to this headline">¶</a></h2>
<p>The NodeView class exposes basic REST APIs for different operations used by
the pgAdmin Browser. The basic idea has been taken from <a class="reference external" href="http://flask.pocoo.org/docs/1.0/api/#flask.views.MethodView">Flask’s MethodView</a> class. Because
we need a lot more operations (not, just CRUD), we can not use it directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NodeView</span><span class="p">(</span><span class="n">with_metaclass</span><span class="p">(</span><span class="n">MethodViewType</span><span class="p">,</span> <span class="n">View</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A PostgreSQL Object has so many operaions/functions apart from CRUD</span>
<span class="sd">    (Create, Read, Update, Delete):</span>
<span class="sd">    i.e.</span>
<span class="sd">    - Reversed Engineered SQL</span>
<span class="sd">    - Modified Query for parameter while editing object attributes</span>
<span class="sd">      i.e. ALTER TABLE ...</span>
<span class="sd">    - Statistics of the objects</span>
<span class="sd">    - List of dependents</span>
<span class="sd">    - List of dependencies</span>
<span class="sd">    - Listing of the children object types for the certain node</span>
<span class="sd">      It will used by the browser tree to get the children nodes</span>

<span class="sd">    This class can be inherited to achieve the diffrent routes for each of the</span>
<span class="sd">    object types/collections.</span>

<span class="sd">       OPERATION   |             URL             | HTTP Method |    Method</span>
<span class="sd">    ---------------+-----------------------------+-------------+--------------</span>
<span class="sd">    List           | /obj/[Parent URL]/          | GET         | list</span>
<span class="sd">    Properties     | /obj/[Parent URL]/id        | GET         | properties</span>
<span class="sd">    Create         | /obj/[Parent URL]/          | POST        | create</span>
<span class="sd">    Delete         | /obj/[Parent URL]/id        | DELETE      | delete</span>
<span class="sd">    Update         | /obj/[Parent URL]/id        | PUT         | update</span>

<span class="sd">    SQL (Reversed  | /sql/[Parent URL]/id        | GET         | sql</span>
<span class="sd">    Engineering)   |</span>
<span class="sd">    SQL (Modified  | /msql/[Parent URL]/id       | GET         | modified_sql</span>
<span class="sd">    Properties)    |</span>

<span class="sd">    Statistics     | /stats/[Parent URL]/id      | GET         | statistics</span>
<span class="sd">    Dependencies   | /dependency/[Parent URL]/id | GET         | dependencies</span>
<span class="sd">    Dependents     | /dependent/[Parent URL]/id  | GET         | dependents</span>

<span class="sd">    Nodes          | /nodes/[Parent URL]/        | GET         | nodes</span>
<span class="sd">    Current Node   | /nodes/[Parent URL]/id      | GET         | node</span>

<span class="sd">    Children       | /children/[Parent URL]/id   | GET         | children</span>

<span class="sd">    NOTE:</span>
<span class="sd">    Parent URL can be seen as the path to identify the particular node.</span>

<span class="sd">    i.e.</span>
<span class="sd">    In order to identify the TABLE object, we need server -&gt; database -&gt; schema</span>
<span class="sd">    information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">operations</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span>
        <span class="s1">&#39;obj&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="s1">&#39;put&#39;</span><span class="p">:</span> <span class="s1">&#39;update&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;post&#39;</span><span class="p">:</span> <span class="s1">&#39;create&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;node&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;nodes&#39;</span><span class="p">}],</span>
        <span class="s1">&#39;sql&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;sql&#39;</span><span class="p">}],</span>
        <span class="s1">&#39;msql&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;modified_sql&#39;</span><span class="p">}],</span>
        <span class="s1">&#39;stats&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;statistics&#39;</span><span class="p">}],</span>
        <span class="s1">&#39;dependency&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;dependencies&#39;</span><span class="p">}],</span>
        <span class="s1">&#39;dependent&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;dependents&#39;</span><span class="p">}],</span>
        <span class="s1">&#39;children&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;get&#39;</span><span class="p">:</span> <span class="s1">&#39;children&#39;</span><span class="p">}]</span>
    <span class="p">})</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">generate_ops</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">cmds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">operations</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">ops</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="n">op</span><span class="p">]:</span>
                <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">:</span>
                    <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meths</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">cmds</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;cmd&#39;</span><span class="p">:</span> <span class="n">op</span><span class="p">,</span> <span class="s1">&#39;req&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="s1">&#39;with_id&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">idx</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="n">meths</span>
                    <span class="p">})</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">cmds</span>

    <span class="c1"># Inherited class needs to modify these parameters</span>
    <span class="n">node_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Inherited class needs to modify these parameters</span>
    <span class="n">node_label</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># This must be an array object with attributes (type and id)</span>
    <span class="n">parent_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># This must be an array object with attributes (type and id)</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_node_urls</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">cls</span><span class="o">.</span><span class="n">node_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> \
            <span class="s2">&quot;Please set the node_type for this class (</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="n">common_url</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">parent_ids</span><span class="p">:</span>
            <span class="n">common_url</span> <span class="o">+=</span> <span class="s1">&#39;&lt;</span><span class="si">{0}</span><span class="s1">:</span><span class="si">{1}</span><span class="s1">&gt;/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]))</span>

        <span class="n">id_url</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
            <span class="n">id_url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&lt;</span><span class="si">{1}</span><span class="s1">:</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">common_url</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">id_url</span> <span class="k">else</span> <span class="n">id_url</span><span class="p">,</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">id_url</span><span class="p">,</span> <span class="n">common_url</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]</span>

    <span class="c1"># Check the existance of all the required arguments from parent_ids</span>
    <span class="c1"># and return combination of has parent arguments, and has id arguments</span>
    <span class="k">def</span> <span class="nf">check_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">has_id</span> <span class="o">=</span> <span class="n">has_args</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">has_args</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">has_id</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">has_args</span><span class="p">,</span> <span class="n">has_id</span> <span class="ow">and</span> <span class="n">has_args</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">http_method</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">http_method</span> <span class="o">==</span> <span class="s1">&#39;head&#39;</span><span class="p">:</span>
            <span class="n">http_method</span> <span class="o">=</span> <span class="s1">&#39;get&#39;</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">,</span> \
            <span class="s1">&#39;Unimplemented command (</span><span class="si">{0}</span><span class="s1">) for </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">has_args</span><span class="p">,</span> <span class="n">has_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_args</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span> <span class="ow">and</span>
            <span class="p">(</span><span class="n">has_id</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span>
             <span class="n">http_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span>
            <span class="p">(</span><span class="ow">not</span> <span class="n">has_id</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span>
             <span class="n">http_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span>
             <span class="n">http_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="p">),</span> \
            <span class="s1">&#39;Unimplemented method (</span><span class="si">{0}</span><span class="s1">) for command (</span><span class="si">{1}</span><span class="s1">), which </span><span class="si">{2}</span><span class="s1"> &#39;</span> \
            <span class="s1">&#39;an id&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">http_method</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">,</span>
                           <span class="s1">&#39;requires&#39;</span> <span class="k">if</span> <span class="n">has_id</span> <span class="k">else</span> <span class="s1">&#39;does not require&#39;</span><span class="p">)</span>
        <span class="n">meth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">has_id</span><span class="p">:</span>
            <span class="n">meth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">http_method</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">has_args</span> <span class="ow">and</span> <span class="n">http_method</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">meth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">http_method</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="n">http_method</span><span class="p">]</span>

        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">meth</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">make_json_response</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="mi">406</span><span class="p">,</span>
                <span class="n">success</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">errormsg</span><span class="o">=</span><span class="n">gettext</span><span class="p">(</span>
                    <span class="s1">&#39;Unimplemented method (</span><span class="si">{0}</span><span class="s1">) for this url (</span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">meth</span><span class="p">,</span> <span class="n">flask</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">path</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">register_node_view</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">blueprint</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">blueprint</span> <span class="o">=</span> <span class="n">blueprint</span>
        <span class="n">id_url</span><span class="p">,</span> <span class="n">url</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_node_urls</span><span class="p">()</span>

        <span class="n">commands</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">generate_ops</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">commands</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;with_id&#39;</span><span class="p">]:</span>
                <span class="n">blueprint</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span>
                    <span class="s1">&#39;/</span><span class="si">{0}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">c</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">],</span> <span class="n">id_url</span> <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;req&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">url</span>
                    <span class="p">),</span>
                    <span class="n">view_func</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="si">{0}{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">cmd</span><span class="p">,</span> <span class="s1">&#39;_id&#39;</span> <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;req&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                        <span class="p">),</span>
                        <span class="n">cmd</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">methods</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;methods&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">blueprint</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span>
                    <span class="s1">&#39;/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]),</span>
                    <span class="n">view_func</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span>
                        <span class="n">cmd</span><span class="p">,</span> <span class="n">cmd</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]</span>
                    <span class="p">),</span>
                    <span class="n">methods</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;methods&#39;</span><span class="p">]</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build a list of treeview nodes from the child nodes.&quot;&quot;&quot;</span>
        <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children_nodes</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Return sorted nodes based on label</span>
        <span class="k">return</span> <span class="n">make_json_response</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span>
                <span class="n">children</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_children_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the list of children nodes for the current nodes. Override this</span>
<span class="sd">        function for special cases only.</span>

<span class="sd">        :param args:</span>
<span class="sd">        :param kwargs: Parameters to generate the correct set of tree node.</span>
<span class="sd">        :return: List of the children nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blueprint</span><span class="o">.</span><span class="n">submodules</span><span class="p">:</span>
            <span class="n">children</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">get_nodes</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">children</span>
</pre></div>
</div>
</div>
<div class="section" id="basedriver">
<span id="id3"></span><h2>BaseDriver<a class="headerlink" href="#basedriver" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BaseDriver</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    class BaseDriver(object):</span>

<span class="sd">    This is a base class for different server types.</span>
<span class="sd">    Inherit this class to implement different type of database driver</span>
<span class="sd">    implementation.</span>

<span class="sd">    (For PostgreSQL/EDB Postgres Advanced Server, we will be using psycopg2)</span>

<span class="sd">    Abstract Properties:</span>
<span class="sd">    -------- ----------</span>
<span class="sd">    * Version (string):</span>
<span class="sd">        Current version string for the database server</span>

<span class="sd">    * libpq_version (string):</span>
<span class="sd">        Current version string for the used libpq library</span>

<span class="sd">    Abstract Methods:</span>
<span class="sd">    -------- -------</span>
<span class="sd">    * get_connection(*args, **kwargs)</span>
<span class="sd">    - It should return a Connection class object, which may/may not be</span>
<span class="sd">      connected to the database server.</span>

<span class="sd">    * release_connection(*args, **kwargs)</span>
<span class="sd">    - Implement the connection release logic</span>

<span class="sd">    * gc()</span>
<span class="sd">    - Implement this function to release the connections assigned in the</span>
<span class="sd">      session, which has not been pinged from more than the idle timeout</span>
<span class="sd">      configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractproperty</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractproperty</span>
    <span class="k">def</span> <span class="nf">libpq_version</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">release_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">gc_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="section" id="baseconnection">
<span id="id4"></span><h2>BaseConnection<a class="headerlink" href="#baseconnection" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BaseConnection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    class BaseConnection(object)</span>

<span class="sd">        It is a base class for database connection. A different connection</span>
<span class="sd">        drive must implement this to expose abstract methods for this server.</span>

<span class="sd">        General idea is to create a wrapper around the actual driver</span>
<span class="sd">        implementation. It will be instantiated by the driver factory</span>
<span class="sd">        basically. And, they should not be instantiated directly.</span>


<span class="sd">    Abstract Methods:</span>
<span class="sd">    -------- -------</span>
<span class="sd">    * connect(**kwargs)</span>
<span class="sd">      - Define this method to connect the server using that particular driver</span>
<span class="sd">        implementation.</span>

<span class="sd">    * execute_scalar(query, params, formatted_exception_msg)</span>
<span class="sd">      - Implement this method to execute the given query and returns single</span>
<span class="sd">        datum result.</span>

<span class="sd">    * execute_async(query, params, formatted_exception_msg)</span>
<span class="sd">      - Implement this method to execute the given query asynchronously and</span>
<span class="sd">      returns result.</span>

<span class="sd">    * execute_void(query, params, formatted_exception_msg)</span>
<span class="sd">      - Implement this method to execute the given query with no result.</span>

<span class="sd">    * execute_2darray(query, params, formatted_exception_msg)</span>
<span class="sd">      - Implement this method to execute the given query and returns the result</span>
<span class="sd">        as a 2 dimensional array.</span>

<span class="sd">    * execute_dict(query, params, formatted_exception_msg)</span>
<span class="sd">      - Implement this method to execute the given query and returns the result</span>
<span class="sd">        as an array of dict (column name -&gt; value) format.</span>

<span class="sd">    * def async_fetchmany_2darray(records=-1, formatted_exception_msg=False):</span>
<span class="sd">      - Implement this method to retrieve result of asynchronous connection and</span>
<span class="sd">        polling with no_result flag set to True.</span>
<span class="sd">        This returns the result as a 2 dimensional array.</span>
<span class="sd">        If records is -1 then fetchmany will behave as fetchall.</span>

<span class="sd">    * connected()</span>
<span class="sd">      - Implement this method to get the status of the connection. It should</span>
<span class="sd">        return True for connected, otherwise False</span>

<span class="sd">    * reset()</span>
<span class="sd">      - Implement this method to reconnect the database server (if possible)</span>

<span class="sd">    * transaction_status()</span>
<span class="sd">      - Implement this method to get the transaction status for this</span>
<span class="sd">        connection. Range of return values different for each driver type.</span>

<span class="sd">    * ping()</span>
<span class="sd">      - Implement this method to ping the server. There are times, a connection</span>
<span class="sd">        has been lost, but - the connection driver does not know about it. This</span>
<span class="sd">        can be helpful to figure out the actual reason for query failure.</span>

<span class="sd">    * _release()</span>
<span class="sd">      - Implement this method to release the connection object. This should not</span>
<span class="sd">        be directly called using the connection object itself.</span>

<span class="sd">      NOTE: Please use BaseDriver.release_connection(...) for releasing the</span>
<span class="sd">            connection object for better memory management, and connection pool</span>
<span class="sd">            management.</span>

<span class="sd">    * _wait(conn)</span>
<span class="sd">      - Implement this method to wait for asynchronous connection to finish the</span>
<span class="sd">        execution, hence - it must be a blocking call.</span>

<span class="sd">    * _wait_timeout(conn, time)</span>
<span class="sd">      - Implement this method to wait for asynchronous connection with timeout.</span>
<span class="sd">        This must be a non blocking call.</span>

<span class="sd">    * poll(formatted_exception_msg, no_result)</span>
<span class="sd">      - Implement this method to poll the data of query running on asynchronous</span>
<span class="sd">        connection.</span>

<span class="sd">    * cancel_transaction(conn_id, did=None)</span>
<span class="sd">      - Implement this method to cancel the running transaction.</span>

<span class="sd">    * messages()</span>
<span class="sd">      - Implement this method to return the list of the messages/notices from</span>
<span class="sd">        the database server.</span>

<span class="sd">    * rows_affected()</span>
<span class="sd">      - Implement this method to get the rows affected by the last command</span>
<span class="sd">        executed on the server.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ASYNC_OK</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ASYNC_READ_TIMEOUT</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ASYNC_WRITE_TIMEOUT</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">ASYNC_NOT_CONNECTED</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">ASYNC_EXECUTION_ABORTED</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">ASYNC_TIMEOUT</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">ASYNC_WAIT_TIMEOUT</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ASYNC_NOTICE_MAXLENGTH</span> <span class="o">=</span> <span class="mi">100000</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute_void</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute_2darray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">async_fetchmany_2darray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">transaction_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_release</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conn</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_wait_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted_exception_msg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_result</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">status_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">rows_affected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">cancel_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conn_id</span><span class="p">,</span> <span class="n">did</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Code Snippets</a><ul>
<li><a class="reference internal" href="#pgadminmodule">PgAdminModule</a></li>
<li><a class="reference internal" href="#nodeview">NodeView</a></li>
<li><a class="reference internal" href="#basedriver">BaseDriver</a></li>
<li><a class="reference internal" href="#baseconnection">BaseConnection</a></li>
</ul>
</li>
</ul>

<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="connecting.html">Connecting To A Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_cluster_objects.html">Managing Cluster Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_database_objects.html">Managing Database Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="modifying_tables.html">Creating or Modifying a Table</a></li>
<li class="toctree-l1"><a class="reference internal" href="management_basics.html">Management Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="backup_and_restore.html">Backup and Restore</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_tools.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgagent.html">pgAgent</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="contributions.html">pgAdmin Project Contributions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="submitting_patches.html">Submitting Patches</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_overview.html">Code Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="coding_standards.html">Coding Standards</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Code Snippets</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_review.html">Code Review Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="translations.html">Translations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="code_review.html" title="Code Review Notes"
             >next</a> |</li>
        <li class="right" >
          <a href="coding_standards.html" title="Coding Standards"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pgAdmin 4 4.29 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="contributions.html" >pgAdmin Project Contributions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Code Snippets</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        <div class="related" role="navigation" aria-label="related navigation">
          <ul>
            <li class="right" style="margin-right: 10px"><a href="genindex.html" title="General Index" accesskey="I">index</a></li>
            <li class="right" ><a href="code_review.html" title="Code Review Notes" accesskey="N">next</a> |</li>
            <li class="right" ><a href="coding_standards.html" title="Coding Standards" accesskey="P">previous</a> |</li>
          </ul>
        </div>
    </div>
  </body>
</html>